\documentclass[a4paper, 12pt]{report}

%%
% to enumerate subsubsection
%%
\addtocounter{tocdepth}{3}
\setcounter{secnumdepth}{3}
% \usepackage{tgtermes}
% \usepackage{pgfplots}
% \usepgfplotslibrary{external} 
% \tikzexternalize
\usepackage{parskip}
\usepackage{setspace}
\usepackage[a4paper, margin=0.984252in]{geometry}
\usepackage[T1]{fontenc}
\usepackage[breaklinks,hidelinks]{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{graphicx} 
\usepackage{color,soul}
\usepackage{tikz}
\usepackage{amsmath, amssymb}
% \usepackage{indentfirst}
% \usepackage{cite}
\usepackage{natbib}
\usepackage[nameinlink,noabbrev]{cleveref}
\usepackage[capposition=top]{floatrow}
\usepackage{float}
% \usepackage[tableposition=top]{caption}
% \floatsetup[table]{capposition=top}
\usepackage{caption}
\usepackage{xfrac}
\usepackage{braket}
\usepackage[toc,page]{appendix}
\usepackage{longtable}
\usepackage{tabularx}
\usepackage{adjustbox}
\usepackage{multirow}
\usepackage{arydshln}
\usepackage{pdfpages}
% \usepackage{scrextend} % add margin
% \usepackage{hyperref}
% \usepackage{physics}
\def\changemargin#1#2{\list{}{\rightmargin#2\leftmargin#1}\item[]}
\let\endchangemargin=\endlist 

%%
% to enumerate subsubsection
%%
\addtocounter{tocdepth}{3}
\setcounter{secnumdepth}{3}
\renewcommand{\baselinestretch}{1.3}
% \linespread{1.5}
% \setlength{\parindent}{0em}
% \setlength{\parskip}{1em}
% \usepackage{setspace}
% \setstretch{1.5}

% Snippet
\newcommand{\BSM}{Black--Scholes--Merton }
\newcommand{\lnorm}{log-normally }
\newcommand{\bmotion}{Brownian Motion }
\newcommand{\stvar}{stochastic variable }
\newcommand{\wienpro}{Wiener process }
\newcommand{\markpro}{Markov process }

% 
% Bunch of new commands
% 
% brownian motion
\newcommand{\dBm}{dW\left(t\right)}
\newcommand{\dpoiss}{dq\left(t\right)}
\newcommand{\DBm}{\delta{W\left(t\right)}}
\newcommand{\Bm}{W\left(t\right)}
\newcommand{\Bmsub}[1]{W_{#1}\left(t\right)}
\newcommand{\Dt}{\Delta t} 
\newcommand{\Bmdist}{\DBm \sim N \left( 0, \Dt \right)}
\newcommand{\ft}{f\left(t, \Bm \right)}
\newcommand{\E}{\mathop{\mathbb{E}}}
\newcommand{\ct}{c\left(t, x\right)}
\newcommand{\dcx}{\frac{\delta\ct}{\delta x}}
\newcommand{\dciix}{\frac{\delta^2\ct}{\delta x^2}}
\newcommand{\dct}{\frac{\delta\ct}{\delta t}}
\newcommand{\N}[1]{N\left(#1\right)}
\newcommand{\dsub}[1]{d_{#1}\left(\Dt, x\right)}
\newcommand{\call}[2]{c\left( #1, #2\right)}
% % about stock
\newcommand{\St}{S\left(t\right)}
\newcommand{\Vt}{V\left(t\right)}
\newcommand{\Si}{S\left(0\right)}
\newcommand{\dSt}{dS\left(t\right)}
\newcommand{\DSt}{\Delta S\left(t\right)}
\newcommand{\dSr}{\frac{\dSt}{\St}}
\newcommand{\DSr}{\frac{\DSt}{\St}}
\newcommand{\Scontinuous}{\St = \Si e^{\sigma\Bm + \left(\alpha - \frac{1}{2 \sigma^2}\right)t}}
\newcommand{\Itobmdiff}{d\ft = \left[\frac{\partial \ft }{\partial t} + \frac{1}{2} \frac{\partial ^2\ft }{\partial x^2}\right]dt + \frac{\partial \ft}{\partial x} \dBm}
\newcommand{\Scontinousdiff}{d\St &= \alpha \St dt + \sigma \St \dBm}
\newcommand{\Scontinuousrate}{\dSr &= \alpha dt + \sigma \dBm}
 \newcommand{\Sdiscretediff}{d\St &= \alpha \St \Dt + \sigma \St \dBm}
\newcommand{\Sshort}{\Si e^{X}}
\newcommand{\CCRdist}{X \sim N\left(\left(\alpha - \frac{1}{2}\sigma^2\right)t, \sigma^2 t\right)}
\newcommand{\Sdiscreterate}{\DSr &= \alpha \Delta t + \sigma \DBm}
\newcommand{\Sdiscreterateexp}{\E \DSr = \alpha \Dt}
\newcommand{\Sdiscreteratevar}{var \DSr = \sigma ^2 \Dt}
\newcommand{\Sdiscreteratedist}{\DSr \sim N\left(\alpha\Dt, \sigma\Dt\right)}
\newcommand{\Sexp}{\E\St = \Si e^{\alpha t}}
\newcommand{\Svar}{var\St = \Si^2 e^{2\alpha t}\left(e^{\sigma^2 t} - 1\right)}
\newcommand{\Sshortt}{\St = \Si e^{X t}}
\newcommand{\CCRt}{X = \frac{1}{t} \ln{\frac{\St}{\Si}}}
\newcommand{\CCRtdist}{X \sim N\left(\alpha - \frac{\sigma^2}{2}, \frac{\sigma^2}{t}\right)}
\newcommand{\BSMpde}{\dct + r x \dcx + \frac{1}{2} \sigma^2 x^2 \dciix = r\ct}
\newcommand{\BSMeq}[1]{r\call{t}{#1} = \frac{\partial \call{t}{#1}}{\partial t} + r #1 \frac{\partial \call{t}{#1}}{\partial #1} + \frac{1}{2} \sigma ^2 #1 ^2 \frac{\partial ^2 \call{t}{#1}}{\partial #1 ^2}}
\newcommand{\BSMGreeks}[1]{r\call{t}{#1} = \Theta + r #1 \Delta + \frac{1}{2} \sigma ^2 #1 ^2 \Gamma}
\newcommand{\BSMsol}{\ct &= x\N{\dsub{+}} - K e^{-r\Dt} \N{\dsub{-}}}
\newcommand{\dpm}{\dsub{\pm} &= \frac{1}{\sigma\sqrt{\Dt}} \left[\log\frac{x}{K} + \left(r \pm \frac{\sigma^2}{2}\Dt\right)\right]}

% CIR Stock price Stochastic process
\newcommand{\HSVstock}{
  d\St &= \alpha \St dt + \sqrt{\Vt} \St d \Bmsub{S}
}

% CIR Stock price Stochastic process
\newcommand{\HSVstockriskless}{
  d\St &= r \St dt + \sqrt{\Vt} \St d \Bmsub{S}
}

% CIR volatility
\newcommand{\HSVvol}{
  d\Vt &= \kappa\left(\theta - \Vt \right) dt + \sigma \sqrt{\Vt} d \Bmsub{V}
}


% CIR volatility
\newcommand{\HSVvolriskless}{
  d\Vt &= \kappa^{*} \left(\theta^{*} - \Vt \right) dt + \sigma \sqrt{\Vt} d \Bmsub{V}
}

\newcommand{\dportfolio}{dX\left(t\right) = \Delta\left(t\right) d\St + r \left(X\left(t\right) - \Delta\left(t\right) \St \right) dt}

\usepackage{Sweave}
\begin{document}

\input{index-concordance}

\setkeys{Gin}{width=8.3in}
\begin{titlepage}
\includepdf{cover.pdf}
\end{titlepage}

\newpage\null\thispagestyle{empty}\newpage


\setkeys{Gin}{width=0.8\textwidth}



\pagenumbering{roman}
\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}
 
The study developed in the current master thesis concerns the Black-Scholes-Merton (BSM) method initially intended to give a fair price to options for which a geometric Brownian motion (GBM) drives the underlying asset.
Indeed this model works remarkably well provided that the underpinned assumptions are respected with the most restrictive one stating that the distribution of the log-returns of the underlying asset has to be normal.
However, empirical results show that this constraint of log-normality does not hold for real-life trials and consequently break the more key hypothesis of the aforementioned model.

The primary purpose of the analysis developed in that work is to assess how wrong goes the BSM equation while the underlying asset is not a GBM.
To that end, others models will be investigated, namely, the Merton jump diffusion (MJD) and Heston stochastic volatility (HSV) models.
Each of it bears a new characteristic. The MJD brings jumps to the paths of the underlying processes whilst HSV comes with a volatility parameter that evolves with times unlike the deterministic one inherent to BSM. These specificities affect the log-returns distributions that are no more normal.

Accordingly, once calibrated, those models will be used to simulate a world where the assumption of log-normality of the BSM model does not hold anymore. The study case explored is to measure how the BSM equation will react when its central assumption is broken.
To do this, the performance of the delta-neutral portfolios of BSM, MJD and HSV processes will be benchmarked.

As a subanalysis, another goal of that master thesis is to examine if, with a unique set of parameters, the HSV and MJD models can reproduce the volatility smiles constructed from the options prices provided by the market.
A conclusion would be that those models are versatile enough to cover a broader range of market prices than the BSM model itself.
\chapter*{Acknowledgements}
\addcontentsline{toc}{chapter}{Acknowledgements}

First and foremost, I want to address all my gratitude to Anne, and our two wonderful children, Elsa and Valentin, for their patience and huge support. They gave me all the strength needed to go beyond my self-motivation.

Many thanks to all of my family and precious friends that make the life more pleasant. I especially think of Nonna Emma, Mario, Josiane, Maud, Eddy, Christelle, Sébastien, and Pierre. 

Thank you mum and dad.

Last but not least, I want to sincerely thank Pr. Frédéric Vrins for trusting me. It was a real pleasure to meet you.




{\setstretch{1.0}
\tableofcontents
\clearpage

\listoffigures
 \clearpage


\listoftables}
\clearpage



\pagenumbering{arabic}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  CHAPTER: Introduction
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Introduction}
\label{cha:Introduction}

The options market gained in importance in the latter decades, and the range of related products become more extensive with time.
Although in some cases, those derivatives are used with speculative aims, primarily due to the leverage effect inherent to the long position taken in them, they however mainly serve to cover oneself against potential risks.
Indeed, if someone plans to buy some share of stocks in a further date he/she can lock the price of that asset by going long in a European call, likewise, if another one wants to fix a selling price in a security for a future date, he could go long in a European put.

Though, if everyone, as well the speculators as those wanting to lock a price are going long into those financial products, who are taking the opposite position by going short?
Those profiles are called the hedgers and generally are employed by big financial institutions.
Their goals are to sell derivative contracts without losing money by opting for an appropriate strategy that replicates the value of the long position in the option sold using other financial products bundle together into a portfolio. The so-called replicating or hedging portfolio.

That wallet can be constructed by using the delta-hedging strategy consisting of the replication of the opposite position than that to hedge by taking advantage of the underlying asset as well as the money market account.
Roughly speaking, that portfolio is built in a way that, at any time, each impact on the option value due to a move in the underlying price is offset by a position taken in that asset.
Accordingly, the position in the underlying asset has to be continuously readjusted to remain such an effective buffer.
This strategy will be explained more deeply in subsequent chapters.

The strategy mentioned above needs money to be initially constructed, and that amount has to cover the fee of all the rebalancing operations whatever are the stock moves up to option's maturity.
Consequently, that amount of money equals the option price at time zero.

The Black-Scholes-Merton (BSM) equation developed in \citet{bs} and supplemented in \citet{merton73} helps to find such a price for a derivative by relying on some constraints that restrict what is observed in reality, but as with any model, the objective is to find a frame that matches with an abstract of fact, not to reproduce it fully.
The most restrictive assumption is that the process driving the underlying asset's prices is a geometric Brownian motion (GBM), involving that the associated log-returns' distribution is normal and that the related volatility rate is deterministic.
Hence, that master thesis will explore such claims and raises the following overall question concerning the approximations brought by the BSM model, how good are the BSM hedging performances within our not lognormal world?

In the current document, the focus is set on measuring the performance of the particular  European vanilla calls options.

% \section{Context}
% \label{sec:introduction:context}

\section{Raised questions}
\label{sec:Introduction:raised}

In order to go beyond the BSM constraints, other models are considered which allow time-series to take other distributions for their returns than the lognormal one.
Those processes are the Merton jump-diffusion (MJD) and Heston stochastic volatility (HSV) whose first provide discrepancies in its path by adding a jump component, while the second lets volatility being no more immutable over time.

Consequently, by considering to those models, the study breaks the assumptions of (i) normality for the log-returns and (ii) deterministic volatility.
The objective will be to construct and quantify hedging strategies over such processes denoting underlying assets.
Nevertheless, the prices of options on such dummy assets, driven by HSV or MJD, lack to be determined with the solution provided in \citet{bs}. 
They need a particular methodology to be found out. Latter is given in \citet{heston1993} and relies on a probabilistic approach involving the characteristic functions of the stochastic processes $\ln S(t)$, where $S(t)$ expresses the random time-series generated by either MJD or HSV.

First and foremost, the models used to generate time-series and those aimed to price European call options will be calibrated to provide credible outputs.
Afterward, the geometric Brownian motion, Merton jump-diffusion, and Heston stochastic volatility processes will be applied to simulate artificial stock prices time-series while the BSM and Heston approaches will serve to price some related options.
Ultimately, the so computed initial option prices will serve the analysis of the hedging performances.

The hedges assessment will be split into two parts. 
The first one regards the measure of the results reached when hedging a GBM with a BSM delta-neutral portfolio.  Needless to say that the score of such an approach should be almost perfect since all the assumptions underpinning the BSM framework are respected.
The objective is to build a standard to be subsequently compared with the coverage of other processes.
Thereafter, the assessment of options' coverages for which the underlying assets depend on MJD and HSV will take place.
Those derivatives will be hedged through both the BSM delta and that appropriate to the underpinned model, computed from the first mathematical derivative of the related option price function with respect to the stock price.
The goal is to compare their intrinsic performances and to evaluate how one goes wrong by applying the BSM delta in real life. 

According to \citet{shreve}, the recurrence of rebalancing affects the quality of the hedge. 
Those consequences can be significant to a certain extent.
They depend on fundamental properties of the option to be hedged and notably rely on its gamma, that is, the acceleration at which the underlying asset affects the option price.
Indeed, the hedge of an option with higher gamma can give poor results if not rebalanced regularly.
That master thesis will evaluate the aforementioned gamma effect on the delta-neutral portfolio rebalancing frequency.

Shreve also shows that the impact of gamma is always adverse for a delta-neutral portfolio that replicates a long position in the derivative. 
Whilst the influence of theta, i.e., the rate at which an option decrease in value as time passes all other things being equal, is always positive for that securities.
He especially exhibits that the weight of theta on a delta-neutral portfolio overwhelms that of gamma. 
In that document, those effects will be analyzed for BSM, MJD and HSV related options, namely, up to what extent gamma and theta affect the options and consequently the delta-neutral portfolio, but also which types of options and what models are the more impacted.

Ultimately, market data shows that to obtain the same prices for options with different strike prices but same maturity the BSM equation involves using different volatilities for the same underlying asset.
Though, the risk of a share of stock does not depend on the strike prices of its related options, inducing that the BSM model lacks to reproduce such a behavior.
That specificity is knowns as the volatility smile and represents the BSM implied volatility with respect to the strikes and grouped by maturity.
When they are not clustered by maturity, one talk about volatility surface.
Therefore, unlike the BSM approach, are the models MJD and HSV able to reproduce such volatility surface with one unique set of parameters provided that they happen to be well adjusted?

The so raised questions are summarized in the list here below.

\begin{itemize}
\item What is the effect of the rebalancing rhythm on the hedging performances for the HSV and MJD models against the BSM approach? 
\item How far can one go wrong by using the BSM delta-neutral strategy in the real world? Does it make sense to use it?
\item What can be the effects of gamma and theta combined on the replicating portfolio?
\item Are the MJD and HSV models able to reproduce the volatility smiles? 
\end{itemize}

However, the answers that will be provided for the above questions are limited to the particular case studied in that master thesis and consequently cannot be generalized.


\section{Organization of the document}
\label{sec:introduction:organization}

In this section are briefly introduced all the subsequent chapters.

\cref{cha:upstream} introduces basics concepts that will be subsequently actively used in the others chapters. Among those, there are Brownian motions, introduction on the financial derivatives, Itô's approximation, Cox–Ingersoll–Ross process, log-return, continuously compounded rate of return and the computation of skewness and kurtosis.

\cref{cha:bsm} presents the Black-Scholes-Merton model along with the geometric Brownian motion used to drive underlying assets prices processes. Furthermore, in that chapter dives also into the Greeks that will be used in the study part, namely, the delta, gamma, and theta. Each of it plays a specific role in the delta-hedging strategy or in the process of options pricing.

\cref{cha:OtherModel} exhibits other models which will be used in the analysis in order to tackle with some of the flaws bring by the assumptions of the Black-Scholes-Merton pricing model. Those are the Merton jump-diffusion (MJD) and Heston stochastic volatility (HSV) models. Algorithms aimed either to compute time-series driven by those models or to price options on such series will be investigated.

\cref{cha:Methodology} presents the methodology used to calibrate all the previously studied algorithm and it lists the followed procedure for assessing the performance of the models within a not log-normal world. 

\cref{cha:analysis} points out and delves into the details of the results got from the delta-hedging performance study. These results will be split into three parts where in turn, the performances of the BSM, MJD and HSV models will be explored.

\cref{cha:conclusion} concludes the work by highlighting some results, presenting their limits and suggest ways to reflect on them or ideas to go beyond the particular study case explored in that master thesis.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  CHAPTER:Upstream concepts
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Upstream concepts}
\label{cha:upstream}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Overview
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \section{Overview}
% \label{sec:upstream:overview}

The material covered in the current chapter is meant to be thereafter intensively used, either by being applied in the studied theoretical models or by entering in the construction of the theory-based algorithms.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Vanilla options
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Vanilla options}
\label{sec:upstream:vanilla}

The so-called vanilla options, in opposition to the more complex - not covered in this master thesis - exotic ones, are specifics kind of derivatives coming along with some good-to-know jargons. 

First and foremost,  as defined in \citet{hull}, an option is a contract between two stakeholders with different interests or at least distinctive motivations, who want to buy or sell a product, which generally is a financial asset called "the underlying." 
Indeed, someone can look for hedge oneself against risk while the other party wants to make a profit on a speculative move.
Likewise other financial contracts, one agrees to buy and the other to sell at a fixed amount of money, namely "the strike price", usually denoted by $k$ with the difference that they would effectively realize the purchase or the sale of the underlying at a future date than the one they enter into the bargain. That date is called "the maturity".


Another key characteristic of options is that they are not symmetric contracts, in the sense that both parties do not have the same rights, depending on their position along with the option's type. 
Two positions can be taken when entering into such a derivative, either long or short. 
Going short broadly means purchase the option whereas going long implies writing, or synonymously, selling the derivative. Beyond the position, the contract can be of call or put type. 

The following sentences encompass a mix of type (call/put) and position (short/long) combination that gives an overview of all the possible scenarios:

\begin{itemize}
\item Someone who is going long into a call gains the right to purchase the underlying at a future date for a fixed price. He has to pay some fees to enter into the contract.
\item Someone who is going short into a call is forced to sell the underlying at a future date for a fixed price. He receives financial compensation to enter into the contract.
\item Someone who is going long into a put gains the right to sell the underlying at a future date for a fixed price. He has to pay some fees to enter into the contract.
\item Someone who is going short into a put is forced to buy the underlying at a future date for a fixed price. He receives financial compensation to enter into the contract.
\end{itemize}

Moreover, vanilla options may be "European" or "American". Latter can be exercised at any time during the whole life of the contract while the European can only be at maturity.

Finally, the payoff provided by all aforementioned European options are summarized throughout \crefrange{eq:upstream:cl}{eq:upstream:ps}, where $C_l$, $C_s$, $P_l$ and $P_s$ respectively stand for the long call, short call, long put and short put payoffs. $S(T)$ being the price of the underlying at maturity.

\begin{align}
C_l &= \left(S(T) - k\right)^+ \label{eq:upstream:cl}\\
C_s &= \left(k - S(T)\right)^- \label{eq:upstream:cs}\\
P_l &= \left(k - S(T)\right)^+ \label{eq:upstream:pl}\\
P_s &= \left(S(T) - k\right)^- \label{eq:upstream:ps}
\end{align}

The derivative considered in this master thesis is mainly the European call option, even though the link with European put could somehow be done without being mandatory to exhibit the issue so raised. Therefore such reference to put should only be done if necessary.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Brownian Motion
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Brownian Motion}
\label{sec:upstream:brownian}
 
All over the present document, the terms "Brownian motion", "Wiener" or "Markov" processes are considered to be equivalent terminology and therefore used as such. However strictly speaking, even though the Brownian motion is in every respect a Wiener process, stricto sensu, the term Markov process is broader. 
Actually, the more remarkable Markov property is to be a process with independent future increments, putting it in line with the weak form of market efficiency (\citet{hull}).
Whilst, on the other hand, even if the Brownian motion, and thus the Wiener process, share this property, they are defined with the idiosyncrasy to have mean zero and a variance rate of one per unit of time (\citet{hull}).

Brownian motion is a centerpiece broadly used in subsequent developments. It is notably applied in many models such as in the geometric Brownian motion (\cref{cha:underlying}),  in the Black-Scholes-Merton (BSM) equation (\cref{cha:bsm}) and in the Merton mixed jump-diffusion (MJD) and Heston stochastic volatility (HSV) model (\cref{cha:model}).

The Brownian motion is a stochastic process, denoted by $\Bm$ and satisfying $W(0) = 0$, with independent and identically distributed (iid) increments, such as defined by \cref{eq:upstream:increment:dist}

\begin{align}
W(t_{i+1}) - W(t_i) \sim
  iid N \left(0, t_{i+1} - t_i\right) \label{eq:upstream:increment:dist}
\end{align}

That Markov process is qualified as being time and path dependent in its building blocks. Time dependency implies that like many other functions its value evolves over time. 
Whereas path dependency means that the Wiener process is also meant to randomly move between two time-steps.
Practically, at any time $t$ and from its origin, the Brownian motion may take any value as shown by \cref{eq:upstream:brownian:dist}.

\begin{align}
\Bm \sim N(0, t) \label{eq:upstream:brownian:dist}
\end{align}

As described by \citet{shreve}, the construction of such a process could be achieved by following various techniques. Either by computing the differential process (\cref{eq:upstream:brownian:diff,eq:upstream:brownian:cumsum}) for every time-steps and then combining them, by constructing a unique time series in that way; or by resolving the joint moment generating function of the iid random variables' vector ($W(t_i)$ \ldots $W(t_m)$), through \cref{eq:upstream:brownian:joint}.

\begin{align}
  d\Bm &= \phi \left(0, t + \epsilon_i \right) \label{eq:upstream:brownian:diff} \\
  \intertext{
  $\phi$ is a function that generate a random number according to the normal law with parameter $\mu = 0$ and $\sigma^2 = t + \epsilon_i$, with $\epsilon_i$ being any arbitrary small delta time step.
  }
  W\left(t + \epsilon_i\right) &= \Bm + d\Bm \label{eq:upstream:brownian:cumsum}
\end{align}

\begin{align}
  \varphi\left(u_1 \ldots u_m\right) = \exp{\left( \frac{1}{2} \sum_{i = 1}^m \left[ \sum_{j = i}^m u_j \right]^2 \left( t_i - t_{i-1} \right) \right)} \label{eq:upstream:brownian:joint}
\end{align}

\Cref{fig:upstream:brownian} (QA) displays a simulation of one hundred Brownian motions over a time frame of five years. While in turn, \cref{fig:upstream:brownian} (QB) shows the distribution of the possible outcomes of that experiment, after five years. The black outlined curve is the density of the normal distribution, with mean and variance chose such as exposed by \cref{eq:upstream:increment:dist}.

\begin{figure}[H]
\centering
\input{figures/brownianmotion.tex}
\caption{Multiple Brownian Motion}
\floatfoot{\textbf{Notes.} (QA): Simulation of one hundred Brownian motions by using the function \textit{bmotion} of the R package \citet{randomwalk}, with a timeframe of five years long and a discrete time-step of one over one hundred.
(QB): The blue filled curve is the density computed on the simulation (QA). The distribution concerns all the final values $W(T = 5)$. The Black bell curve represents the normal density with mean zero and a standard deviation of square root of five.}
\label{fig:upstream:brownian}
\end{figure}

Lastly, \citet{shreve} demonstrates that a Brownian motion has no tendency to rise or fall as time passes thanks to its martingale property. Therefore, because its initial value is zero, a Wiener process only brings noise by being incorporated into other stochastic series.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Correlated Brownian Motion
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Correlated Brownian motions}
\label{sub:upstream:brownian:correlated}

Correlated Brownian motions are Wiener processes that related together according to the factor $\rho$ \ref{eq:upstream:brownian:corr}.
Following \citet{shreve}, these processes happens to be modeled by \cref{eq:upstream:brownian:corr:1,eq:upstream:brownian:corr:2}.

\begin{align}
  dB_1(t) dB_2(t) &= \rho(t) dt \label{eq:upstream:brownian:corr} \\
  \intertext{Where $dB_1(t)$ and $dB_2(t)$ are Wiener process }
  B_1(t) &= W_1(t) \label{eq:upstream:brownian:corr:1} \\
  B_2(t) &= \int_0^t \rho(s) dW_1(s) + \int_0^t \sqrt{1 - \rho^2(s)} dW_2(s) \label{eq:upstream:brownian:corr:2}
\end{align}

whenever $\rho$ is considered as constant over time, however, the simple form given by  \cref{eq:upstream:brownian:corr:deterministic:2} is enough to construct such processes.

\begin{align}
B_2(t) &= \rho W_1(s) + \sqrt{1 - \rho^2} W_2(s) \label{eq:upstream:brownian:corr:deterministic:2}
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Cox-Ingersoll-Ross
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Ito's lemma}
\label{sec:upstream:ito}

Based on Taylor approximation theorem, Ito formulae are meant to provide the differential form of such a function $f \circ g$ where the function $f$ can be differentiated with respect to its independent variable whilst g cannot.

\begin{align}
  f(T, W(T)) = f(0, W(0))
               + \int_0^T \frac{\partial f(t, W(t))}{\partial t} dt
               + \int_0^T \frac{\partial f(t, W(t))}{\partial W(t)} dW(t)\notag\\
    \mspace{150mu} + \frac{1}{2} \int_0^T \frac{\partial^2 f(t, W(t))}{\partial W(t)^2} dt \label{eq:upstream:itodiff:brownian}
\end{align}

While \cref{eq:upstream:itodiff:brownian} shows the formula for Brownian motion, the \cref{eq:upstream:itodiff:itopro} represents the form used to differentiate the more complex Ito process (\ref{eq:upstream:itopro}).

\begin{align}
  X(T) &= X(0)
         + \int_0^T \Delta(u) dW(u)
         + \int_0^T \Theta(u) du \label{eq:upstream:itopro} \\
  \intertext{
  Where $\Delta(u)$ and $\Theta(u)$ are stochastic process, adapted to a filtration f(t)
  }
  f(T, X(T)) &= f(0, X(0))
               + \int_0^T \frac{\partial f(t, X(t))}{\partial t} dt
               + \int_0^T \frac{\partial f(t, X(t))}{\partial X(t)} \Delta(t) dW(t)\notag\\
    &\mspace{50mu} + \int_0^T \frac{\partial f(t, X(t))}{\partial X(t)} \Theta(t) dt
    + \frac{1}{2} \int_0^T \frac{\partial^2 f(t, X(t))}{\partial W(t)^2} \Delta^2(t)dt \label{eq:upstream:itodiff:itopro}
\end{align}

Ito formulae are thereafter applied to derive such a process like the geometric Brownian motion or the Black-Scholes-Merton partial differential equation. 







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Cox-Ingersoll-Ross
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Cox-Ingersoll-Ross}
\label{sec:CoxIngersollRoss}

The Cox-Ingersoll-Ross (CIR) stochastic model $R(t)$, defined by the differential \cref{eq:upstream:cir}), can be used to simulate interest rates' evolution over time thanks to some of its intrinsic characteristics, namely the mean-reversion and its property to only take positive values (\citet{shreve}).

\begin{align}
dR(t) &= (\alpha - \beta R(t)) dt + \sigma \sqrt{R(t)} dW(t)
\label{eq:upstream:cir}
\end{align}

According to \citet{shreve}, a  mean-reverting stochastic process tends to navigate, such a pointy sinusoidal motion, around its mean.
The CIR inherits this behaviour from the construction of its differential's drift part, i.e. $(\alpha - \beta R(t))dt$.
Indeed when $R(t) = \sfrac{\alpha}{\beta}$, then the drift term $dt = 0$ with the consequence of status quo.
In addition, whether $R(t) > \sfrac{\alpha}{\beta}$ or $R(t) < \sfrac{\alpha}{\beta}$, the next value of $R(t + \epsilon) = R(t) + dR(t)$ is pushed back toward $\sfrac{\alpha}{\beta}$.
Actually, as showing by \cref{eq:upstream:cir:exp}, the long-run expected value for the process $R(t)$ is $\sfrac{\alpha}{\beta}$.

\begin{align}
\lim_{t \to \infty}  \mathop{\mathbb{E}} R(t) = \frac{\alpha}{\beta} \label{eq:upstream:cir:exp}
\end{align}

On the other hand, depending on \citet{shreve}, the non-negativity property is explained by the fact that if $R(t) \to 0$ then $dR(t) \simeq \alpha dt > 0$ making $R(t+\epsilon)$ bounced off the x axis, running it away from negative realm.

Ultimately, the CIR mean-reverting \cref{eq:upstream:cir} is used by \citet{heston1993} in its pricing model to construct stochastic interest rates.
Heston's model is covered in \cref{sec:othermodel:heston}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Moments
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Skewness and Kurtosis}
\label{sec:Moments}



The skewness and kurtosis of a random variable's distribution, whose respectively are the third and fourth moment, characterize either the asymmetry, for the first, or the degree of flatness, for the second.

The theoretical moments are defined by \cref{eq:upstream:moment:theoretical} while those empirical can be estimated using \cref{eq:upstream:moment:empirical}, with the parameter $r = 3$ to compute the skewness or $r= 4$ for the kurtosis.

\begin{align}
\gamma_r = \mathop{{}\mathbb{E}} \left[ \left( \frac{X - \mu}{\sigma} \right) ^r \right] \label{eq:upstream:moment:theoretical}
\intertext{where $X$ is any random variable}
m_r = \frac{1}{n} \sum_{i = 1}^n (x_i - \overline{\rm x}) ^r \label{eq:upstream:moment:empirical}
\end{align}
with $\{x_i\}_{i \in n}$ being a set of outcomes belonging to the sample set.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Estimation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Estimation}
\label{sub:Estimation}

As demonstrated in \citet{sk}, sampled skewness and kurtosis formulae can be computed in some different fashions
All of these methods bring their precisions to the calculation of those moments. 
The precision of the method mostly depends on the size of the sample along with the skewed of the theoretical distribution to be estimated.

The method having to be chosen to estimate the skewness and kurtosis needs a prudent selection especially for a small sample size. 
Actually, in order to minimize the mean-squared error and the associated variance, the \cref{eq:upstream:skewness:normal,eq:upstream:kurtosis:normal} are used as a reliable unbiased estimator for a sample with normal shaped theoretical distribution.

\begin{align}
  b_{skewness} &= \frac{m_3}{S^3} \label{eq:upstream:skewness:normal} \\ 
  b_{kurtosis} &= \frac{m_4}{S^4} \label{eq:upstream:kurtosis:normal} \\
  \intertext{
  where
  }
  S^2 &= \frac{1}{n - 1} \sum_{i = 1}^n \left( x_i - \overline{\rm x} \right)^2 \notag \\
  \intertext{
  Conversely, \cref{eq:upstream:skewness:skewed,eq:upstream:kurtosis:skewed} are the ones providing a better-unbiased estimation for more skewed distributions, such as for log-normal random variable's samples.
  }
  G_{skewness} &= \frac{k_3}{\sqrt{k_2^3}} \label{eq:upstream:skewness:skewed} \\ 
  G_{kurtosis} &= \frac{k_4}{k_2^2} \label{eq:upstream:kurtosis:skewed}  \\
  \intertext{
  where
  }
  K_2 &= \frac{n}{n-1} m_2 \notag \\
  K_3 &= \frac{n}{(n-1)(n-2)} m_3 \notag \\
  K_4 &= \frac{n}{\prod_{i = 1}^3 n - i} \Big[ (n+1)m_4 - 3(n-1) m_2 ^2 \Big] \notag
\end{align}

Accordingly, the algorithm to apply in order to estimate the skewness and kurtosis from samples should be chosen with respect to the theoretical underpinned distribution.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Log-return and compounded interest rate
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Log-return and compounded interest rate}
\label{sec:upstream:logreturn}

Following \citet{hull}, the concept of log-returns and continuously compounded interest rates are closely related together as attested by \crefrange{eq:upstream:stock:valued}{eq:upstream:logreturn}.

\begin{align}
&S(0) e^{R_c t} = \St \label{eq:upstream:stock:valued} \\
\Longleftrightarrow  &\ln{S(0)} + R_c t = \ln{\St} \\
\Longleftrightarrow  &\ln{\frac{\St}{S(0)}} = R_c t \label{eq:upstream:logreturn}
\end{align}
Where $R_c$ is the interest rate with continuous compounding, $t$ denotes the time period across which the interests are compounded ($t$ is yearly-based) while the left-hand side of \cref{eq:upstream:logreturn} stands for the natural logarithm of the stock return occurring during the period $t$, the so-called log-return.

As showed in \citet{hull}, the transformation of an equivalent rate $R_m$ with a frequency of compounding $m$ per year into one continuous could be perform thanks to \cref{eq:upstream:equivtocontinuous}

\begin{align}
R_c = m \ln \left( 1 + \frac{R_m}{m} \right) \label{eq:upstream:equivtocontinuous}
\end{align}

For what matters in that master thesis, the focus is set to the sample's log-returns which are used to estimate the volatility term appearing, inter alia, in \cref{eq:upstream:scontinuous} in order to simulate geometric Brownian motion.

In accordance with \citet{hull}, if $S_i$ and $n$ respectively denote the stock price at the end of interval $i$ and the total number of observations then the log-returns of the ordered sample set $\{S_i\}_{i \in n}$ is given by \cref{eq:upstream:logreturn:sample}.

\begin{align}
  u_i &= \ln \frac{S_i}{S_{i-1}} \label{eq:upstream:logreturn:sample} \\
  \intertext{
  Whilst the estimation of the standard deviation of all the $u_i$ is defined as such in \cref{eq:upstream:logreturn:sample:sd}
  }
  s &= \sqrt{\frac{1}{n - 1} \sum_{i = 1}^n \left(u_i - \bar{u} \right) ^2} \label{eq:upstream:logreturn:sd} \\
\end{align}

Consequently, if the distribution of the log-returns of a stochastic process is normal and is given by \cref{eq:upstream:log:distrib:normal}, the parameters $\alpha$ and $\sigma$ can be assessed by respectively using \cref{eq:upstream:mean:estimator,eq:upstream:volatility:estimator}.
This method will be used notably used in \cref{cha:Methodology} to find the calibrated value of some parameters.

\begin{align}
  N \sim \left( \left( \alpha - \frac{\sigma^ 2}{2} \right) t, \sigma^2 t \right) \label{eq:upstream:log:distrib:normal}
\end{align}

\begin{align}
  \hat{\alpha} &= \frac{\bar{x}}{t} + \frac{\hat{\sigma}^2}{2} \label{eq:upstream:mean:estimator}\\
  \hat{\sigma} &= \frac{s}{\sqrt{t}} \label{eq:upstream:volatility:estimator}
\end{align}














%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  CHAPTER:The \BSM model
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{The Black-Scholes-Merton option pricing model}
\label{cha:bsm}

The Black-Scholes-Merton (BSM) model is meant to provide the no-arbitrage price of derivative assets such as European stock option. 
That model lies in the resolution of a partial differential equation to find the fair price of a derivative at each period of time before maturity.
The foundations come from the work of \citet{bs} and \citet{merton73}. 
While Fischer Black and Myron Scholes had used the capital asset pricing model (CAPM) to resolve the equation, Robert C. Merton had applied a portfolio replication method based on the assumption that the expected return of that portfolio should be equal to the riskfree rate. 



To price derivatives by using the model highlighted in this present chapter, Black and Scholes had set some constraints in \citet{bs}. 
\Cref{sec:Assumptions} quotes that assumptions. 


  
One of the most important constraints of BSM is that the price evolution of the underlying asset is modeled by a geometric Brownian motion. Its time continuous form is given by  \cref{eq:underlying:geometric:closed}.


\begin{center}
  \begin{equation}
    \Scontinuous
    \label{eq:underlying:geometric:closed}
  \end{equation}
\end{center}
According to \citet{shreve}, The  GBM features a stochastic process where the only random component is the Brownian motion $\Bm$. 
The others parameters, $\alpha$ and $\sigma$,  respectively stand for the drift and volatility rate of the process.
That model is fully explored in \cref{sec:underlying:derivation}.


 
Furthermore, in order to match with the constraints underpinned by the model developed by Black and Scholes, the distribution of the underlying asset log-returns has to be normally distributed.
Accordingly, the current chapter shows that this prerequisite is met when the price of a security is driven by a GBM.









In that master thesis, the focus would be set to the computation of the pricing of vanilla Call options and the performance of the model when it evolves beyond the boundaries fixed by Black and Scholes. 
Some discrepancies studied in later chapters will be for instance that the underlying model is not driven by a GBM, the volatility of the stock is not deterministic and varies across time or abrupt and non predictable movements occur during the life of the asset.



\Cref{sec:bsm:equation} gives the resolution of the BSM equation to price European call option, while \cref{sec:greeks} introduces some Greek letters, namely, ($\Delta, \Gamma, \Theta$), which are functions that can be used either to price a derivative or to construct a hedging strategy.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Assumptions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Assumptions}
\label{sec:bsm:assumptions}

\citet{bs} have provided a framework supported by a bunch of constraints qualified as ideal conditions under which the market would behave in order to make the BSM equation works with accuracy. All of these conditions are here below mentioned.

\begin{enumerate}
  \item The short-term risk free rate $r$ is known and constant
  \item The stock return involving in the computation of BSM equation is log-normally distributed with constant mean and variance rate
  \item No dividend are provided with the considered share of stock
  \item The option considered within the computation is european
  \item The price for bid and ask quote are identical. It means that there is no bid--ask spread to be considerered
  \item Share of stock can be divided into any portions such as needed for the computation
  \item Short selling is allowed with no penalties
\end{enumerate}

In the study performed purposely for that master thesis, the condition (2), that is the stock return is driven by a GBM, won't be respected. 
The goal is (i) to analyze how a derivative with another process as an underlying asset could be priced and how these prices reflect those in the market, and (ii) to measure the performance of the hedging if that constraint is not respected.
Whilst incidentally, all other requisites will stay as is.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Derivation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Geometric Brownian motion}
\label{sec:underlying:derivation}

The differential form of \cref{eq:underlying:geometric:closed} is useful to find the properties of its distribution.
As demonstrated by \citet{shreve}, in order to get it, the Itô's formula (\cref{sec:upstream:ito}) is used with $S(t)$ as a stochastic process to resolve. 
By applying that tranformation, \cref{eq:underlying:geometric:diff,eq:underlying:geometric:rate} emerge:
 
\begin{center}
  \begin{subequations}
    \begin{align}
      \Scontinousdiff \label{eq:underlying:geometric:diff} \\
      \Scontinuousrate \label{eq:underlying:geometric:rate}
    \end{align}
  \end{subequations}
\end{center}

\Cref{eq:underlying:geometric:diff} shows that any change occurring in the stock price $S(t)$ over a small amount of time is due to its deterministic expected drift rate ($\alpha \St$), along with some amounts of added noise incurred by the random part ($\sigma d\Bm$). 
According to \citet{shreve}, such interferences provided by a Brownian motion do not make the process increase or fall over the long-run, i.e., there is no associated drift to them, they only bring volatility.
On the other hand, \cref{eq:underlying:geometric:rate} denotes the instantaneous return of the asset driven by a GBM.

\begin{align}
  d\ln{\St} &= (\alpha - \frac{\sigma ^2}{2}) dt 
              + \sigma d\Bm \label{eq:underlying:logreturn:diff} \\
  \ln{\frac{\St}{S(0)}} &= (\alpha - \frac{\sigma ^2}{2}) t 
              + \sigma \Bm \label{eq:underlying:log:return}
\end{align}

\Cref{eq:underlying:log:return} exhibits the natural logarithm of the stock price return occurring over the period $t$. 
More specifically,  as shown in \citet{hull}, the expectation of this process, which is given by $(\alpha - \frac{\sigma ^2}{2})  t$, happens to be the expected value of the continuously compounded rate of return for the aforementioned period of time, since, as previously mentioned, the Brownian motion $\Bm$ only brings disruptions.


The accuracy of the stochastic process \ref{eq:underlying:geometric:closed}, when approximated by using the Itô's lemma, depends exclusively on two factors; the volatility parameter $\sigma$ and the period occurring between two measures $\tau = t_{i+1} - t_i$. 
As shown by \cref{p:itoaccuracy}, the lower the volatility or shorter the time-step, the better the estimate.
It is therefore key, during an analysis process to choose an appropriate time-step according to a given volatility in order to provide accurate results.


\begin{figure}[h]
\centering
\input{figures/ItoAccuracy.tex}
\caption{Accuracy of Itô approximation}
\floatfoot{\textbf{Notes.} The blue line curves are constructed using itô's approximation \ref{underlying:geometric:diff} while  \cref{eq:underlying:geometric:closed} is used to build the red ones. 
The only parameters that change over the group are the couples $(dt, \sigma)$ which are set to $\left \{dt = 360, \sigma = 0.2 \right \}$ for (QA), $\left \{dt = 4, \sigma = 0.2\right \}$ for (QB), $\left \{dt = 360, \sigma = 1\right \}$ for (QC), and $\left \{dt = 4, \sigma = 1\right \}$ for (QD). 
}
\label{p:itoaccuracy}
\end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Distribution of the stock price process
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Distributions of geometric Brownian motion}
\label{sub:Distribution of the stock price process}

This section delves into the distributions of the process \ref{eq:underlying:geometric:closed,eq:underlying:geometric:diff,eq:underlying:log:return}. 
They are described by using the related underlying law together with the relevant moments.

\Cref{eq:scontinuousdist}, provided in \citet{shreve},  shows that the process followed by \cref{eq:underlying:geometric:closed} has normally distributed returns with their expected value and variance proportional to the time period $dt$.

\begin{center}
\begin{equation}
\dSr \sim N(\alpha dt, \sigma^2 dt)
\label{eq:scontinuousdist}
\end{equation}
\end{center}  
Moreover and according to \cref{p:returndensity}, one can see that the normality qualification of \cref{eq:scontinuousdist} holds. 
Indeed, the black bell curve is constructed using the theoretical normal law with $\alpha dt$ and $\sigma^2 dt$ respectively as first and second moments, while the blue filled figure is built thanks to empirical results of process \ref{eq:underlying:geometric:diff} with the same $\alpha$ and $\sigma$ given as parameters.

 
\begin{figure}[!h]
\centering
\input{figures/stock_return_density.tex}
\caption{Daily Basis Stock Return Density}
\label{p:returndensity}
\floatfoot{\textbf{Notes.} The above blue distribution is constructed over $10e3$ paths of a unique stochastic process. 
The samples are built with \cref{eq:underlying:geometric:diff}. 
The arguments are adjusted with the following values, $\alpha = 0$, $\sigma = 30\%$. 
The black density belongs to the normal bell curve with mean $\alpha dt$ and standard deviation of $\sigma  \sqrt{dt}$. 
The distance period between each measure, namely $dt$ has been set to $10e3^{-1}$. 
}
\end{figure}












%%%%%%%%%%%%%%%%%%%%%%%%%
%  Log-return
%%%%%%%%%%%%%%%%%%%%%%%%%

According to \citet{shreve}, from \cref{eq:underlying:log:return}, the distribution of the natural logarithm of the stock price return, recorded over a period of time of $\tau$, turns out to be characterized by \cref{eq:logreturndist}.



\begin{center}
\begin{equation}
\ln{\frac{\St}{S\left(0\right)}} 
  \sim N((\alpha - \frac{\sigma^2}{2}) t, \sigma^2 t)
\label{eq:logreturndist}
\end{equation}
\end{center}  

From \cref{p:logreturndensity}, the normality  of \cref{eq:scontinuousdist} can be observed. 
Indeed, the black bell curve is constructed using the theoretical normal law with $(\alpha - \frac{\sigma^2}{2}) t$ and $\sigma^2 t$ respectively as expectation and variance, while the blue filled figure is built based on empirical results of process \ref{eq:underlying:log:return} with the same $\alpha$ and $\sigma$ given as parameters.


\begin{figure}[!h]
\centering
\input{figures/stock_logreturn_density.tex}
\caption{Daily Basis Stock Return Density}
\label{p:logreturndensity}
\floatfoot{\textbf{Notes.} The above blue distribution is constructed over $10e3$ paths of a unique stochastic process. 
The samples are built with \cref{eq:underlying:log:return}. 
The arguments are adjusted with the following values, $\alpha = 0$, $\sigma = 30\%$. 
The black density belongs to the normal bell curve with mean $(\alpha - \frac{\sigma^2}{2}) \times t$ and standard deviation of $\sigma \times \sqrt{dt}$. 
The distance period between each measure, namely $dt$ has been set to $10e3^{-1}$.  
}
\end{figure}




\citet{hull} shows that the theoretical density of the process $S(T)$ can be found from equation \cref{eq:logreturndist} and by applying the properties of the log-normal law.
Indeed, \cref{eq:logreturndist} can be transformed such as given by \cref{eq:underlyin:lgst}

\begin{align}
\ln{\St} \sim N\left(\ln{S(0)} + \left(\alpha - \frac{\sigma^2}{2}\right) t, \sigma^2 t\right) \label{eq:underlyin:lgst}
\intertext{Any process inside the natural logarithm function characterized by the normal law is de facto determining by the log-normal law. 
Ultimately by applying the transformation rules of the mean and variance from a normal probability density function to the log-normal parameters, one finds that the process $S(t)$ is described as follow.}
\St \sim lognormal \left(S(0) e^{\alpha t}, S(0)^2 e^{2 \alpha t} \left(e^{\sigma^2 t} - 1 \right)\right)
\end{align}



\Cref{p:logreturndensity} illustrates that the log-normal property  of $S(t)$ is observed. 
Indeed, the black bell curve is constructed using the theoretical log-normal law with $S(0) e^{\alpha t}$ and $S(0)^2 e^{2 \alpha t} (e^{\sigma^2 t} - 1)$ respectively as expectation and variance, while the blue filled figure is built upon empirical results of $S(t)$ with the same $\alpha$ and $\sigma$ given as parameters.

\begin{figure}[!h]
\centering 
\input{figures/stock_log_density.tex}
\caption{Daily Basis Stock Return Density}
\label{p:logdensity}
\floatfoot{\textbf{Notes.} The above blue distribution is constructed over $10e3$ paths of a unique stochastic process. 
The samples are built with \cref{eq:underlying:geometric:closed}. 
The arguments are adjusted with the following values, $\alpha = 0$, $\sigma = 30\%$. 
The black density belongs to the log-normal curve with mean $S(0) e^{\alpha t}$ and standard deviation of $S(0)^2 e^{2 \alpha t} (e^{\sigma^2 t} - 1)$. 
The distance period between each measure, namely $dt$ has been set to $10e3^{-1}$.}
\end{figure}












































































%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: The partial differential BSM equation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Black-Scholes-Merton equation}
\label{sec:bsm:equation}

Concerning the framework developed in \citet{bs}, the pricing method of an option underpinned by the BSM model is closely related to an underlying for which its price $\St$ is a log-normally distributed stochastic process, such as the GBM be.

As defined in \citet{shreve}, to provide a unique fair price to a stock option (e.g., for what matters here, to a vanilla European call) which depends on an underlying driven by a GBM, all the uncertainty associated to the stock price movements has to disappear. 
To do so, one has first to construct such a portfolio $X(t)$ which encompasses the same source on uncertainty as for the option itself and then choosing the adequate position $\Delta(t)$ to take to the underlying asset at each time $t$, so that all randomness cancels out.
 
\begin{align}
  \dportfolio \label{eq:dportfolio} \\ 
  \intertext{\Citet{shreve} shows that the goal is to dynamically hedge the position taken in the option. 
It means that the position has to be frequently rebalanced. 
Consequently, at any times, the present value (PV) of the changes occurring in the portfolio, due to the underlying price evolution should be equal to the PV of those incurred by the financial derivative. 
The only way to achieve this equality is to adapt the delta for each period.}
   d\left(e^{-rt} X\left(t\right)\right) = d\left(e^{-rt} \ct \right)
\intertext{That way, one can take a position in the derivative (short/long) and hedge it by taking $\pm \Delta(t)$ shares of stock. $X(0)$ being the price of the call at time zero}
 X\left(0\right) = c\left(0, S\left(0\right)\right)
\end{align}




By following and developing the method above, \citet{shreve} shows that the BSM differential equation is given by equation (\ref{eq:bsm:bsm:eq}),  with the terminal (\ref{eq:BSMterminal}) and boundary conditions (\ref{eq:BSMboundary0}) -- (\ref{eq:BSMboundaryinf}).

\begin{center}
  \begin{equation}
     \BSMeq{x}
    \label{eq:bsm:bsm:eq}
  \end{equation}
\end{center}
 
\begin{center}
  \begin{equation}
    \call{T}{x} = \left(x - K\right) ^+
    \label{eq:BSMterminal}
  \end{equation}
\end{center}

Whilst the terminal condition focuses on the value at maturity, the boundary conditions fix some constraints on the extreme values likely to be taken by the shares of stock at any times during the option life. 
In that regard, the boundary condition (\ref{eq:BSMboundary0}) shows that any options with a worthless underlying are themselves valueless, while whenever the option is deep-in-the-money, simulated with $x = \infty$ (\ref{eq:BSMboundaryinf}), the value of the derivative is equal to the value of a forward contract involving the same underlying and with the same maturity date.

\begin{center}
  \begin{equation}
    \call{t}{0} = 0
    \label{eq:BSMboundary0}
  \end{equation}
\end{center}

\begin{center}
  \begin{equation}
    \lim_{x\to\infty} \left[ \call{t}{x} - \left(x - e^{-r \left(T - t \right)} \right) \right] = 0
    \label{eq:BSMboundaryinf}
  \end{equation}
\end{center}


As described in \citet{shreve}, according to the terminal (\ref{eq:BSMterminal}) and boundary conditions (\ref{eq:BSMboundary0}, \ref{eq:BSMboundaryinf}), the BSM solution for the European calls happens to be given by equation (\ref{eq:bsm:bsm:sol}). 
The right-hand side of that equation, $\ct$, denotes the price of a call option depending on the time before maturity, the volatility of the underlying and its price at that period.
In addition to these arguments, two other parameters are required, namely, the strike ($K$) and the riskless interest rate ($r$).

\begin{align}
    \BSMsol
    \label{eq:bsm:bsm:sol}
\intertext{with}
    \dpm
    \label{eq:dpm}
\end{align}

Consequently, \cref{eq:bsm:bsm:sol} will be purposely used in this master thesis to compute the price of an option for which the underlying is exclusively driven by a geometric Brownian motion.






% \begin{figure}[!h]
% \centering
% \input{figures/BSMvsSt.tex}
% \caption{Relation between call price and underlying}
% \label{plot:BSMvsSt}
% \end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: The greeks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The greeks}
\label{sec:greeks}


The Black-Scholes-Merton equation (\ref{eq:bsm:bsm:eq}) can be subdivided into differents parts.
Each one is identified through a Greek letter ($\Delta$, $\Theta$, $\Gamma$). 

The Greeks will afterward be used to show how the hedge of a call option behaves under the conditions defined in \citet{bs} and beyond. 
Indeed, $\Delta$ has a key role in the hedging strategy because it can be used to capture the effect that an instantaneous change in the asset has to the derivative.
$\Gamma$ can remove the error of approximation incurred by a hedge based on $\Delta$ due to the discretization of the timeframe.
Whereas $\Theta$ is not taken into account for the hedging strategy because it relates to the passing of time and nobody can prevent it.

These letters are described in this section as well as their implication in the present work.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Delta
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Delta}
\label{sub:Delta}

As shown in \citet{shreve}, delta is the first derivative of the call function (\ref{eq:bsm:bsm:sol}) with respect to the stock price function, as shown by \cref{eq:bsm:call}.
It, therefore, represents the instantaneous rate of change of a call's value as the price of its underlying evolves.

\begin{align}
    \Delta \left(t, \St \right) &= \frac{\partial \call{t}{\St}}{\partial \St}
    \label{eq:bsm:call}
    \intertext{Whereas practically, following \citet{shreve}, the derivation of delta for a call is given by equation \ref{eq:deltaCall}.}
    \Delta_{call} \left(t, \St \right) &= \N{\dsub{+}}
    \label{eq:deltaCall}
\end{align}

According to \citet{hull}, at each period $t$, in order to hedge a short call one should hold $\Delta(t)$ share of stock. 
Consequently, a portfolio comprised of one short position in a call along with $\Delta$ shares of stock is said to be delta-neutral, because each movement in the stock price is compensated between the short position in the call and the long in the stock.

The delta neutrality could otherwise be explained using the slope-intercept form of the tangent line below the function $\call{t}{x}$, keeping t constant. If the stock price is equal to $S$ and the corresponding call price, for a fixed time $t$ and stroke at $k$, is $c$, we consequently get (\ref{eq:slopeInterceptCallStock}) as equation of the tangent line below $\call{t}{x}$.
\begin{center}
  \begin{equation}
       y  =  \frac{\partial \call{t}{\St}}{\partial \St}  ( x - S) + c
       \label{eq:slopeInterceptCallStock}
  \end{equation}
\end{center}
According to \ref{eq:slopeInterceptCallStock}, the price of the call, for a stock price $S$ at a fixed time $t$ is given by $y = c$.
If -- over an infinitesimally small delta time -- a positive stock price movement occurs, e.g., the stock price rises from $S \to S + \epsilon$. The price of the call is, therefore, going to change as well, from $y = c$ to $y = \Delta \epsilon + c$.
Consequently, in order to hedge a short position in the call, $\Delta$ shares of stock should be owned. Indeed, by keeping $\Delta$ shares, the loss incurred by the higher value of the call $y = c + \Delta \epsilon$ will be offset by an increase of $\Delta \epsilon$ thanks to the number of $\Delta$ shares held.
It makes sense that the hedging of a long call is achieved by setting up a short position in the underlying, according to the same parameter $\Delta$.

According to \citet{shreve}, the hedge works well for small price movement in the underlying and is closely related to the curvature of the function $\call{t}{c}$, keeping $t$ constant.
It would, therefore, be interesting to look at the second derivative of the call function with respect to the stock price, in order to get the rate of the rate of change (the acceleration) of the call with respect to the underlying price.
The next \cref{sub:Gamma} devotes to it.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Gamma
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Gamma}
\label{sub:Gamma}

According to \citet{shreve}, Gamma ($\Gamma$) is the second derivative of the option pricing function with respect to the underlying price, time been constant (\ref{eq:GammaDerivative}). 

\begin{align}
    \Gamma \left(t, \St \right) &= \frac{\partial^2\call{t}{\St}}{\partial \St^2}
    \label{eq:GammaDerivative}
    \intertext{Whereas practically, the derivation of gamma for a call is given by equation \ref{eq:gammaCall}.}
    \Gamma_{call} \left(t, \St \right) &= \frac{1}{\sigma \St \sqrt{\Delta t}} N^\prime \left( \dsub{+} \right)
    \label{eq:gammaCall}
\end{align}

It gives the acceleration at which the price of a call moves along with the underlying price, ceteris paribus. 
Therefore, thanks to gamma,  the curvature of the function to be approximated using the differential form is known. 
It can be crucial to at least assess how big is the value of gamma in order to adequately hedge a position in a call. 
Indeed, if gamma is low, the rebalancing of the hedge does not have to occur as frequently as if it is high because any change in the underlying asset would bring a little move in the derivative price, letting delta be a good approximation of the option evolution with respect to the asset price.


As a portfolio can be delta-neutral, \citet{roman} showns that it can also be gamma-neutral. However, making a portfolio gamma-neutral forces to add another derivative on the same underlying inside it to vanish the gamma, with the consequence to modify the delta of the portfolio. It, therefore, implies to recompute the delta in order to restore the delta-neutrality of the portfolio

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Theta
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Theta}
\label{sub:Theta}

Theta is the derivative of the price of an option with respect to the time, stock price being unchanged (\ref{eq:ThetaDerivative}).

\begin{center}
  \begin{equation}
    \Theta (t) = \frac{\partial \call{t}{\St}}{\partial t}
    \label{eq:ThetaDerivative}
  \end{equation}
\end{center}

According to \citet{hull}, Theta can be used as a proxy for gamma in a delta-neutral portfolio.
Indeed, because of its neutrality, delta so disappears of \cref{eq:BSMGreeks} letting the relation between gamma and theta become clearer, that is, according to the option price and the value of theta, gamma can be assessed.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Relation between BSM and the greeks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Relation between BSM and the Greeks}
\label{sec:BSMGreeks}

The BSM equation and the Greeks closely relate together.
Indeed, the BSM partial derivative equation (\ref{eq:bsm:bsm:eq}) could equally be written using the greeks, as shown by \cref{eq:BSMGreeks}.

\begin{center}
  \begin{equation}
    \BSMGreeks{\St}
    \label{eq:BSMGreeks}
  \end{equation}
\end{center}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: The delta hedging rules
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The delta hedging strategy}
\label{sec:bsm:delta:hedge}

The purpose of the delta hedging rules is to fully replicate the reverse position taken in an option to cover oneself against lost. The technique is achieved by continuously rebalancing its position in order to keep an amount of $\Delta(t)$ share of stock for each period $t$.

Consequently to hedge a short position in a European call option, one should construct a portfolio made up of a given amount of share of stock to replicate a long position in the same derivative.
The quantity of the underlying asset to keep in that portfolio at any time is provided by the resolution of the delta (\ref{eq:deltaCall}) for the appropriate period.

\Cref{eq:bsm:delta:reverse:portfolio} shows the relation between a European short call and the delta-neutral portfolio that replicates the reverse position in the derivative for any time $t \in [0, T]$, where $T$ denotes the time to maturity.

\begin{align}
  c(t, S(t)) = \Delta(t) S(t) + e^{r (t - t_0)} c(t_0, S(t_0)) -
  \left(\sum_{t_i \in ]0, t]} \left( \Delta(t_{i} - t_{i-1}) S(t_i) \right) + \Delta(t_{0}) S(t_0) \right),
  \forall i \in \mathbb{Z} : i \in \left \{1, T \right \} \label{eq:bsm:delta:reverse:portfolio}
\end{align}
where the set $i$ is the time-step.
























%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Flaws
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Flaws}
\label{sec:Flaws}


* Other process than the geom
* Volatility + volatility smiles (how option ar priced)
* curvature of the distribution

Even if the \cref{eq:underlying:geometric:closed} is used to model the stock price process, it exists some lacks with the observed real processes. The analysis ([CHA REF]) mainly covers the following discrepancy of the model against empirical results.
  
The volatility appearing in the aformentioned underlying model (\ref{eq:underlying:geometric:closed}) is constant as time passes. However, as stated by \citet{teneng2011limitations}, even if this consideration can be considered as true for short period of time, it is not the case over the long-run 

Other model substitutes the process defined throughout this chapter with other ones including stochastic volatility processes, making it changing over time.
For this purpose, the Heston's model is developed in this current master thesis, which encompasses two stochastic processes, a geometric Brownian motion [???? + REF] for the stock price diffusion model [DIFUSION??] and a mean-reverting CIR model to compute the volatility as a stochastic process.
This model is exposed in \cref{sec:Heston}.

Following [REF and REF], the uderlying log--returns distribution is characterized by the normal law. Consequently, the random variable $\St$, at the fixed time $t$, is normal. 
However, according to empirical results, the random variable $d\St$ do not fit with the normal bell curve (\citet{clark1973}).
Therefore if the price changes are not normally distribution neither is the log--return and thus $\St$, at a fixed time $t$, is not log--normally distributed.
Along with the Heston model, another one is considerd; the Merton's jump--diffusion model. Both are able to modify the skewness and kurtosis of the log--return distibution curve. The Merton framework is developed in \cref{sec:MixedJump}. 












%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  CHAPTER:Other Models to be considered
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Other Models to be considered}
\label{cha:OtherModel}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Overview
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Overview}
\label{sub:OverviewJump}
% Jump processes could be separated into two different category. 
% In one hand there are jump-diffusion model, and in other hand it exists pure jump model.
% Difference is related to the frequency of jump occurence. for the first, the occurence is defined by a parameter and could therefore occurs more of less frequently depending on the parameter set up.
% In the contrary for the latter, jump arrive as frequenty as the stock price goes through time.
% The purpose of this section is to describe these process and give a mathematecally model in order to practice it.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Mixed jump-diffusionModel
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Merton Mixed jump-diffusion Model}
\label{sec:other:merton}

In his paper, \citet{merton76} provides a model for stock price evolution involving jumps (\cref{eq:other:merton:pde}). 


\begin{align}
  \St &= S\left(0\right) e^{\left(\alpha - \frac{\sigma^2}{2} - \lambda \kappa\right) t + \sigma \Bm + \sum_{i=1}^{N_t} Y_i}
  \label{eq:other:merton:pde}
\end{align}
  
According to \citet{merton76}, there are two specific sources of uncertainty explained by the model (\cref{eq:other:merton:pde}). 
The first one is qualified to be normal, arising repeatedly with low effects and keeping the stock price motion continuous from time to time. These small changes on the price are modeled by a Wiener process, such as it was the case in equation \ref{eq:Scontinuous}. The cause of these changes is explained by a temporary unbalanced between the supply and demand \citet{merton76}.
Another type of changes, occuring during the stock lifecycle, are qualified as abnormal. Such "abnormalities" happen less frequently, are unpredictable in their frequency and produce bigger effect on the stock price by giving rise to jumps in the course of stock path and therefore breaking its continuity (\citet{merton76}). The jump process is constructed on double basis. 

Firstly, the occurence (i.e. the number of jumps arising throughout a given period of time) is computed thanks to a Poisson--driven process according to a parameter $\lambda$. 
$\lambda$ denotes the number of jumps per unit of time. Consequently, the probability that a jump occurs during a time range of $\Delta t$ is equal to $\lambda dt$ (event $A$, eq. \ref{eq:PA}), whereas the probability that there are no jump during the same range of time is $1 - \lambda dt$, (event $B$, eq. \ref{eq:PB}) (\citet{matsuda2004}). While C, eq. \ref{eq:PC}, refers to the event that more than one jump occur during the same small delta time.

\begin{align}
  \mathop{\mathbb{P}} \{A\}&\cong \lambda dt  \label{eq:PA}\\
  \mathop{\mathbb{P}} \{B\}&\cong 1 - \lambda dt  \label{eq:PB}\\
  \mathop{\mathbb{P}} \{C\}&\cong   0 \label{eq:PC}
\end{align}

On the other hand, after the occurence comes the size of the jump. Such as the frequency, the importance of the jump can be characterized by a statistic law. Following \citet{heston}, the log--normal law is used. \citet{matsuda2004}, gives a summary in oder to grips with the concept of jump size  \crefrange{eq:yt}{eq:lny}.
 
\begin{align}
  y_t  &\sim lognormal( e^{\mu + \frac{1}{2} \delta^2}, 
                        e^{2 \mu + \delta ^2} (e^{\delta^2} - 1)) 
  \label{eq:yt} \\
  y_t - 1 &\sim lognormal( \kappa \equiv e^{\mu + \frac{1}{2} \delta^2} - 1, 
                        e^{2 \mu + \delta ^2} (e^{\delta^2} - 1)) 
  \label{eq:ytminus1} \\
  \ln{y_t} &\sim normal(\mu, \delta^ 2)
  \label{eq:lny}
\end{align}
with $y_t$, $y_t - 1$ and $\ln{y_t} \equiv Y_t$ standing respectively for "absolute price jump size", "relative price jump size" and "log price jump size" (\citet{matsuda2004}).

 
The Merton's jump-diffusion process is be able to capture positive / negative skewness (see \cref{sub:MertonSkewness}) and excess kurtosis (see \cref{sub:MertonKurtosis}) of the log--return density function \citet{merton76}. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Risk-neutralized process
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Risk-neutralized process}
\label{sub:other:merton:risk}

In order to find the fair price of an option depending on an underlying that follows such a jump-diffusion process, \citet{merton76} turns \cref{eq:other:merton:pde} into one risk-neutral.

\begin{align}
  \St &= S\left(0\right) e^{\left(r - \frac{\sigma^2}{2} - \lambda \kappa\right) t + \sigma \Bm + \sum_{i=1}^{N_t} Y_i}
  \label{eq:other:merton:pde:riskneutral}
\end{align}

\citet{merton76} argues in his paper that the jump component of \cref{eq:other:merton:pde} can be diversified in a well-balanced portfolio and consequently does not need to be risk-neutralized.

However, likewise it was done by \citet{bs}, the drift part of \cref{eq:other:merton:pde} is risk-neutralized by turning the rate $\alpha$ into its riskfree counterpart $r$, as shown by \cref{eq:other:merton:pde:riskneutral}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Graphical representation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Graphical representation}
\label{sub:other:merton:graphical}   

\Cref{p:other:merton:path} shows a unique time serie generated using an implementation of \cref{eq:other:merton:pde}. A jump is clearly noticed at day 363. While
\Cref{t:other:merton:path}, which is a subset of the time serie drawn in \cref{p:other:merton:path}, illustrates numerically when the jump occurs.

\begin{table}[ht]
\centering
\begin{tabular}{ll}
  \hline
 time periods (days)& stock price\\ 
  \hline
  0   &50.00 \\ 
  1   &49.72 \\ 
  2   &49.87 \\ 
  \vdots & \vdots \\
  323 &83.44 \\ 
  324 &94.98 \\ 
  \vdots & \vdots \\
  363 &97.41 \\ 
  364 &97.07 \\ 
  365 &97.00 \\ 
   \hline
\end{tabular}
\caption{Merton Mixed jump-diffusion time serie}
\label{t:other:merton:path}
\end{table}

\begin{figure}[ht]
  \centering
  \input{figures/merton.path.tex} 
  \floatfoot{Simulation of one Merton mixed jump-diffusion time serie. Data have been output by the R function \textit{sstoch\_jump()} which is an implementation of equation \cref{eq:other:merton:pde} (see appendix \ref{sub:r:time:merton}, for more information). The parameters passed to the function are:  $S(0) = 50$,   $T = 1$ (in year, along with a time step of 365 measures per year),  $\sigma = 0.2$, $\alpha = 0.5$,  $\lambda = 2$,  $\mu = 0.05$, and $\delta = 0.1$.}
  \caption{Merton mixed jump-diffusion time serie}
  \label{p:other:merton:path}
\end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Skewness
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Impact on the skewness log--return}
\label{sub:MertonSkewness}

The way to influence the direction of the distibution's shape is achieved by moving the cursor of the expected value of jump impact, in other word, by changing the value of the parameter $\mu$. The figure [REF] shows how the density's shape of the log--return may vary along with this parameter.


\begin{figure}[ht]
\centering
\input{figures/MertonJumpReturn.tex}
\caption{Merton: Daily Basis Stock Return Density}
\floatfoot{
The above density function has been constructed over three distinctive groups of 5000 samples eachs. All samples have been constructed following \cref{eq:other:merton:pde}. The only parameter that changes over the group is $\mu$ which is set to ($-0.5$, $0$, $0.5$) respectively for the blue, green and red density function. The black density belongs to the normal curve with mean 0 and standard deviation of $\sqrt{dt} \times \sigma$. 
}
\label{plot:MertonReturnDensity}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: kurtosis
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Impact on kurtosis log--return}
\label{sub:MertonKurtosis}

The way to influence the aspect of the distibution's tails is achieved by moving the cursor of the expected value of jump occurence, in other word, by changing the value of the parameter $\lambda$. The \cref{p:MertonReturnDensityTails} shows how the distribution's tails of the log--return may vary along with this parameter.

\begin{figure}[ht]
\centering
\input{figures/MertonJumpReturnTails.tex}
\caption{Merton: Daily Basis Stock Return Density}
\floatfoot{
The above density function has been constructed over three distinctive groups of 5000 samples eachs. All samples have been constructed following \cref{eq:other:merton:pde}. The only parameter that changes over the group is $\lambda$ which is set to ($1$, $3$, $5$) respectively for the blue, green and red density function. The black density belongs to the normal curve with mean 0 and standard deviation of $\sqrt{dt} \times \sigma$. 
}
\label{plot:MertonReturnDensityTails}
\end{figure}













%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Heston stochastic volatility model
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Heston stochastic volatility model}
\label{sec:other:heston}

In his paper, \citet{heston1993} tackles with another discrepancy against the real world behaviour introduced by the geometric Brownian motion, namely, its deterministic and immutable volatility $\sigma$.

In addition to provide a model where the volatility is stochastic (\cref{eq:other:hsvvol}), \citet{heston1993} gives the possibility to make that volatility in correlation with the stock price process (\cref{eq:other:hsvstock}), according to the parameter $\rho$ defining how the Brownian motions from both processes relates together.

\begin{align}
    \HSVvol \label{eq:other:hsvvol} \\
    \HSVstock \label{eq:other:hsvstock} \\
    \intertext{
    The drift part of the risk stochastic process (\ref{eq:other:hsvvol} is made up of the long--run mean $\theta$ togehter with the mean reversion speed, given by $\kappa$, \citet{heston1993}.
    }
    d\Bmsub{v} d\Bmsub{s} &= \rho \label{eq:other:rho}
\end{align}

\Cref{eq:other:hsvstock} represents the evolution of an asset though time given, by its differential form. Such as \cref{eq:underlying:geometric:closed}, developed by \citet{bs}, the parameter $\alpha$ gives the drift rate of return. The difference between both models lies in the way the volatility is perceived. In \citet{heston1993}, the asset volatility is given by the stochastic \cref{eq:other:hsvvol}. More specifically, the volatility thus defined follows a Cox--Ingersoll--Ross process.

\Crefrange{eq:other:hsvvol}{eq:other:hsvstock} will be used to build Monte Carlo simulations with the goal of getting samples of dummy stock price motions under real--world assumptions. The framework to use for option pricing purpose is given in \cref{sub:other:heston:risk}.

\subsection{Model parameters}
\label{sub:other:heston:model}

Here are described all the parameters appearing in the Heston stochastic volatility model.

\begin{tabular}{ll}
  $S(t)$ & Price of the stock at time t \\
  $\alpha$ &  Annualized -- and deterministic -- expected return \\
  $V(t)$ & Observed volatility of the stock at time t \\
  $\kappa$ & Mean-reversion speed \\
  $\theta$ & Volatility's long-run mean \\
  $\sigma$ & Volatility of the volatility 
\end{tabular}

\subsection{Feller condition}
\label{sub:other:heston:feller}

Due to the time discretisation brung by The Monte Carlo simulation, the stochastic process \ref{eq:other:hsvvol} may turn out to be negative sometime. If such a negative value is appear at time $t$, the next value computed for $t+\epsilon$ will raise an error, due to the term $\sqrt{V(t)}$ that obviously does not exist for negative value.

In his paper, \citet{feller1951} demonstrates that a process such the one described by \cref{eq:other:hsvvol} does not reach negative value if the following relation \ref{eq:other:feller} is respected.

\begin{align}
  &\lim_{V\to 0} \left( \kappa \theta - V - \frac{1}{2} \frac{\partial(\sigma \sqrt{V})^2}{\partial V} \right) \geq 0 \label{eq:other:feller} \\
  \iff &\lim_{V\to 0} \left( \kappa \theta - V - \frac{1}{2} \sigma^2 \right) \geq 0 \notag \\
  \iff &\kappa \theta  - \frac{1}{2} \sigma^2  \geq 0 \notag \\
  \iff & 2 \kappa \theta  - \sigma^2  \geq 0 \label{eq:other:feller:heston}
\end{align}

Consequently, if the condition related by \cref{eq:other:feller:heston} is respected, no negative values would occur by using a Monte Carlo simulation to compute the CIR stochastic volatility.

\subsection{Risk--neutralized processes}
\label{sub:other:heston:risk}

Likewise it has been done by \citet{bs}, \citet{heston1993} used a risk-neutral framework to price options.
To do so, Heston modified the drift parameters of both price and volatility stochastic processes.

The drift part of the price diffusion (\cref{eq:other:hsvstock}) is risk--neutralized by turning the rate $\alpha$ into its riskless counterpart $r$, as shown by \cref{eq:other:hsvstock:riskless}.

\begin{align}
    \HSVstockriskless \label{eq:other:hsvstock:riskless}
\end{align}

In order to make the volatility process risk--neutralized, Heston added the risk premium parameter, $\lambda$, to the drift part of \cref{eq:other:hsvvol}. The risk--neutralized CIR process is given by cref{eq:other:hsvvol:riskless}.

\begin{align}
    \HSVvolriskless \label{eq:other:hsvvol:riskless} \\
    \intertext{where}
    \kappa^{*} & = \kappa + \lambda \label{eq:other:kappa:riskless} \\
    \intertext{and}
    \theta^{*} & = \frac{\kappa \theta}{\kappa^{*}} \label{eq:other:theta:riskless}
\end{align}

Consequently the parameters $\kappa^{*}$ and $\theta^{*}$, which respectively denote the long--run mean and mean--reversion speed, are the ones to estimate while dealing with pricing options purposes. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Graphical representation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Graphical representation}
\label{sub:other:heston:graphical}   

Figures \ref{p:other:uncorrelatedheston} and \ref{p:other:correlatedheston}, get a hands-on insight into how the correlation between the underlying Brownian motions of the stock and volatility time series affect both processes.
\cref{p:other:uncorrelatedheston} shows a correlation between the Wiener processes $B_1$ and $B_2$ sets to $\rho = -1$, making the two Markov motions perfectly negatively correlated. 
It directly affects the course of the stocks serie, which is altogether correlated in the same negative direction with respect to the CIR volatility process as well.
Likewise, \cref{p:other:correlatedheston} points out the fully positive correlation occuring between the processes \ref{eq:other:hsvvol} and \ref{eq:other:hsvstock} whilst the Brownian motions correlation is set to one. 

\begin{figure}[ht]
\centering
\input{figures/UncorrelatHeston.tex} 
\floatfoot{Simulation of Heston time series. Data have been output by the R function \textit{heston()} which is an implementation of equation \crefrange{eq:other:hsvvol}{eq:other:rho} (see appendix \ref{sub:r:time:heston}, for more information). The parameters passed to the function are:  $S(0) = 50$,  $V(0) = 0.2$,  $T = 5$ (years, along with a time step of 365 measures per year),  $\alpha = 0$,  $\kappa = 0.5$,  $\Theta = 0.2$,  $\sigma = 0.1$ and $\rho = -1$. 
} 
\caption{Heson Framework Using Negative Correllated Brownian Motions}
\label{p:other:uncorrelatedheston}
\end{figure}


\begin{figure}[ht]
\centering
\input{figures/correlatHeston.tex}
\caption{Heson Framework Using Positive Correllated Brownian Motion}
\floatfoot{Simulation of Heston time series. Data have been output by the R function \textit{heston()} which is an implementation of equation \crefrange{eq:other:hsvvol}{eq:other:rho} (see appendix \ref{sub:r:time:heston}, for more information). The parameters passed to the function are:  $S(0) = 50$,  $V(0) = 0.2$,  $T = 5$ (years, along with a time step of 365 measures per year),  $\alpha = 0$,  $\kappa = 0.5$,  $\Theta = 0.2$,  $\sigma = 0.1$ and $\rho = 1$.
}
\label{p:other:correlatedheston}
\end{figure}



The usage of the aforementioned Heston model lies in the fact that the correlation between the CIR and asset processes' Brownian motions would notably explain the spot return skewness whereas the kurtosis of the distribution may be affected by the volatility parameter $\sigma$ of the volatility stochastic process (\cref{eq:other:hsvvol}), (\citet{heston1993})
It may consequently be consistent with what happens in the equity market, namely a sharp decrease in equity price implies an increase in stock volatility (\citet{criso2015}).
% Nevertheless, even though Heston model gives a framework with stochastic volatility, over the long--run the spot return would be characterized by a normal distribution as limiting distribution, with $\theta$ as variance per unit of time. By consequence, Black--Scholes--Merton should work well for such long term option.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Impact on skewness density return
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Impact on log--return density's skewness}
\label{sub:hestonskewness}

Through the Heston stochastic volatility model, the skewness of the distribution of continuously compounded spot return may be affected by the parameter $\rho$. 

When a positive correlation exists between both Brownian motions, an increase in the volatility implies a rise in the asset price whereas a decrease in the volatility tend to lower the asset price.
In other words, when the uncertainty is high and consequently the changes in the asset price are numerous, these latter tend to be positive. 
That is why the distribution of the spot return is offset to the left with a right fat tail when $\rho$ is positive.

The opposite relation is noticed with negative correlation, namely, lower prices relate to higher volatility generating a left fat tail in the log–return distribution (\citet{heston1993}).
These statements are observed in \cref{p:other:heston:skewness}.



\begin{figure}[ht]
\centering
\input{figures/skewnessHeston.tex}
\caption{Merton: Log--return skewness on Heston}
\floatfoot{The above densities function (red, blue and green) are constructed over three distinctive groups of 10000 samples each. The black curve density is theoretical.
All samples are generated by an algorithm based on \cref{eq:other:hsvstock} for the stock data and on \cref{eq:other:hsvvol} for the related volatility (see function \textit{heston()} on appendix \ref{sub:r:time:heston} for more information).
The only parameter that changes over the groups is $\rho$ which is set to $-0.5$, $1$, $0.5$. The log-return densities of these groups are respectively represented by the red, green and blue outlined density functions. 
The black density represents to the normal bell curve with mean $- \frac{\theta}{2}$ and standard deviation of $\sqrt{\theta}$. The log-price return cover a period of one year with a time step of 500.
}
\label{p:other:heston:skewness}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Impact on kurtosis density return
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Impact on kurtosis density return}
\label{sub:hestonkurtosis}

Following \citet{heston1993}, the kurtosis of the distribution of the spot return may be affected by the parameter $\sigma$, which represent the volatility of the volatility.

First and foremost, following \cref{eq:other:hsvvol} if $\sigma = 0$, the volatility V of the Heston model turns out to be deterministic and \cref{eq:other:hsvstock}  becomes a geometric Brownian motion with normal distribution for the time series' log-returns.
Otherwise, \citet{heston1993} showed that by rising $\sigma$, the kurtosis of the spot returns increases. Consequently, within the Heston stochastic volatility model, the bigger $\sigma$, the fatter the tail, ceteris paribus. These statements are observed in \cref{p:other:heston:kurtosis}.

\begin{figure}[ht]
\centering
\input{figures/density.heston.kurtosis.tex}
\caption{Merton: Log--return skewness on Heston}
\floatfoot{The above densities function (red, blue and green) are constructed over three distinctive groups of 10000 samples each. The black curve density is theoretical.
All samples are generated by an algorithm based on \cref{eq:other:hsvstock} for the stock data and on \cref{eq:other:hsvvol} for the related volatility (see function \textit{heston()} on appendix \ref{sub:r:time:heston} for more information). The only parameter that changes over the groups is $\sigma$ which is set to 0, 0.2, 0.4. The log-return densities of these groups are respectively represented by the green, blue and red outlined density curves. 
The black density represents to the normal bell curve with mean $- \frac{\theta}{2}$ and standard deviation of $\sqrt{\theta}$. The log-price return cover a period of one year with a time step of 500.
}
\label{p:other:heston:kurtosis}
\end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: Option pricing method
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Option pricing method}
\label{sec:other:option}

As shown by \cref{sec:other:merton} and \cref{sec:other:heston}, the frameworks developed by \citet{merton76} and \citet{heston1993} drastically change the distribution of any underlying assets following such processes. Therefore, the pricing method to be used must also be adapted in order to take that update into account.

In his paper, \citet{heston1993} developed a techinque to price options using the characteristic function of the underlying asset. Furthermore, according to \citet{criso2015} that method could be used to price every options provided that the underlying's characteristic  is known.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Probabilistic approach
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Probabilistic approach}
\label{sub:other:option:probabilistic}

\citet{heston1993} proposed the solution given by \cref{eq:other:call:heston} to price a european call option.

\begin{align}
  C(t) = S(t) P_1 - e^{-r(T-t)} K P_2 \label{eq:other:call:heston}
\end{align}

Through this method, the european call price at time $t$, namely $C(t)$, is computed thanks to \cref{eq:other:call:heston}, where $S(t)$ and $e^{r(T - t)}$ respectively stand for the stock price and the present value of the strike at that time $t$.

\begin{align}
  P_1(x,V,t;\ln{K}) &= \frac{1}{2} + \frac{1}{\pi} \int_0^{\infty} Re \left( \frac{e^{-i\phi\ln{K}} \psi(x,V,t;\phi - i)}{i\phi\psi(x,V,t;-i)} \right) d\phi \label{eq:other:call:heston:pi1} \\ 
  \intertext{}
  P_2(x,V,t;\ln{K}) &= \frac{1}{2} + \frac{1}{\pi} \int_0^{\infty} Re \left( \frac{e^{-i\phi\ln{K}} \psi(x,V,t;\phi)}{i\phi} \right) d\phi \label{eq:other:call:heston:pi2}
\end{align}

Following the development in \citet{criso2015}, \Cref{eq:other:call:heston:pi} both are probability quantities that involve the underlying characteristic function, namely $\psi(x,V,t;\phi)$. Once these quantities are computed, they are substituted in \cref{eq:other:call:heston} in order to get the call price at time $t$.

The characteristic functions for the Merton jump--diffusion (\cref{sec:other:merton}) and Heston stochastic volatility (\cref{sec:other:heston}) models are developed \cref{sub:other:option:merton,sub:other:option:heston}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Characteristic function for Merton Mixed jump--diffusion model
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Characteristic function for Merton Mixed jump--diffusion model}
\label{sub:other:option:merton}

\citet{matsuda2004} demonstrates that the characteristic function of the Merton mixed jump-diffusion process is given by \cref{eq:other:merton:psi}. The baseline equation to construct the Merton's process characteristic function is the risk-neutralized version, namely \cref{eq:other:merton:pde:riskneutral}.

\begin{align}
\psi^{merton}(\phi) &= e^{ 
  \lambda (T - t) \left( e^{i \mu \phi - \frac{\delta^2 \phi^2}{2}} - 1\right) +
  i \phi \left( \ln S(t) + \left(  r - \frac{\sigma^2}{2} - \lambda \kappa \right) (T - t) \right) -
  \sigma^2 \frac{\phi^2}{2} (T - t)
}
\label{eq:other:merton:psi} \\
\intertext{where}
\kappa &= e^{\mu + \frac{\delta^2}{2}} - 1 \notag \\
\end{align}
  
According to the method given by \citet{heston1993}, the characteristic function \ref{eq:other:merton:psi} will be used inside \cref{eq:other:call:heston:pi1,eq:other:call:heston:pi2} in order to compute the quantities $P_1$ and $P_2$ that could be thereafter replaced inside \cref{eq:other:call:heston} to find the european call price  $C(t)$ corresponding to a stock price process $S(t)$ driven by the Merton mixed jump--diffusion model.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Characteristic function for Heston stochastic volatility model
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Characteristic function for Heston stochastic volatility model}
\label{sub:other:option:heston}

Following the development proposed by \citet{gatheral2006}, \citet{criso2015} provided the Heston characteristic function (\cref{eq:other:heston:psi}) based on the process $\ln S(t)$.

\begin{align}
  &\psi^{heston}\left(\ln(S(t)),V(t),t;\phi\right) = e^{C(T-t, \phi)\theta + D(T-t, \phi)V(t) + i\phi\ln\left(S(t)e^{r(T-t)}\right)} \label{eq:other:heston:psi} \\
  \intertext{where}
  &C(\tau, \phi) = \kappa \left(r_{-} \tau - \frac{2}{\sigma^2}\ln\left(\frac{1 - g e^{-h\tau}}{1 - g}\right)\right) \notag \\
  &D(\tau, \phi) = r_{-}\frac{1 - e^{-h\tau}}{1 - ge^{-h\tau}} \notag \\ 
  \intertext{and}
  &r_{\pm} = \frac{\beta \pm h}{\sigma^2}; h = \sqrt{\beta^2 - 4\alpha\gamma} \notag \\
  &g = \frac{r_{-}}{r_{+}} \notag \\
  &\alpha = -\frac{\phi^2}{2} - \frac{i\phi}{2}; \beta = \kappa - \rho\sigma i\phi; \gamma = \frac{\sigma^2}{2} \notag
\end{align}

\Cref{eq:other:heston:psi} can be directly used inside \cref{eq:other:call:heston:pi1,eq:other:call:heston:pi2} in order to compute the quantities $P_1$ and $P_2$ that could be thereafter replaced inside \cref{eq:other:call:heston} to find the european call price  $C(t)$ corresponding to a stock price process $S(t)$ driven by the Heston stochastic volatility model.

























%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  CHAPTER:Methodology
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Methodology}
\label{cha:Methodology}

% 
% \section{Overview}
% \label{sec:methodology:overview}

The objective of this master thesis is to measure the performances of the Black-Scholes-Merton (BSM) pricing method when the assumption of normality for the underlying asset's log-returns distribution is not met.
The analysis will be focused on the Apple stock data and its related call options.

The methodology followed to measure such performances is based around three main parts. 
First, The computation of the options price by using, in turn, the BSM, Merton mixed jump-diffusion (MJD) and Heston stochastic volatility (HSV) models. 
After that, the volatility smiles of those computed prices, split by models and maturities, are going to be compared.
Finally, delta-neutral portfolios will be constructed in order to measure the hedging performances of the models mentioned above.


Instead of exclusively using market data, whether to collect the options prices or the stock time-series, some algorithms based on the models and theory explored in the literature review have been purposely created.
Depending on the framework to explore, the options prices will be either computed by using the BSM equation (\cref{eq:bsm:bsm:sol}), if the underlying process relates to a geometric Brownian motion or by using the method developed by \citet{heston1993} (\cref{eq:other:call:heston}), if the underlying process relates to the model MJD or HSV.
In order to assess the delta-neutral portfolios, 
time-series will be required to measure its evolution across time.
Those series will be simulated based on the theories developed by \citet{merton76} and \citet{heston1993} to respectively obtain paths with jumps and others with stochastic volatility as a correlated process.
Consequently,  functions have been created in the R language to perform those tasks. \Cref{t:append:function:r} in appendix \cref{cha:append:function} regroups all those functions mentioned in that chapter and used for the study.



Even though the hedging will not be directly constructed on market data, those data are needed to calibrate the parameters to pass into the functions listed in \cref{t:append:function:r}.
The functions with the objective to calculate the prices of European calls will be calibrated with the Apple European calls market data and, to be consistent, those that simulate time-series will be adjusted using the Apple stock data available on the market.
These processes of calibration are fully explained in \ref{sec:methodology:calibration}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SECTION: calibration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Calibration}
\label{sec:methodology:calibration}





Whenever one deals with functions aimed to reproduce some real-life experiments, the calibration process is crucial because it gives to the functions the capacity to act within appropriate boundaries.

The process of calibration that will be applied in the current section concerns two distinctive groups of parameters. 
Those dedicated to the functions that compute the European call price and those devoted to the functions that simulate the possible stock market movements.
Consequently, the methods to adjust both kinds of arguments differ, mainly because the options prices calculation must be performed under risk-neutral environment and the delta hedging is measured on time-series evolving in a risk-averse world.

Therefore, the market available options prices will be employed to calibrate the functions that compute options values, while those on the Apple stock's prices evolution will serve to estimate the right values to be passed as parameters for the time-series output-related functions.
The option market prices and stock data were downloaded using the package \textit{quantmod}, developed by \citet{quantmod} which uses Yahoo finance as a provider. The datasets so downloaded are available in appendix \ref{cha:appendix:market}.

\Cref{sub:methodology:calibration:option} explains how to operate for the options' parameters, whereas \cref{sub:methodology:calibration:asset} shows the followed procedure to adjust the assets simulations' arguments.






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Option prices' calibration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Option prices based calibration}
\label{sub:methodology:calibration:option}

In accordance with \citet{heston1993} and \citet{criso2015}, provided that the characteristic functions of the MJD and HSV models are known, the European calls prices of such underlying processes can be computed using \cref{eq:other:call:heston}.
Although known, these characteristic functions (\cref{eq:other:merton:psi,eq:other:heston:psi}) need their parameters to be fed with appropriates values to best fit with what is observed in reality.
That is why both functions will be adjusted with referential values before being used.

To do so, the method followed by \citet{criso2015} will be applied.
It consists of finding the arguments that minimize the square of the difference between the options prices provided by the market and those generated by a pricing function.
Such a procedure can be resources consuming because it is iterative, 
consequently to avoid endless computations and since the market comes with a large number of data, the maturities, and strikes listed in \cref{t:methodology:maturity,t:methodology:strike} will be those considered during the analysis.

\begin{table}[h]
\centering
\begin{tabular}{lllllll}
  63 & 91 & 126 & 154 & 182 & 245 & 399 \\
\end{tabular}
\caption{Maturities took into account during the calibration stage} 
\label{t:methodology:maturity}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{llllllllll}
  130 & 140 & 150 & 160 & 170 & 180 & 190 & 200 & 210 & 220 \\  
\end{tabular}
\caption{Strikes took into account during the calibration stage} 
\label{t:methodology:strike}
\end{table}

As for \citet{criso2015}, the optimization method used is the least-square non-linear analysis. 
To work, such a method needs (i) a function that returns dummy data -- i.e., the one to be adjusted --, (ii) a dataset that serves as a template, (iii) a cost function to minimize, and (iv) a set of parameters to optimize.
To perform that analysis, an algorithm developed by \citet{pracma} is directly available in the R language through the function \textit{lsqnonlin} from the R package \textit{pracma}.

The functions that output the artificial data are those exhibited in \cref{t:append:function:r}, that is to say, and for what matters here, \textit{mjd\_call} and \textit{hsv\_call} for the computation of European calls prices using MJD and HSV, respectively.
The template of  options data is available in \cref{t:market:option} (see appendix \ref{cha:appendix:market}).
While the cost function is given by \cref{eq:methodology:cost}, the parameters to assess depend on the underlying model (either MJD or HSV).

\begin{align}
 cst =& \sum_{k \in K} \sum_{t \in T} \left(C_{k,t}^{mkt} - C_{k,t}^{m \oplus h}(arguments)\right)^2
 \label{eq:methodology:cost}, \\
 with K &=  \{130, 140, 150, 160, 170, 180, 190, 200, 210, 220\}, \notag\\
 T &= \left \{63, 91, 126, 154, 182, 245, 399\right \}\notag 
\end{align}
On the one hand, The subscripts $K$ and $T$ respectively stand for the sets of strike prices and maturity dates, while on the other hand, the superscript $mkt$ denotes the "market price" whilst the one $m \oplus h$ refers to either MJD (m) xor (exclusive or) HSV (h) process based prices.

Consequently, \cref{eq:methodology:cost} is that to be minimized by the least-square non-linear analysis, for all strikes and maturities.
The outputs of this process will eventually be the calibrated arguments that maximize the performance of the model with respect to what is observed in reality.

One difficulty when dealing with such an algorithm is that the least-square non-linear analysis approach may return several best-fit sets of arguments due to the existence of multiple local minima in the cost function.
Therefore, in order to select only one set among all the results provided by the optimization method, will be chosen that with which, at strikes and maturity dates equal, the pricing function gives the more of its outputs within the bid-ask spread of the corresponding options whose price is giving by the market, as shown by \cref{eq:methodology:bidask}.

\begin{align}
  max\bigg(C_{bid}^{mkt} \leq C_{K,T}^{m \oplus h}(arguments)  \leq C_{ask}^{mkt} \bigg)
 \label{eq:methodology:bidask}
\end{align}

Even though the cost function to be optimized is the same for both HSV and MJD options pricing procedures, the parameters to adjust are different. \cref{sub:methodology:calibration:merton,sub:methodology:calibration:heston} respectively illustrate the  MJD and HSV related calibration processes along with the associated results.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUBSECTION: Asset prices based calibration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Asset prices based calibration}
\label{sub:methodology:calibration:asset}

To calibrate the parameters to pass to the MJD and HSV models aimed to generate all the dummy times-series that will serve for the analysis of the delta hedging, historical market data on the Apple stock will be used as a template.

To perform such an upstream analysis, an approximation method to estimate the arguments with which the distribution of the log-returns generated by both MJD and HSV models better fit the density curve of the historical log-returns will be implemented.
The list of arguments to adjust is smaller than the one needed to option calibration because the starting point is the set of the already calibrated parameters gotten from options data and will only be readjusted, those they are risk-neutralized.

To get the historical data, the package \textit{quantmod}, developed by \citet{quantmod} which uses Yahoo finance as a provider,  will once more be used. The dataset so downloaded is available in appendix \ref{cha:appendix:apple} and concerns the daily stock price on Apple from 1st January 2017 to 31st December 2017.
\Cref{p:methodology:density:aapl} shows the density curve generated by the log-returns of historical data.

\begin{figure}[h]
  \centering
  \input{figures/appl.logreturns.density.tex}
  \caption{Historical Apple stock Log-returns distribution}
    %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The above density function is constructed over the historical data of the Apple share of stock price evolution from 1st January 2017 to 31st December 2017. 
It represents the empirical distribution of its daily log-returns observed during that period.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:methodology:density:aapl}
\end{figure}

The functions that output the dummy time-series are those exhibited in \cref{t:append:function:r}, namely, \textit{mjd\_ts} and \textit{hsv\_ts} for the generation of  MJD and HSV processes, respectively.
The procedures to calibrate the arguments for those functions are explained in \cref{sub:methodology:calibration:merton,sub:methodology:calibration:heston}.










% SUBSECTION: Merton's model calibration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Merton
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Merton's model calibration}
\label{sub:methodology:calibration:merton}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{Calibration of parameters for option pricing}

In order to use the function \textit{mjd\_call} based on \cref{eq:other:call:heston} to compute the price of European call options on an underlying with increments driven by the MJD model, the parameters $\left\{ \lambda, \mu, \delta ,\sigma \right\}$ must be calibrated with respect to the available market data.

To do so, the aforementioned least-square non-linear analysis will be used together with data on Apple call option as a template.
In that respect, the theoretical models to calibrate are given by \crefrange{eq:other:call:heston}{eq:other:call:heston:pi2} along with \cref{eq:other:merton:psi}, implemented by the R function \textit{mjd\_call}.

Moreover, to stay in a range of acceptable values, the parameters of the MJD model should lie between some defined boundaries. 

Indeed, $\sigma$ and $\delta$, as standard deviation parameters, must range between 0 and 1. 
Otherwise, no limit is fixed for both $\mu$ and $\lambda$, letting the frequency of jumps and their average magnitudes entirely free.

According to those constraints and due to the presence of multiple local minima, the \textit{lsqnonlin} function returns the \cref{t:methodology:call:merton:estimate1} as the whole sets of parameters that make the function \textit{mjd\_call} better fit with reality.

\begin{table}[h]
\centering
\begin{tabular}{llll}
  \hline
lambda & mu & delta & sigma \\ 
  \hline
0.07915 & -0.37583 & 0.08771 & 0.18651 \\ 
  0.11606 & -0.30724 & 0.09993 & 0.18445 \\ 
  0.14411 & -0.24174 & 0.12023 & 0.18676 \\ 
  0.06839 & -0.37680 & 0.18072 & 0.18870 \\ 
  0.10312 & -0.29738 & 0.19545 & 0.18583 \\ 
  0.05698 & -0.38007 & 0.28030 & 0.19043 \\ 
  0.08216 & -0.28573 & 0.27560 & 0.18822 \\ 
   \hline
\end{tabular}
\caption{Best estimates parameters for MJD call option model} 
\end{table}

However, the set of arguments \ref{eq:methodology:arg:merton:riskneutral} is the one making respond the model the best with what is observed in reality.
Indeed, when passing that set to the R function \textit{mjdl\_call}, for all strikes and maturities from \cref{t:methodology:strike,t:methodology:maturity}, more than $68\%$ of the so generated prices are within the bid-ask spread of the Apple option historical data.

\begin{align}
  \left \{
  \begin{array}{lcl}
    \lambda &= &0.1031218, \\
    \mu &= &-0.2973769, \\
    \delta &= &0.1954519, \\
    \sigma &= &0.1858289 
  \end{array}
  \right \}  
  \label{eq:methodology:arg:merton:riskneutral}
\end{align}

\Cref{p:methodology:impliedvol:aapl:merton} confronts the blue colored volatility smiles computed from market data, with those dotted in red, calculated from data provided by the function \textit{mjd\_call}, which takes the items of the set \ref{eq:methodology:arg:merton:riskneutral} as parameters.

\begin{figure}[h]
  \centering 
  \input{figures/appl.impliedvol.merton.tex}
  \caption{Implied volatility of Apple option prices computed with MJD}
      %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The implied volatilities that represent the above volatility smiles have been computed by using an iterative method on the BSM equation to solve  $\sigma$.
  The parameters given to the function \textit{bsm\_call} were the stock price $S$, the strike price $K$, the riskless rate $r$ and the time to maturity $T$, letting $\sigma$ unknown.
  The method used was to find the root of $C(S(0), K, T, r; \sigma) - C_{K, T}$, where $C_{K, T}$ is either the market price or the price giving by the function \textit{mjd\_call}, and $C(S(0), K, T, r; \sigma)$ is the function \textit{bsm\_call} with $\sigma$ as a cursor.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:methodology:impliedvol:aapl:merton}
\end{figure}


Consequently, for the purpose of that master thesis, the set \ref{eq:methodology:arg:merton:riskneutral} is the one that will be used together with the function \textit{mjd\_call} whenever performing the computation of option prices for the MJD model.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{Calibration of parameters for time series}

The set \ref{eq:methodology:arg:merton:riskneutral} is calibrated under the risk-neutral world and cannot, therefore, be used as is to simulate the dummy time-series that will serve the analysis aimed to measure the delta hedging performance.
Furthermore, in addition to those parameters, the drift rate $\alpha$ has to be estimated as well. It was not present in the set  \ref{eq:methodology:arg:merton:riskneutral} because it was not taken into account in the computation of the options prices.

\Cref{p:methodology:density:aapl:merton:riskneutral} shows the empirical density curves illustrating the distributions of the log-returns computed either from historical Apple stock data for the blue curve or from dummy time series generated by the function \textit{mjd\_ts()} fed with the risk-neutral parameters\ref{eq:methodology:arg:merton:riskneutral}, for the red one.


\begin{figure}[h]
  \centering
  \input{figures/appl.logreturns.density.merton.riskneutral.tex}
  \caption{Historical and MJD related Apple stock Log-returns distribution}
  \floatfoot{The above blue density curve is constructed over the historical data of the Apple share of stock price evolution from 18th May 2017 to 18th May 2018. while the red curve is constructed from time-series genereated by the function \textit{hsv\_ts} taking the risk-neutral parameters \ref{eq:methodology:arg:merton:riskneutral} as arguments.
  }
  \label{p:methodology:density:aapl:merton:riskneutral}
\end{figure}



The goal of that section is to find the risk-averse parameters that make both the distributions of the log-returns generated from market data or from \textit{mjd\_ts} fit together.

Practically, to do so, an approximation algorithm developed by \citet{MASS} which is directly available in the R language through the function \textit{fitdistr} from the R package \textit{MASS} will be purposely used. 
The goal of that algorithm is the find the parameters of a density function that make it reproduce the distribution of a sample of data.
To do the job, that algorithm needs (i) a density function along with (ii) a sample of random data as a template.
As defined in \citet{matsuda2004}, the density of the log-returns of time-series generated by the MJD model is given by \cref{eq:methodology:density:merton:log}.

\begin{align}
  P_t(x) &= \sum_{i=0}^{\infty} 
    \frac{e^{-\lambda t} (\lambda t)^ i}{i!}
    N\left[ 
      x;
      \left( \alpha - \frac{\sigma^2}{2} - \lambda \kappa \right) t + i \mu,
      \sigma^2 t + i\delta^2
    \right]\label{eq:methodology:density:merton:log} \\
\intertext{where}
  \kappa &= e^{\mu + \frac{1}{2} \delta^2} - 1 \notag 
\end{align}
The term $e^{-\lambda t} (\lambda t)^ i / i!$ gives the probability that $\lambda$ jumps occur during the time period $t$, while $N$ denotes the normal probability density function.

The parameters to be assessed are the drift and variance rates of the stock prices process, namely, $\alpha$ and $\sigma$, the frequency of the jumps occurrence $\lambda$ and their intensity parameters, that is, $\mu$ and $\delta$.
All of those parameters are fully described in \cref{sec:other:merton}.

%%%% HERE %%%%%%
By giving to the optimization function the \cref{eq:methodology:density:merton:log} as a density function, the Apple stock data \cref{appendix} as a template and the set of variables 
$\left\{\alpha, \sigma, \lambda, \mu,  \delta  \right\}\lambda$ 
as a cursor, that algorithm outputs the set \ref{eq:methodology:arg:merton:riskaverse} as the best fit arguments for the real world parameters.

\begin{align}
  \left \{
  \begin{array}{lcl}
    \alpha &= &0.4816753642, \\
    \sigma &= &0.1020368856, \\
    \lambda &= &99.5434345733, \\
    \mu &= &-0.0006791266, \\
    \delta &= &0.0161092106, 
  \end{array}
  \right \}  
  \label{eq:methodology:arg:merton:riskaverse}
\end{align}


\Cref{p:methodology:density:aapl:merton:riskaverse} shows the empirical density curves illustrating the distributions of the log-returns computed either from historical Apple stock data for the blue curve or from dummy time series generated by the function \textit{mjd\_ts()} fed with the risk-averse parameters\ref{eq:methodology:arg:merton:riskaverse}, for the red one.


\begin{figure}[h]
  \centering
  \input{figures/appl.logreturns.density.merton.riskaverse.tex}
  \caption{Historical and MJD related Apple stock Log-returns distribution in the risk-averse world}
  \floatfoot{The above blue density curve is constructed over the historical data of the Apple share of stock price evolution from 18th May 2017 to 18th May 2018. while the red curve is constructed from time-series genereated by the function \textit{mjd\_ts} taking the risk-averse parameters \ref{eq:methodology:arg:merton:riskaverse} as arguments.
  }
  \label{p:methodology:density:aapl:merton:riskaverse}
\end{figure}

Consequently, for the purpose of that master thesis, the set \ref{eq:methodology:arg:merton:riskaverse} is the one that will be used together with the function \textit{mjd\_ts()} whenever performing the computation of time series using the MJD model within the real world constraints.











%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
%
% HERE
%
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% SUBSECTION: Heston's model calibration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Heston
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Heston's model calibration}
\label{sub:methodology:calibration:heston}

\subsubsection*{Calibration of parameters for option pricing}

In order to use the function \textit{hsv\_call} based on \cref{eq:other:call:heston} to compute the price of European call options on an underlying with increments driven by the HSV model, the parameters $\left\{ V(0), \kappa, \theta, \sigma, \rho \right\}$ must be calibrated with respect to the available market data.
Therefore, the so estimated parameters will be in line with the risk-neutral measure, or more specifically $\kappa$ and $\theta$, which are the only ones needed to be adapted to make \cref{eq:other:hsvvol:riskless} risk-neutral.

To do so and similarly as it was done for the MJD option model, the least-square non-linear analysis will be used together with data on Apple call option as a template.
In that respect, the theoretical models to calibrate are given by \crefrange{eq:other:call:heston}{eq:other:call:heston:pi2} along with \cref{eq:other:heston:psi}, implemented by the R function \textit{hsv\_call}.

Moreover, to stay in a range of acceptable values, the parameters of the HSV model should lie between some defined boundaries. 

De facto, the mean-reversion speed ($\kappa$), the long-run variance ($\theta$) and the volatility of the volatility ($\sigma$) need to take values that together respect the Feller's condition (see \cref{sub:other:heston:feller}). 
Additionally, $\sigma$ must range between 0 and 1 and, according to \citet{cristo2015} $\kappa$ should be positive to avoid mean aversion.
Although the correlation coefficient $\rho$ may take any value from $[-1, 1]$, typically the correlation between the stock price increments and their intrinsic volatility is negative. Consequently, the boundaries of $\rho$ are set as $]0, -1[$.

According to those constraints and due to the presence of multiple local minima, the \textit{lsqnonlin} function returns the \cref{t:methodology:call:heston:estimate1} as the whole sets of parameters that make the function \textit{hsv\_call} better fit with reality.

\begin{table}[h]
\centering
\begin{tabular}{rrrrr}
  \hline
v0 & theta & sigma & rho & kappa \\ 
  \hline
  0.03851 & 0.05142 & 0.29539 & -0.49338 & 1.99931 \\ 
  0.03774 & 0.04832 & 0.30687 & -0.40213 & 3.00036 \\ 
  0.03910 & 0.04948 & 0.40736 & -0.50193 & 3.00005 \\ 
  0.03798 & 0.04872 & 0.50379 & -0.39878 & 4.00106 \\
  0.03740 & 0.04754 & 0.30583 & -0.60126 & 4.00096 \\ 
  0.03661 & 0.04604 & 0.30659 & -0.40295 & 5.00152 \\ 
  0.03921 & 0.04709 & 0.50753 & -0.50170 & 5.00152 \\ 
   \hline
\end{tabular}
\caption{Best estimates for HSV call option model} 
\label{t:methodology:call:heston:estimate1}
\end{table}

However, the set of arguments \ref{eq:methodology:arg:heston:riskneutral} is the one making respond the model the best with what is observed in reality.
Indeed when passing that set to the R function \textit{call\_heston}, for all strikes and maturities from \cref{t:methodology:strike,t:methodology:maturity}  more than $70\%$ of the so generated prices are within the bid-ask spread of the historical data.

\begin{align}
  \left \{
  \begin{array}{lcl}
    V(0) &= &0.03798218, \\
    \theta &= &0.04871543, \\
    \sigma &= &0.50378803, \\
    \rho &= &-0.39877827, \\
    \kappa &= &4.00105546 
  \end{array}
  \right \}  
  \label{eq:methodology:arg:heston:riskneutral}
\end{align}

\Cref{p:methodology:impliedvol:aapl:heston} confronts the blue colored volatility smiles computed from market data, with those dotted in red, calculated from data provided by the function \textit{hsv\_call} which takes the items of the set \ref{eq:methodology:arg:heston:riskneutral} as parameters.

\begin{figure}[h]
  \centering
  \input{figures/appl.impliedvol.heston.tex}
  \caption{Implied volatility of Apple option prices computed with HSV}
  \floatfoot{The blue curves represent the implied volatility computed from the option market data on Apple while the ................
  }
  \label{p:methodology:impliedvol:aapl:heston}
\end{figure}


Consequently, for the purpose of that master thesis, the set \ref{eq:methodology:arg:heston:riskneutral} is the one that will be used together with the function \textit{hsv\_call} function whenever performing the computation of option prices for the HSV model.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{Calibration of parameters for time series}

The set \ref{eq:methodology:arg:heston:riskneutral} is calibrated under the risk-neutral world and cannot, therefore, be used as is to simulate the dummy time-series that will serve the analysis aimed to measure the delta hedging performance.
Furthermore, in addition to those parameters, the drift rate $\alpha$ has to be estimated as well. It was not present in the set  \ref{eq:methodology:arg:heston:riskneutral} because it was not taken into account in the computation of the options prices.

\Cref{p:methodology:density:aapl:heston:riskneutral} shows the empirical density curves illustrating the distributions of the log-returns computed either from historical Apple stock data for the blue curve or from dummy time-series generated by the function \textit{hsv\_ts()} fed with the risk-neutral parameters\ref{eq:methodology:arg:heston:riskneutral}, for the red one.


\begin{figure}[h]
  \centering
  \input{figures/appl.logreturns.density.heston.riskneutral.tex}
  \caption{Historical and HSV related Apple stock Log-returns distribution}
  \floatfoot{The above blue density curve is constructed over the historical data of the Apple share of stock price evolution from 18th May 2017 to 18th May 2018. while the red curve is constructed from time-series genereated by the function \textit{hsv\_ts} taking the risk-neutral parameters \ref{eq:methodology:arg:heston:riskneutral} as arguments.
  }
  \label{p:methodology:density:aapl:heston:riskneutral}
\end{figure}


The goal of that section is to find the risk-averse parameters that make both the distributions of the log-returns generated from market data or from \textit{hsv\_ts} fit together.
To do so, and according to the differences between \cref{eq:other:hsvstock:riskless,eq:other:hsvvol:riskless} and \cref{eq:other:hsvstock,eq:other:hsvvol}, the parameters to modify are the drift rate $r \to \alpha$, the mean reversion speed $\kappa^{*} \to \kappa$ and the long-run volatility $\theta^* \to \theta$.
Accordingly, the correlation parameter $\rho$ and the volatility of the volatility $\sigma$ stay unchanged from the risk-neutral to risk-averse world.

The drift rate $\alpha$ has been estimated by following the method exhibited at \cref{sec:upstream:logreturn}. From the market empirical log-returns' first and second moments, the value $0.4822917$ has been found for $\alpha$.

According to \cref{eq:other:kappa:riskless,eq:other:theta:riskless}, in order to  calculate $\kappa$ and $\theta$, the risk premium $\lambda$ has to be assessed.
Practically, such as it was the case for the MJD model, the function \textit{fitdistr} from the R package \textit{MASS} will be purposely used. 
As defined in \citet{Adrian}, the density of the log-returns generated by the HSV model is given by \cref{methodology:density:heston:log}.

\begin{align}
P_t(x) &= \frac{1}{2 \pi} \int_{-\infty}^{\infty} e^{i \phi x + F_t(\phi)} d\phi \label{methodology:density:heston:log} \\
\intertext{where}
F_t(\phi) &= \frac{\kappa \theta}{\sigma^2} \gamma t -
  \frac{2 \kappa \theta}{\sigma ^2} \ln\left(
    \cosh \frac{\Omega t}{2} +
    \frac{\Omega^2 - \gamma^2 +2 \kappa \gamma}{2 \kappa \Omega} \sinh \frac{\Omega t}{2}
  \right) \notag \\
\intertext{and}
\Omega &= \sqrt{\gamma^2 + \sigma^2 (\phi^2 - i\phi)}, \notag
\gamma = \kappa + i \rho \phi \sigma \notag
\end{align}

By giving to the optimization function the \cref{methodology:density:heston:log} as a density function, the Apple stock data \cref{appendix} as a template and the variable $\lambda$ as a cursor, that algorithm outputs $\lambda = 5.4883278229$, as the best fit argument, for the risk premium.
The set of the risk-averse parameters is fully described here below in \ref{eq:methodology:arg:heston:riskaverse}.

\begin{align}
  \left \{
  \begin{array}{lcl}
    V(0) &= &0.03798218, \\
    \theta &= &0.02054013, \\
    \sigma &= &0.50378803, \\
    \rho &= &-0.39877827, \\
    \kappa &= &9.489383, \\
    \alpha & = &0.4822917
  \end{array}
  \right \}  
  \label{eq:methodology:arg:heston:riskaverse}
\end{align}


\Cref{p:methodology:density:aapl:heston:riskaverse} shows the empirical density curves illustrating the distributions of the log-returns computed either from historical data for the blue curve or from dummy time-series generated by the function \textit{hsv\_ts()} fed with the risk-averse parameters\ref{eq:methodology:arg:heston:riskaverse}, for the red one.


\begin{figure}[h]
  \centering
  \input{figures/appl.logreturns.density.heston.riskaverse.tex}
  \caption{Historical and HSV related Apple stock Log-returns distribution in the risk-averse world}
  \floatfoot{The above blue density curve is constructed over the historical data of the Apple share of stock price evolution from 18th May 2017 to 18th May 2018. while the red curve is constructed from time-series genereated by the function \textit{hsv\_ts} taking the risk-averse parameters \ref{eq:methodology:arg:heston:riskaverse} as arguments.
  }
  \label{p:methodology:density:aapl:heston:riskaverse}
\end{figure}

Consequently, for the purpose of that master thesis, the set \ref{eq:methodology:arg:heston:riskaverse} is the one that will be used together with the function \textit{hsv\_ts()} whenever performing the computation of time series using the HSV model within the real world constraints.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SEC: DELTA HEDGING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Delta hedging}
\label{sec:methodology:delta}

In order to measure the hedging performance of the MJD and HSV models, I will (i) compute the prices of some options and then virtually sell them at that price, (ii)  construct the delta-neutral portfolio at time zero and thereafter continuously rebalance it, in accordance with the underlying asset price evolutions and (iii) measure the overall cost of the hedge as a performance indicator.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUB: Determination of the option price
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Determination of the option price}
\label{sec:methodology:determination}

The computation of the option price at time zero will depend on the underlying model to be hedged.
Indeed, the function \textit{mjd\_call} will be used to price options for which the underlying asset price evolution is driven by the MDJ model, whereas \textit{mjd\_call} will be used for HSV processes.

As explain as an introduction, I will virtually sell the options I price.
Therefore, as the writer of the options, I will raise \$ $X(0) = C_K^{m \oplus h} (0)$.
That cash will directly be put into a money market account to make it grow at a constant riskless rate all along the duration of the hedging process, namely, during the whole life of the option.

The T-bills will serve as riskless rate. According to the available data on \url{https://www.treasury.gov/}, quotes of these are given by \cref{tab:methodology:Tbill}.

\begin{table}[h]
\centering
\begin{tabular}{cccc}
  \hline
  \multicolumn{4}{c}{T-bills} \\
  \hline
  4 weeks & 13 weeks & 26 weeks & 52 weeks \\
  1.66\% & 1.90\% & 2.09\% & 2.30\% \\
  \hline
\end{tabular}
\caption{Treasury bill quotes on 18 May 2018} 
\label{tab:methodology:Tbill}
\end{table}

The rates of \cref{tab:methodology:Tbill} are annual-base, consequently to get their countinuously compounded counterpart, EQUATION X can be used to give those given by \cref{tab:methodology:Tbill:compound}.


\begin{table}[h]
\centering
\begin{tabular}{cccc}
  \hline
  \multicolumn{4}{c}{T-bills} \\
  \hline
  4 weeks & 13 weeks & 26 weeks & 52 weeks \\
  1.659\% & 1.896\% & 2.068\% & 2.274\% \\
  \hline
\end{tabular}
\caption{Treasury bill quotes on 18 May 2018} 
\label{tab:methodology:Tbill:compound}
\end{table}

Thereafter by applying the bootstrap method along with linear interpolation, one can find the maturity-wise related riskless rates of the Apple call option used for the current analysis. Those rates are given by \cref{tab:methodology:tbill:maturity}.

\begin{table}[h]
\centering
\begin{tabular}{l|ccccccc}

  \hline
Maturity(in days) & 63   & 91   & 126  & 154    & 182  & 245    & 399 \\ 
Riskless rate     &  1.817\% & 1.896\% & 1.962\% & 2.015\%  & 2.068\%  & 2.139\%   & 2.311\% \\
   \hline
\end{tabular}
\caption{Maturities explored during the hedging performance measurement} 
\label{tab:methodology:tbill:maturity}
\end{table}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUB: Determination of the option price
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Construction of the delta-neutral portfolio}
\label{sec:methodology:construction}

At time zero, the built of the delta-neutral portfolio is achieved by the purchase of $\Delta(0)$ share of stock multiplying by the number of assets involving in the derivative product.
Simply put, if one wants to construct such a portfolio to cover against the possible losses incurred by the selling of a call option on one hundred shares, the number of underlying to buy at that time would be of $\Delta(t) \times 100$.
For the sake of clarity, in the analysis I will perform, it is implicit that any European call option involves the purchase of only one underlying at maturity, though.
Consequently, at time zero, the cost of such a portfolio is given by \cref{methodology:porfolio:cost:0}.

\begin{align}
p(t_0) = \Delta^{m \oplus h}(t_0) S(t_0) \label{methodology:porfolio:cost:0}
\end{align}
Where the superscripts m (Merton) and h (Heston) respectively stand for the computation of MJD and HSV delta.

The objective of that portfolio is to accurately replicate the reverse position taken in a derivative, i.e., to reproduce a position in a long European call in the case that matters for that analysis.
To be efficient in that role, it must be frequently rebalanced.

Accordingly, in order to do so, I will observe the underlying's time-series at every period of time $\delta t = 1 days$ and compute the updated value of $\Delta(t)$  at each of those observational timesteps.
Therefore, the requisite expenses aimed to keep the portfolio delta-neutral will evolve over time, as shown here below by \cref{methodology:porfolio:cost:i}.

\begin{align}
p(t_i) & = \Delta^{m \oplus h}(t_i - t_{i - 1}) S(t_i) 
,\forall i \in \mathbb{Z} : i \in \left \{1, T \right \}\label{methodology:porfolio:cost:i}
\end{align}

The aforementioned time-series that will be daily scrutinized are obviously hypothetical. They will be generated by the functions \textit{mjd\_ts} and \textit{hsv\_ts} for which the risk-averse parameters will be passed in.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUB: Computation of the delta
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Computation of the delta}
\label{sec:methodology:computation:delta}

By definition, the delta is the first derivative of the option's pricing function with respect to the stock price. It consequently, represents the instantaneous rate of change in the option value as the price of its underlying evolves, such so illustrated by \cref{eq:bsm:call}.

Although \citet{bs} gives to delta the value $\N{\dsub{+}}$, with $d_{+}$ explained by \cref{eq:dpm}, latter can only be used within the framework developed by \citet{bs}, that is, if the underlying is driven by a geometric Brownian motion, the volatility is deterministic, or if no jump occurs.
Accordingly, the solution to compute the delta provided by \citet{bs} cannot be used for such the MJD and HSV models.

By following the definition of delta and because the pricing function of a European call option, for which the underlying asset price evolution is driven by either the MDJ or HSV models, is given by \cref{eq:other:call:heston}, then, the \cref{eq:methodology:delta:mh} gives the solution to compute the delta for such models.

\begin{align}
&\Delta^{m \oplus h}\left(t, S(t)\right)  =
  P_1^{m \oplus h} + 
  S(t) \frac{\partial P_1^{m \oplus h}}{\partial S(t)} - 
  e^{-r(T-t)} K \frac{\partial P_2^{m \oplus h}}{\partial S(t)}
\label{eq:methodology:delta:mh}
\intertext{where}
&\frac{\partial P_1^{m \oplus h}}{\partial S(t)} = 
  \frac{1}{\pi}
  \int_0^{\infty} Re \left[
    \frac{i \phi \exp\left( -i\phi\ln K \right)} {- \phi^2 \psi^{m \oplus h}(-i)^2}  \right. \notag\\
    &\left.
    \mspace{150mu} \times \left(
      \frac{\partial\psi^{m \oplus h}(\phi - i)}{\partial S(t)} \psi^{m \oplus h}(-i) -
      \psi^{m \oplus h}(\phi-i) \frac{\partial\psi^{m \oplus h}(-i)}{\partial S(t)}
    \right)
  \right] d\phi \label{eq:methodology:delta:p1} \\
\intertext{and}
&\frac{\partial P_2^{m \oplus h}}{\partial S(t)} =
\frac{1}{\pi}
  \int_0^{\infty} Re \left(
    \frac{\exp\left( -i \phi \ln K \right)}{i \phi}
    \frac{\partial \psi^{m \oplus h}(\phi)}{\partial S(t)}
  \right)d\phi \label{eq:methodology:delta:p2}
\end{align}

Hence, the \cref{eq:methodology:delta:mh} is the one to solve for both MJD and HSV models to find them the delta at time t.
\Cref{eq:methodology:delta:p1,eq:methodology:delta:p2} can be solved by finding the first derivatives of the characteristic functions of MJD and HSV processes with respect to the stock price. 
By the way, it turns out that both of these have the same form.
\Cref{eq:methodology:psi:derivative:1} gives the solution of these derivatives, the term $\psi^{m \oplus h}(x)$ have to be replaced by the appropriate characteristic function.

\begin{align}
  \frac{\partial\psi^{m \oplus h}(x)}{\partial S(t)} =
    \psi^{m \oplus h}{(x)} \frac{ix}{S(t)} 
    \label{eq:methodology:psi:derivative:1}
\end{align}

By replacing all the derivative operations inside \cref{eq:methodology:delta:p1,eq:methodology:delta:p2} by \cref{eq:methodology:psi:derivative:1}, one finds the solved version given by \cref{eq:methodology:delta:p1:solved,eq:methodology:delta:p2:solved}. 

\begin{align}
&\frac{\partial P_1^{m \oplus h}}{\partial S(t)} = 
  \frac{1}{\pi}
  \int_0^{\infty} Re \left[
    \frac{\exp\left( -i \phi \ln K \right) \psi^{m \oplus h}(\phi -i)}
      {S(t)\psi^{m \oplus h}(-i)}
  \right] d\phi \label{eq:methodology:delta:p1:solved} \\
% \intertext{and}
&\frac{\partial P_2^{m \oplus h}}{\partial S(t)} =
\frac{1}{\pi}
  \int_0^{\infty} Re \left[
    \frac{\exp\left( -i \phi \ln K \right) \psi^{m \oplus h}(\phi)}
      {S(t)}
  \right]d\phi \label{eq:methodology:delta:p2:solved}
\end{align}

Consequently, in the extent that the term $\psi^{m \oplus h}(\phi)$ is replaced by the appropriate characteristic function, substituting \cref{eq:methodology:delta:p2:solved,eq:methodology:delta:p2:solved} into \ref{eq:methodology:delta:mh} gives \ref{eq:methodology:delta:full} that allows the computation of the delta of an option for which the underlying asset is driven by either a MJD or HSV process.


\begin{align}
  \Delta^{m \oplus h}\left(t, S(t)\right)  =
  P_1^{m \oplus h} + 
  \frac{S(t)}{\pi}
    \int_0^{\infty} Re \left[
    \frac{\exp\left( -i \phi \ln K \right) \psi^{m \oplus h}(\phi -i)}
      {S(t)\psi^{m \oplus h}(-i)}
  \right] \notag\\
    \mspace{150mu}
  - \frac{e^{-r(T-t)} K}{\pi}
    \int_0^{\infty} Re \left[
    \frac{\exp\left( -i \phi \ln K \right) \psi^{m \oplus h}(\phi)}
      {S(t)}
  \right]
\label{eq:methodology:delta:full}
\end{align}

In that respect, the R functions \textit{mjd\_delta} and \textit{hsv\_delta}, respectively compute the MJD and HSV related deltas at time $t$ by taking the risk-neutral parameters.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SUB: Measuring the hedging performation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Measuring the hedging performation}
\label{sec:methodology:measuring}

Finally, to assess the performance of the delta-hedging, one particular method, given by \citet{he2006calibration}, consists of computing the relative profit and loss (P\&L) of the hedging portfolio.
The equation of the P\&L is provided by \ref{eq:below}

\begin{align}
  P\&L &= e^{-rT} \frac{\pi(S(T), T)}{c(S(0), 0)} \label{eq:below}\\
  \intertext{Where}
  \pi(S(t), t) &= \Delta(t)S(t) + e^{rt} c(S(t_0), t_0)
    - \sum_{i \in \mathbb{Z} : i \in \left [1, t \right ]} \left( e^{r(t-t_i)} p(t_i) \right) - c(S(t), t)
\end{align}


The closer to zero is the P\&L, the better perform the hedge.
A negative P\&L indicates that the action of hedging the call had cost money to the short position in the option while if P\&L is positive, it means that the same position made a profit.

The options that will be hedged have various maturities (${91\footnote{The maturity is expressed in days}, 182, 399}$) and for all of these, many strikes associated \$ (${140, 160, 186, 200, 230}$).
In that way, a comparison between the performances of the delta-hedging could be made between those metrics.

Moreover, the effect of the rebalancing frequency will be observed as well.
Indeed, the measurement of the hedging will be done across three separate portfolios, i.e., one rebalanced twice a day, another once a day and the last will be weekly adjusted.
Consequently, those effects will be compared.

Ultimately, to get a sufficient amount of data that would permit to reveal trends, each hedging strategy that concerns each option will be performed on one hundred dummy time-series.
Each of these will be either constructed by the function \textit{mjd\_ts} or \textit{hsv\_ts} depending on the model being assessed.





















\chapter{Analysis and results}
\label{cha:analysis}

The objective of the current chapter is to measure the hedging performance of the Black-Scholes model when the stock price evolves in a not log-normal world.
The studied models in \cref{cha:OtherModel} allowing the course of a time-series to go out of the Black-Scholes frame are the Merton jump-diffusion (MJD) and Heston stochastic volatility(HSV).
They have been implemented and adjusted for the purpose of that analysis. 
For both models, two kinds of calibrated parameters have been found out, namely, the risk-neutral and risk-averse ones. 
Therefore, the "no risk" parameters are used to price options, while those risky serve to generate time-series by using the aforementioned models.

The chosen metric to compare the models' performances is the relative profit and loss (P\&L). Latter is explained in \cref{sec:methodology:measuring}.

The analysis is completed in two steps. The first one exclusively concerns the BSM model with all the so related constraints respected. Even though the results of the computations of the options' prices in such an environment do not respect those emerging from reality, the measures of the P\&L so computed serve as a benchmark for the other models to be assessed.
In the next part of the analysis, the P\&Ls for both MJD and HSV will be quantified. Their computations are based on the delta-hedging strategy. On the one hand by using the delta of Black and Scholes and on the other, by using the appropriate delta belonging to the considered model.
Although the Black and Scholes' delta is purposely computed to be applied when the underlying asset is driven by a geometric Brownian motion (GBM), using it together with other processes aims of estimate how one can go wrong within the real conditions.

At last, some particular results will be commented.






















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Log normal world BSM
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The delta-hedging in a log-normal world}
\label{sec:analysis:delta}

In order to use the BSM model for the assessment of the delta-hedging, some of its parameters have to be adjusted, such as it was done in \cref{cha:Methodology} for the processes HSV and MJD.

According to \citet{bs}, only one immutable value for $\sigma$ is taken into account and the difference between the risk-neutral world where the options prices are determined, and the risk-averse one, is the replacement of the riskless rate $r$ by the drift rate $\alpha$.
Consequently, to capture both $\alpha$ and $\sigma$ at once, the method here followed is to adjust them according to data provided from the risky world, i.e, the stock market.
To do so, similarly as done in \cref{sec:methodology:calibration}, the function \textit{fitdistr} is purposely used.
As a reminder, that function needs (i) a probability density function (PDF) to fill, (ii) a sample of empirical data and (iii) a list of parameters to calibrate.
As defined in \citet{bs}, the normal  PDF is the one to be fitted when one deals with log-returns of a GBM.
Furthermore, The dataset representing the evolution of the Apple stock prices from 1st January 2017 to 31st December 2018, detailed in appendix \cref{} is employed as data template.
The so found arguments by \textit{fitdistr} to use together with the normal PDF are $\left\{ \bar{x} = 0.0013, s = 0.0103 \right\}$, with $\bar{x}$ and $s$ respectively being the estimates of the mean and the standard deviation of the normal distribution.
However, before using it inside the function \textit{bsm\_ts}, to simulate the time-series, they must be turned into drift and variance rates, as explained in \cref{sec:upstream:logreturn}.
The so adjusted parameters to use within the BSM model are, $\left\{ \alpha = 0.4823, \sigma = 0.1959  \right\}$.

\begin{figure}[h]
  \centering
  \input{figures/mjd.analysis.calibrated.tex}
  % \rule{40mm}{20mm}
  \caption{Distribution of the calibrated BSM time-series' log-returns with respect to the distribution of those provided by the market.}
  %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The above blue density curve is constructed over the historical data of the Apple share of stock price evolution from 1st January 2017 to 31st December 2017. while the red curve is built from time-series generated by the function \textit{bsm\_ts} taking $\tau = 1.0931$, $\alpha = 0.48229$, $\sigma = 0.1958$ as parameters.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:gbm:adjusted}
\end{figure}

\Cref{p:analysis:gbm:adjusted} illustrates the theoretical density curve of the log-returns reproduced with the adjusted parameters, while \cref{p:analysis:gbm:option:adjusted} faces the blue colored volatility smiles determined from market data with those dotted in red, computed from data provided by the function \textit{bsm\_call} which takes the calibrated $\sigma$ and the riskless rate $r$ as parameters.

\begin{figure}[h]
  \centering
  \input{figures/appl.impliedvol.bsm.tex}
  % \rule{40mm}{20mm}
  \caption{Black-Scholes-Merton's volatility smile with respect to the one provided by the market.}
  %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The parameters used to construct the red volatility smile is $\sigma =  0.1959$.
The implied volatilities that represent the above blue volatility smiles have been computed by using an iterative method on the BSM equation to solve  $\sigma$ while the option prices were provided by the market.
The method used was to find the root of $C(S(0), K, T, r; \sigma) - C_{K, T}$, where $C_{K, T}$ is the market price and $C(S(0), K, T, r; \sigma)$ is the function \textit{bsm\_call} with $\sigma$ as a cursor.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:gbm:option:adjusted}
\end{figure}

At a glance, one can see (i) that the GBM lacks to correctly replicate the behavior of the market time-series log-returns and (ii) that the BSM equation with only one possible value for the volatility is not versatile enough to adequately reflect the full range of options prices given by the market.





















%%%%%%%%%%%%%%%%%%%%%%%%
% Result
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


The BSM model is nevertheless going to serve as a benchmark to compare the hedging performances of the other considered models, namely, MJD and HSV.
\Cref{t:analysis:bsm:pl} presents the results of the relative P\&Ls got from the delta-hedging processes on European call options with maturities of 3, 6 and 13 months and strikes ranging from  \$ 140 to \$ 230.
Those outputs are maturities column-wise and grouped by strikes in rows.
Furthermore, each row is split into three parts, each of these subsections represents different rebalancing frequency.
For instance, the result exhibited in column "91 dbm \footnote{days before maturity}" and row "140 > intraday" gives the mean of the relative P\&Ls computed on a series of delta-hedges of European call options with a maturity of 91 days (3 months), a strike of  \$ 140 and the rebalancing carried out twice a day.

The dummy time-series of the underlying asset, which will serve the analysis, are depicted in \cref{p:analysis:gbm:100}. 
According to the dimension of \cref{t:analysis:bsm:pl}, any paths of these series helped forty-five times the study since each of them have been involved in the hedge of options with five different strikes having three maturities each, along with three distinctive rebalancing frequencies.
The total number of samples is one hundred, and consequently, \Cref{t:analysis:bsm:pl} summarizes four thousand and five hundred delta-hedging strategies.

\begin{figure}[ht]
  \centering
  \input{figures/analysis.bsm.stocks.tex}
  %\rule{40mm}{20mm}
  \caption{A sample of one hundred geometric Brownian motions.}
    %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The function used is \textit{bsm\_ts} of the R package \textit{randomwalk}, with the following arguments $\tau = 1.0931$, $\alpha = 0.48229$, $\sigma = 0.1958$.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:gbm:100}
\end{figure}


























%%%%%%%%%%%%%%%%%%%%%%%%
% Positiveness of the frequency
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

From \cref{t:analysis:bsm:pl} one can observe that the balancing frequency has a positive impact on the quality of the hedge.
Indeed, the more frequent balancing, the better hedging.
\Cref{p:analysis:gbm:hedges} shows an extract of the delta-hedging processes with different balancing frequencies.
The continuous brown line represents the course of the option price and the green, blue and red dots respectively emphasize the associated delta-neutral portfolios' values with a rebalancing frequency of twice a day, once a day and once a week.


\begin{figure}[h]
  \centering
  \input{figures/p.analysis.gbm.hedges.tex}
  % \rule{40mm}{20mm}
  \caption{Delta-neutral portfolio with different frequencies of adjusting.}
   %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The parameters given to the option function \textit{bsm\_call} are: $\tau = 0.2493$, $K = 186$, $\sigma = 0.1958$, $r = 0.01896$. While those used to construct the dummy underlying asset, by means of the GBM function \textit{bsm\_ts} , are: $\sigma = 0.1958$, $\alpha = 0.48229$.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:gbm:hedges}
\end{figure}

In the light of the above \cref{p:analysis:gbm:hedges}, and as confirmed by the \cref{t:analysis:bsm:pl}, within a log-normal world, a portfolio more regularly balanced will give better results for the BSM delta-hedging strategy.
    
\begin{table}[ht]
\centering
\begin{tabular}{lllll}
  \hline
  \hline
   &  & 91 dbm\footnote{dbm: days before maturity} & 182 dbm & 399 dbm \\ 
   \hdashline
  \multirow{3}{*}{140} & intraday & 0 & 0 & 0 \\ 
  & daily & 0 & 0 & 0 \\ 
  & weekly & 0 & 0 & 0 \\ 
   \hdashline
  \multirow{3}{*}{160} & intraday & 0 & 0 & 0 \\ 
  & daily & 0 & 0 & 0 \\ 
  & weekly & -0.001 & -0.001 & -0.003 \\ 
   \hdashline
  \multirow{3}{*}{186} & intraday & 0 & 0.001 & -0.001 \\ 
  & daily & -0.005 & -0.002 & -0.004 \\ 
  & weekly & -0.01 & -0.019 & -0.021 \\ 
   \hdashline
  \multirow{3}{*}{200} & intraday & 0.022 & 0.008 & -0.001 \\ 
  & daily & -0.002 & -0.005 & -0.006 \\ 
  & weekly & -0.007 & -0.052 & -0.037 \\ 
   \hdashline
  \multirow{3}{*}{230} & intraday & 0.02 & 0.042 & -0.007 \\ 
  & daily & 0.022 & -0.063 & -0.022 \\ 
  & weekly & 0.317 & -0.285 & -0.136 \\ 
   \hline
\end{tabular}
\caption{Hedging with BSM: Relative P\&L} 
\label{t:analysis:bsm:pl}
\end{table}























%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% short gamma
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The vast majority of these results shows that with a less rebalancing frequency, the average value of P\&Ls is negative, meaning that the delta-neutral portfolios underperform in comparison with the options themselves. 
The reason is due to the options' gamma. 
As a reminder, gamma gives the acceleration of any changes in the call function with respect to the stock price.
With a positive gamma, and it is always positive for a vanilla stock option within the BSM model, the function $c(S(t), t)$, with $t$  constant, is concave up. 
As \citet{shreve} shows, the delta-neutral portfolio is tangent below the curve of that call function.
Therefore, due to the convexity of the latter, an instantaneous change of the asset price, either by increasing or decreasing, always makes the related delta-neutral portfolio suffer and hence deflates. 
That kind of portfolio is called short gamma.















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% worst value
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


On other note, the average worst result comes from the coverage of deep-out-of-the-money options, weekly rebalanced.
However, by opting for a more frequent rebalancing strategy, the mean of the relative P\&Ls reduces.  
Indeed, it goes from 31.7\% to 2\% by choosing a rhythm of readjustment of twice a day instead of once a week.
\Cref{p:analysis:gbm:pl:better} shows the distribution of the P\&Ls mentioned above with a portfolio balancing applied either daily (blue curve), twice a day (green curve) or once a week (red curve).
As expected, the more frequently rebalanced portfolios show less variance and the more values near zero for the associated P\&Ls.

\begin{figure}[h]
  \centering
  \input{figures/p.analysis.gbm.pl.better.tex}
  % \rule{40mm}{20mm}
  \caption{Distributions of relative profits and losses according to the portfolios rebalancing frequencies.}
   %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The above densities have been constructed on the hedges of options, computed by means of the function \textit{bsm\_call}, with the following parameters: $\tau = 0.2493$, $K = 186$, $\sigma = 0.1958$, $r = 0.01896$. While the underlying asset followed differents dummy paths constructed through the function \textit{bsm\_ts} taking as arguments: $\sigma = 0.1958$, $\alpha = 0.48229$.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:gbm:pl:better}
\end{figure}

















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Most disruptive
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The more disruptive observation is given by the averaging P\&Ls of the hedging of deep-out-of-the-money, weekly rebalanced options with 91 days before maturity, namely, 0.317.
Unlike the other P\&Ls, this one is positive, meaning that the delta-neutral portfolios that replicate a position in the long European call won on average, which contradicts the previous statement stating the opposite.
The underpinned reason is explained by a high value of options' theta, i.e., the first derivative of the call function with respect to time, all other things staying unchanged.
Indeed, theta gives as information the effect of time on the derivative. As theta is always negative within the BSM model, then when time passes, all other things being equal, the derivative value decreases.
Therefore, the more the value of theta is high in absolute value, the faster the option is going to lose value with respect to time.
Consequently, the adverse effect of theta on the option's value has a positive impact on the hedging-portfolio which is able to overwhelm the negative effect that gamma has on it.
\Cref{t:analysis:bsm:pl:worst} lists all the P\&Ls' results of that hedging scenario.


\begin{table}[h]
\centering
\begin{tabular}{c|llllllllll}
  \hline
  \hline
  & \multicolumn{1}{c}{[1]} & \multicolumn{1}{c}{[2]} & \multicolumn{1}{c}{[3]} & \multicolumn{1}{c}{[4]} & \multicolumn{1}{c}{[5]} & \multicolumn{1}{c}{[6]} & \multicolumn{1}{c}{[7]} & \multicolumn{1}{c}{[8]} & \multicolumn{1}{c}{[9]} & \multicolumn{1}{c}{[10]} \\
  \hline
  [0] & 1.01 & 8.52 & -0.52 & 0.67 & -15.42 & 0.55 & 3.62 & 0.35 & 2.45 & 2.15 \\ \relax
  [10] & 2.55 & 0.85 & 1.61 & 0.06 & -1.68 & -4.93 & 3.16 & 0.61 & 0.27 & 0.97 \\ \relax
  [20] & -9.32 & 0.38 & 3.34 & -0.43 & -9.27 & 0.60 & -0.37 & -0.27 & 0.27 & -0.57 \\ \relax
  [30] & 1.54 & 0.83 & 17.43 & 1.04 & -37.44 & 1.09 & 1.48 & 1.73 & 0.92 & 0.77 \\ \relax
  [40] & 1.17 & 0.29 & -2.33 & 0.45 & -0.51 & 8.98 & -3.76 & -0.55 & 0.83 & 0.69 \\ \relax
  [50] & -8.85 & 0.18 & -0.96 & 0.92 & 4.38 & 0.29 & 2.95 & 4.55 & 5.29 & \hl{23.50} \\ \relax
  [60] & -0.11 & 4.71 & 3.83 & -0.26 & 3.70 & -2.95 & 1.28 & 7.00 & 0.80 & 0.15 \\ \relax
  [70] & -0.21 & 11.00 & 0.54 & 0.23 & 0.71 & -38.71 & 15.04 & 7.75 & -0.49 & 0.85 \\ \relax
  [80] & -15.18 & 1.62 & 5.40 & -9.23 & -0.43 & 1.39 & 0.65 & 1.31 & -7.34 & 1.53 \\ \relax
  [90] & -0.02 & 3.19 & -1.68 & 13.05 & -0.12 & -6.70 & -0.34 & 8.68 & 0.69 & 2.18 \\ 
   \hline
\end{tabular}
\caption{Higher relative P\&Ls for BSM due to theta} 
\label{t:analysis:bsm:pl:worst}
\end{table}


In order to understand what happens to those P\&Ls let us analyze the hedging process behind the one with the highest positive value. Latter is highlighted in \cref{t:analysis:bsm:pl:worst}.
Henceforth, the computed values of theta for the options causing that P\&L result are listed in \cref{t:analysis:bsm:pl:worst:theta}.

 
\begin{table}[h]
\centering
\begin{tabular}{c|llllllll}
  \hline
  \hline
  Time & 0.00 & 0.02 & 0.04 & 0.06 & 0.08 & 0.10 & 0.12 & \ldots\\ 
Theta & -1.83 & -3.80 & -8.50 & -5.26 & -13.88 & -13.84 & -20.39 & \ldots \\ 
   \hdashline
  Time & \ldots & 0.13 & 0.15 & 0.17 & 0.19 & 0.21 & 0.23 & 0.25 \\ 
  Theta & \ldots & -14.89 & -19.05 & -19.84 & -35.54 & -47.81 & -65.66 & Inf \\ 
   \hline
\end{tabular}
\caption{A sample of theta causing higher relative P\&Ls for BSM} 
\label{t:analysis:bsm:pl:worst:theta}
\end{table}



The lowest values of theta appear at the end of the life of the derivative. 
The reason, as shown through \cref{p:analysis:gbm:pl:theta:high},  is due to the fact that at the time near maturity, the values of the option's theta are computed when the option is just in-the-money, letting by consequence the time with a significant influence on its value.


\begin{figure}[h]
  \centering
  \input{figures/p.analysis.gbm.theta.high.tex}
  % \rule{40mm}{20mm}
  \caption{European call option with higher theta as time goes to maturity}
   %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The parameters passed to the function \textit{bsm\_call}, to compute the different option values are: $\tau = 0.2493$, $K = 230$, $\sigma = 0.1958$, $r = 0.01896$. While the underlying asset followed differents dummy paths constructed through the function \textit{bsm\_ts} taking as arguments: $\sigma = 0.1958$, $\alpha = 0.48229$. The hedge is weekly balanced.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:gbm:pl:theta:high}
\end{figure}



By resuming the solution of theta given in \citet{shreve}, for the European call option, one gets the following equations.

\begin{align}
  \Theta = -r K e^{-r (T-t)} N\bigg(d_{-}(T-t, S(t))\bigg) -
    \frac{\sigma S(t)}{2\sqrt{T-t}} N^{'}\bigg(d_{+}(T-t, S(t))\bigg) \label{eq:analysis:theta}\\
  \intertext{with}
  d_{\pm}(\tau, x) = \frac{1}{\sigma \sqrt{\tau}} \left [
    \ln\frac{x}{K} + \left( r \pm \frac{\sigma^2}{2} \right) \tau
  \right]\label{eq:analysis:d}
\end{align}
With $N$ and $N^{'}$ respectively standing for the normal cumulative distribution function (CDF) and for the normal probability density function (PDF). 

Intuitively, according to \cref{eq:analysis:theta} As $\tau \downarrow \implies \sigma S(t) / (2\sqrt{T-t}) \uparrow$ and $N^{'}(d_{+}(T-t, S(t)))$ gets its higher value when $d_{+}(T-t, S(t)) \to 0$.
Also, by \cref{eq:analysis:d}, for any given $\tau$ sufficiently small, the function $d_{+}$ is the nearest to zero as $x \to S(t)$.
\Cref{p:analysis:gbm:pl:theta:high} shows that it is exactly what happens for the observed option.




    
    
    

    
    
    
    
    
    
    
    
    
    
    
    







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MERTON
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Merton jump-diffusion performance measuring}
\label{sec:section name}

\Cref{t:analysis:merton:pl} is arranged the same way than \cref{t:analysis:bsm:pl} but except that the columns are subdivided to give the information on the relative P\&Ls obtained by either replicating the long position in the European calls with the delta MJD or BSM.
For instance, the result exhibited in the column "91 dbm > $delta_{bsm}$" and row "140 > intraday" gives the mean relative P\&L computed on a series of delta-hedging on European call options with a maturity of 91 days (3 months), a strike of  \$140, a rebalancing done twice a day and with $\Delta(t)$ computed using the BSM equation. 
Whilst the output in the column "91 dbm > $delta_{mjd}$" and row "140 > intraday", gives the same information but with $\Delta(t)$ computed by using the Merton equation.

The dummy time-series of the underlying asset, which will serve the analysis are all displayed in \cref{p:analysis:mjd:100}. 
According to the dimension of \cref{t:analysis:merton:pl}, any of them is used ninety times in the study since each has been involved in the coverage of options with five different strikes, three maturities, three distinctive rebalancing frequencies and depending on two deltas as well.
The total number of samples is one hundred, and consequently, \Cref{t:analysis:merton:pl} summarizes nine thousand delta-hedging strategies.

\begin{figure}[h]
  \centering
  \input{figures/analysis.mjd.stocks.tex}
  % \rule{40mm}{20mm}
  \caption{A sample of one hundred Merton jump-diffusion processes.}
    %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The function used is \textit{mjd\_ts} of the R package \textit{randomwalk}, with the following arguments $S(0) = 186.31$, $T = 1.0932$, $\sigma = 0.1021$, $\alpha = 0.4817$, $\lambda = 99.5434$, $\mu = -0.0007$, $\delta = 0.01610$, and a time-step of $(365 * 2)^-1$.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:mjd:100}
\end{figure}












%%%%%%%%%%%%%%%%%%%%%%%%
% Positiveness of the frequency
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

From \cref{t:analysis:bsm:pl}, one can see that the effect of the rebalancing frequency is not as clear as it was within the hedging of the BSM model, in a lognormal world.
At first sight, however, one can observe that with the increase of the balancing rhythm comes a rise in the value of the delta-neutral portfolios on average, which even tend to outperform the European calls systematically.
Nonetheless, the only information provided by \cref{t:analysis:bsm:pl} is the mean of all the calculated P\&Ls, what therefore lacks in exhaustiveness.




\begin{table}[h]
\centering
\begin{tabular}{llllllll}
  \hline
  \hline
 Strikes & frequency  &\multicolumn{2}{c}{91 dbm} & \multicolumn{2}{c}{182 dbm} & \multicolumn{2}{c}{399 dbm} \\ 
   &  & $\Delta_{mrt}$ & $\Delta_{bsm}$ & $\Delta_{mrt}$ & $\Delta_{bsm}$ & $\Delta_{mrt}$ & $\Delta_{bsm}$ \\ 
   \hdashline
  \multirow{3}{*}{140} & intraday & 0.004 & 0.006 & 0.011 & 0.012 & 0.01 & 0.021 \\ 
  & daily & 0.002 & 0.006 & 0.008 & 0.012 & 0.016 & 0.021 \\ 
  & weekly & 0.004 & 0.006 & 0.006 & 0.011 & 0.007 & 0.021 \\ 
   \hdashline
  \multirow{3}{*}{160} & intraday & 0.011 & 0.018 & 0.021 & 0.029 & 0.025 & 0.042 \\ 
  & daily & 0.016 & 0.018 & 0.022 & 0.029 & 0.019 & 0.042 \\ 
  & weekly & 0.013 & 0.016 & 0.018 & 0.026 & 0.018 & 0.04 \\ 
   \hdashline
  \multirow{3}{*}{186} & intraday & 0.036 & 0.021 & 0.078 & 0.055 & 0.079 & 0.074 \\ 
  & daily & 0.039 & 0.022 & 0.072 & 0.055 & 0.068 & 0.074 \\ 
  & weekly & 0.014 & -0.008 & 0.055 & 0.037 & 0.057 & 0.061 \\ 
   \hdashline
  \multirow{3}{*}{200} & intraday & 0.072 & -0.002 & 0.139 & 0.061 & 0.13 & 0.086 \\ 
  & daily & 0.06 & -0.013 & 0.131 & 0.057 & 0.115 & 0.085 \\ 
  & weekly & -0.02 & -0.1 & 0.083 & 0.005 & 0.085 & 0.053 \\ 
   \hdashline
  \multirow{3}{*}{230} & intraday & 0.955 & 0.331 & 0.444 & -0.061 & 0.301 & 0.063 \\ 
  & daily & 1.098 & 0.466 & 0.409 & -0.091 & 0.261 & 0.054 \\ 
  & weekly & -0.741 & -1.335 & 0.085 & -0.438 & 0.174 & -0.088 \\ 
   \hline
\end{tabular}
\caption{Hedging with MJD: Relative P\&L} 
\label{t:analysis:merton:pl}
\end{table}



In order to get a deeper understanding of the results provided in \cref{t:analysis:merton:pl}, let us focus on the distributions of the P\&Ls. 
Latter are depicted in \cref{p:analysis:mjd:pl:dist:big} (appendix \ref{cha:appendanalysis:plot}) where the green, blue and red-filled density curves respectively denote the P\&Ls' distributions when the delta-neutral portfolios are balanced twice a day, daily or weekly.

In the light of \cref{p:analysis:mjd:pl:dist:big}, one can observe that as the rhythm of balancing increases, the variance of the averaged relative profits and losses decreases, with the most of the distribution so concentrated around the mean.

Likewise,  the time before maturity and the strike price of the options to be covered both affect the distributions of the portfolios' P\&Ls.
%

On the one hand, concerning the effect of the maturity on the shape of the distributions, the observations are split into two categories.
The first concentrates the computed measures when $0 < K/S(t) < 1$ at time zero, that is, all the [deep]-in-the-money options, while the second gathers all the others, namely, [deep]-out-of|at-the-money. 
To observe how such specificities of the delta-neutral portfolio affect the distribution, \cref{p:analysis:mjd:pl:dist:big} is zoomed-in for the interesting P\&Ls' density curves of the first aforementioned category, so giving \cref{p:analysis:mjd:pl:dist:in}.


\begin{figure}[h]
  \centering
  \input{figures/p.analysis.merton.pl.dist.in.tex}
  % \rule{40mm}{20mm}
  \caption{Relative profits and losses of delta-hedges concerning MJD processes split by prices and maturities (zoom-in on in-the-money options).}
    %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The above densities have been constructed on the hedges of options, computed by means of the function \textit{mjd\_call}, with the following parameters $\sigma = 0.1858$, $\lambda = 0.1031$, $\mu = -0.2974$, $\delta = 0.1955$. While the underlying asset followed differents dummy paths constructed through the function \textit{mjd\_ts} taking as arguments: $S(0) = 186.31$, $T = 1.0932$, $\sigma = 0.1021$, $\alpha = 0.4817$, $\lambda = 99.5434$, $\mu = -0.0007$ and $\delta = 0.01610$. 
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:mjd:pl:dist:in}
\end{figure}

From \cref{p:analysis:mjd:pl:dist:in}, it can be observed that as the time to maturity increases for options with a strike below the underlying asset price at original date, the volatility of the hedging portfolios performance also increases.
Whereas, according to \cref{p:analysis:mjd:pl:dist:big}, the inverse behavior is observed for the coverage performance's volatility of options with a higher strike price, meaning that the farther the derivative's maturity, the lower the uncertainty about the associated delta-neutral portfolios' performances.


On the other hand, as shown by \cref{p:analysis:mjd:pl:dist:in,p:analysis:mjd:pl:dist:big} and \cref{t:analysis:merton:pl}, the performances of poorly rebalanced portfolios are better for options the more in-the-money. 
A weaker gamma for the deep-in-the-money options explains such behavior.
Indeed, as time passes, the prices of the underlying assets tend to get more valuable in the vast majority, as illustrated by \cref{p:analysis:mjd:100}. 
Therefore, the associated options with smaller strikes continue to gain value but at a lower rate because the incidences of the stock price changes become less impacting. 
The inverse reasoning is applied to deep-out-of-the-money options. 
Effectively, the initial price of such options is near zero, so are the associated deltas.
However, with high growth time-series as described in \cref{p:analysis:mjd:100}, a collateral effect is that they rapidly affect such out-of-the-money options prices, just as a higher rate of change influences the values of the delta.
Consequently, according to and for the measured options, gamma is lower for in-the-money and higher for out-of-the-money options, letting the performances of the low-frequency balancing delta-neutral portfolios more accurate for options which are originally the deeper in-the-money. 










%%%%%%%%%%%%%%%%%%%%%%%%
% delta vs delta merton
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\Cref{p:analysis:mjd:pl:dist:deltas} (appendix \ref{cha:appendanalysis:plot}) shows the distribution of the P\&Ls when the hedging is built either with BSM or MJD deltas. The red density curve concerns the data related to BSM deltas while the green represents the distributions of the performance's metrics for the MJD delta-hedging.



Regarding the gotten measures of \cref{t:analysis:merton:pl} and according to \cref{p:analysis:mjd:pl:dist:deltas}, hedging in real life with the BSM-related delta seems not so wrong when the prices process of the underlying asset is driven by MJD.
Let us dive more deeply into those delta-hedging strategies by observing what happens under the hood.

\Cref{p:analysis:mjd:hedge:deltas} (appendix \ref{cha:appendanalysis:plot}) illustrates how the delta-hedging works depending on the strike price and computed delta.
The circles represent the replicated portfolios at each rebalancing time, whereas the underpinned black lines denote the courses of the options' values as time passes. 
The blue and red circles respectively stand for the MJD and BSM delta-hedging portfolios' values.



\Cref{p:analysis:mjd:hedge:deltas} definitely shows that for the particular case examined in that master thesis, applying either the BSM or MJD-related delta formula does not significantly impact the performance of the hedge when a Merton mixed jump-diffusion process drives the underlying asset.


%%%%%%%%%%%%%%%%%%%%%%%%%% STOP MERTON

















































%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Heston
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Heston stochastic volatility performance measuring}
\label{sec:section name}


In \cref{t:analysis:heston:pl}, the information are completely organized the same way that in \cref{t:analysis:merton:pl}. 
\Cref{p:analysis:hsv:100} illustrates all the dummy time-series that will be considered for the analysis of delta-hedging using HSV as a stochastic process for the underlying asset.


\begin{figure}[ht]
  \centering
  \input{figures/analysis.hsv.stocks.tex}
  % \rule{40mm}{20mm}
  \caption{A sample of one hundred Heston stochastic volatility processes.}
   %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The function used is \textit{hsv\_ts} of the R package \textit{StockPriceSimulation}, with the following arguments $S(0) = 186.31$,  $V(0) = 0.03798$, $\theta = 0.0205$, $\sigma = 0.50379$, $\rho = -0.3988$,  $\kappa = 9.4894$, $\alpha  = 0.4823$, and a time-step of $(365 * 2)^-1$.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:hsv:100}
\end{figure}










%%%%%%%%%%%%%%%%%%%%%%%%
% Positiveness of the frequency
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

As for the MJD model, with the increase of the balancing rhythm comes a rise in the values of the delta-neutral portfolios on average, which even tend to outperform the European calls systematically.







\begin{table}[ht]
\centering
\begin{tabular}{llllllll}
  \hline
  \hline
Strikes & frequency  &\multicolumn{2}{c}{91 dbm} & \multicolumn{2}{c}{182 dbm} & \multicolumn{2}{c}{399 dbm} \\ 
   &  & $\Delta_{hsv}$ & $\Delta_{bsm}$ & $\Delta_{hsv}$ & $\Delta_{bsm}$ & $\Delta_{hsv}$ & $\Delta_{bsm}$ \\ 
   \hdashline
  \multirow{3}{*}{140} & intraday & 0 & 0.002 & 0.011 & 0.011 & 0.009 & 0.038 \\ 
  & daily & -0.001 & 0.002 & 0.01 & 0.011 & 0.009 & 0.038 \\ 
  & weekly & 0.001 & 0.002 & 0 & 0.011 & 0.008 & 0.038 \\ 
  \hdashline
  \multirow{3}{*}{160} & intraday & 0.009 & 0.028 & 0.023 & 0.073 & 0.042 & 0.143 \\ 
  & daily & 0.008 & 0.028 & 0.025 & 0.072 & 0.036 & 0.143 \\ 
  & weekly & 0.008 & 0.028 & 0.019 & 0.073 & 0.036 & 0.143 \\ 
  \hdashline
  \multirow{3}{*}{186} & intraday & 0.158 & 0.252 & 0.159 & 0.392 & 0.153 & 0.524 \\ 
  & daily & 0.15 & 0.245 & 0.195 & 0.391 & 0.156 & 0.522 \\ 
  & weekly & 0.117 & 0.241 & 0.158 & 0.378 & 0.139 & 0.519 \\ 
  \hdashline 
  \multirow{3}{*}{200} & intraday & 0.459 & -0.298 & 0.43 & 0.146 & 0.279 & 0.546 \\ 
  & daily & 0.433 & -0.361 & 0.42 & 0.126 & 0.255 & 0.544 \\ 
  & weekly & 0.268 & -0.659 & 0.369 & 0.005 & 0.246 & 0.498 \\ 
  \hdashline 
  \multirow{3}{*}{230} & intraday & 2.136 & -0.527 & 1.884 & -2.452 & 1.01 & -0.235 \\ 
  & daily & 1.948 & -1.197 & 1.893 & -2.655 & 0.989 & -0.224 \\ 
  & weekly & 1.407 & -2.152 & 1.547 & -2.402 & 0.917 & -0.353 \\ 
   \hline
\end{tabular}
\caption{Hedging with HSV: Relative P\&L} 
\label{t:analysis:heston:pl}
\end{table}


In order to get a deeper understanding of the results provided in \cref{t:analysis:heston:pl}, let us focus on the distributions of the P\&Ls. 
Latter are pictured in \cref{p:analysis:hsv:pl:dist:big} (appendix \cref{cha:appendanalysis:plot}) where the green, blue and red-filled density curves respectively express the P\&Ls' distributions when the delta-neutral portfolios are balanced twice a day, daily or weekly.




         

In the light of \cref{p:analysis:hsv:pl:dist:big}, one can observe that as the rhythm of balancing increases, the variance of the averaged relative profits and losses decreases, with the most of the distribution so concentrated around the mean.



Furthermore, such as it is the case with the hedge of MJD, the performances of poorly rebalanced portfolios are better for options the more in-the-money in the HSV model. 
A weaker gamma for the deep-in-the-money options explains such behavior.

\Cref{p:analysis:hsv:gamma} represents the distribution of the computed values for the HSV gamma for options deep-in-the-money in blue and deep-out-of-the-money in red.
The shape of the curve confirms that the value of gamma is bigger for out-of-the-money options, and by consequence, the sensibility of such derivatives to the underlying asset's prices move is higher.
Moreover, the density curves of \cref{p:analysis:hsv:gamma} also illustrate that unlike the gamma computed through the BSM equation, those provided by HSV can be negatives.




\begin{figure}[h]
  \centering
  \input{figures/p.analysis.hsv.hedge.gamma.tex}
  % \rule{40mm}{20mm}
  \caption{Distributions of gamma for in-the-money vs out-of-the-money options}
    %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The above densities have been constructed by means of the function \textit{hsv\_gamma}, with the following parameters $V(0) = 0.03798218$, $\theta = 0.04871543$, $\sigma = 0.50378803$, $\rho = -0.39877827$, $\kappa = 4.00105546$. the blue density represents the distribution of a sample of gamma for in-the-money options with $K = 140$, while the red one gives the distibution of out-of-the-money options' gamma with $K = 230$.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:hsv:gamma}
\end{figure}













%%%%%%%%%%%%%%%%%%%%%%%%
% delta vs delta heston
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\Cref{p:analysis:hsv:pl:dist:deltas} (appendix \ref{cha:appendanalysis:plot}) shows the distribution of the P\&Ls when the hedging is built either with BSM or HSV deltas. The red density curve concerns the data related to BSM deltas while the green represents the distributions of the performance's metrics for the HSV delta-hedging.
No real trend emerges on the hedging portfolio whether using the HSV or BSM-related delta, except for the hedge of the at-the-money options where the delta BSM implies higher values for the delta-neutral hedging portfolios.
Nonetheless, let us dive more deeply into those delta-hedging strategies by observing what happens behind the scenes.

\Cref{p:analysis:hsv:hedge:deltas} (appendix \ref{cha:appendanalysis:plot}) illustrates how the delta-hedging works depending on the strike price and computed delta.
The circles represent the replicated portfolios at each rebalancing time, whereas the underpinned black lines are the courses of the options' values as time passes.
The blue and red circles respectively stand for the HSV and BSM delta-hedging portfolios' values.

% 



Concerning options in-the-market, \cref{p:analysis:hsv:hedge:deltas} shows that the delta-neutral portfolios with delta BSM outperform those driven by a delta HSV, while the opposite claim is applicable for the hedging portfolios of out-of-the-market calls.
The conclusion of the previous statement is not that delta BSM is "better"\footnote{the words "better" and "wore" are between quotes because those qualifiers would rather be applicable for a speculative analysis than a hedging one.} than delta HSV when hedging low strikes European calls or "wore" for high strikes ones, but it actually shows that delta BSM lacks sensitivity.
Indeed, for options in-the-money, it tends to fastly achieve values near to one while it dramatically drops to zero for out-of-the-money calls.
Therefore as the delta-hedging for the replication of long calls is a "buy high, sell low" strategy, it explains why the hedging of in-the-money options makes the BSM delta-neutral portfolios more valued than the HSV, at maturity. 
Moreover, due to a slow to start delta with a value staying longer to zero, the hedging with BSM is delayed for out-of-the-money calls, letting the BSM delta-neutral portfolios taking advantage of the purchase of a low priced assets at a time near zero, for which the return exceeds that of the money market portfolios initially set up.
To conclude, to replicate a position in a European call, delta HSV would preferably be used, concerning that case examined in this master thesis.






\chapter{Conclusion}
\label{cha:conclusion}


The general approach pursued along the current master thesis was intended to measure the performance of the Black-Scholes-Merton (BSM) pricing method by exploring what could happen away of the assumptions of log-normality density for the underlying return and beyond the simple case of a deterministic volatility drift related to the model.
Some other models had therefore been explored to overcome the issues mentioned above, namely,  Merton jump-diffusion (MJD) and Heston stochastic volatility (HSV) framework.

In order to perform such an analysis, the work was split into two pieces. First was assessed the performances of BSM, MJD, and HSV by analyzing the provided options prices in comparison with what is observed from those available on market data. 
In a second phase, the related performances were measured through replication portfolios by using, in turn, each model to create and rebalance them.

With a unique value taken by its uncertainty parameter, the BSM model lacks in reproducing the volatility surfaces observed in the market and consequently the so associated prices.
On the other hand, if the MJD and HSV models are appropriately calibrated, they can reproduce the whole diversity of market options prices and therefore match relatively well to the volatility surfaces. 
Nevertheless, the options prices cannot be found from scratch by using MJD or HSV, because a few are required a priori to find the adjusted parameters when pricing derivatives from those models.

In log-normal wold, when one uses the BSM model together with an underlying asset driven by a geometric Brownian motion, the hedging performance is almost perfect for a delta-neutral portfolio provided that the rebalancing is done frequently.

In general, for both MJD and HSV the rebalancing frequency and a farther time to maturity have a positive effect on the performance of the delta-hedges. It should be noted that the effects of gamma and theta are not negligible for the hedges of deep-out-of-the-money options which are poorer performance than those of [deep]-in|at-the-money.

Furthermore, the study shows that it exists a performance discrepancy between the replication MJD and HSV portfolios when using the BSM delta to balance them. While no significant differences have been found out when hedging using BSM of MJD delta for the Merton model, it turns out that the contrast is more explicit for the Heston model. Indeed, the latter is less performing when using BSM delta.

Although the differences are not significative enough when comparing the delta-hedging performance for in-the-money options, the MJD model beats the HSV by providing lower relative profits and losses values for the coverage of options out-of-the-money.

The results provided in that master thesis are restrictive because they are only based on the hedge of options of a unique underlying with high growth potential and cannot, therefore, be used to decipher larger trends.
However, as the purposely developed algorithms are versatile enough to be adapted for the computation of delta-hedge of other options with different underlying, an interesting study case could be to analyze the performance of the delta-hedging across different options with different assets.


\bibliography{bibl}
\bibliographystyle{plainnat}
\addcontentsline{toc}{chapter}{Bibliography}

\begin{appendices}
\chapter{Functions catalogue}
\label{cha:append:function}

% For this master thesis, I created two R packages to help me in the analysis and in the related experiments. These packages are available, under open-source software license, through my GitHub account. Names are ”Random walk”  (https://github.com/AnthonyTedde/RandomWalk) and ”Stock price simulator” (https://github.com/AnthonyTedde/StockPriceSimulator).
% 
% The R package ”Random walk” contains functions that simulate time-discretized Brownian motions. It is widely used inside ”Stock price simulator”, mainly to add noise in the simulation of stock price time series.
% 
% Unlike "Random walk", the package "Stock price simulator" is more multipurpose. The algorithms I developed inside range from the simulation of stock price path to the computation of option fair price and include hedging strategies, Greeks computation, Itô's approximation, characteristic functions and so on.
% 
% \Cref{sec:r:time} describes the functions inside the ”Stock price simulator” package that simulate time series by using a time discretization approximation.


\begin{table}[ht]
  \begin{tabularx}{\textwidth}{llX}
    \hline
    Function name & Arguments & Purpose \\
    \hline
    bsm\_call & $\left \{ S(0), T, k, r, \sigma \right \}$ & Compute the BSM price of an option \\
    mjd\_call & $\left \{ S(0), T, k, r, \lambda, \mu, \delta \sigma \right \}$ & Compute the Merton price of an option \\
    hsv\_call & $\left \{ S(0), T, k, r, V(0), \theta, \kappa, \sigma, \rho \right \}$ & Compute the heston price of an option \\
    bsm\_delta & $\left \{ S(0), T, k, r, \sigma \right \}$ & Compute the BSM delta of an option \\
    mjd\_delta & $\left \{ S(0), T, k, r, \lambda, \mu, \delta \sigma \right \}$ & Compute the Merton delta of an option \\
    hsv\_delta & $\left \{ S(0), T, k, r, V(0), \theta, \kappa, \sigma, \rho \right \}$ & Compute the heston delta of an option \\
    bsm\_gamma & $\left \{ S(0), T, k, r, \sigma \right \}$ & Compute the BSM gamma of an option \\
    mjd\_gamma & $\left \{ S(0), T, k, r, \lambda, \mu, \delta \sigma \right \}$ & Compute the Merton gamma of an option \\
    hsv\_gamma & $\left \{ S(0), T, k, r, V(0), \theta, \kappa, \sigma, \rho \right \}$ & Compute the heston gamma of an option \\
    bsm\_theta & $\left \{ S(0), T, k, r, \sigma \right \}$ & Compute the BSM theta of an option \\
    mjd\_theta & $\left \{ S(0), T, k, r, \lambda, \mu, \delta \sigma \right \}$ & Compute the Merton theta of an option \\
    hsv\_theta & $\left \{ S(0), T, k, r, V(0), \theta, \kappa, \sigma, \rho \right \}$ & Compute the heston theta of an option \\
    bsm\_ts & $\left \{ S(0), T, \sigma, \alpha, dt \right \}$ & Simulate BSM time series (GBM) \\
    mjd\_ts & $\left \{ S(0), T, \sigma, \alpha, \lambda, \mu, \delta dt \right \}$ & Simulate MJD time series \\
    hsv\_ts & $\left \{ S(0), T, V(0), \alpha, \rho, \kappa, \theta, \sigma, dt \right \}$ & Simulate HSV time series \\
  \end{tabularx}
  \caption{R functions dealing with options and time series}
  \label{t:append:function:r}
\end{table}

\chapter{Market data}
\label{cha:appendix:market}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Apple option
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Apple options' prices}
\label{sec:appendix:option}

\begin{longtable}{|lllll|lllll|}
\caption[Market option data (AAPL)]{Call options quotes on the Apple stock got through function getOptionChain from the R package quantmod. Those prices were set from 18 May 2018 with timeframe ranging from 63 up to 399 days before maturity.} 
\label{t:market:option}
\endfirsthead
% \centering
% \begin{tabular}
  \hline 
  \multicolumn{5}{|c|}{63 days to maturity} & \multicolumn{5}{c|}{91 days to maturity} \\*
  \hline
  Strike & Last & Bid & Ask & Mid-price & Strike & Last & Bid & Ask & Mid-Price \\*
  % \endhead
  \hline
  130.00 & 58.00 & 56.55 & 57.25 & 56.90 &   130.00 & 56.70 & 56.80 & 57.50 & 57.15 \\*
  140.00 & 47.54 & 46.65 & 47.35 & 47.00 &  140.00 & 47.10 & 46.95 & 47.65 & 47.30 \\*
  150.00 & 37.75 & 36.80 & 37.45 & 37.12 &  150.00 & 38.78 & 37.25 & 37.90 & 37.58 \\*
  160.00 & 27.91 & 27.10 & 27.70 & 27.40 &  160.00 & 29.03 & 27.85 & 28.45 & 28.15 \\*
  170.00 & 18.30 & 17.90 & 18.10 & 18.00 &  170.00 & 19.59 & 19.20 & 19.45 & 19.32 \\*
  180.00 & 9.85 & 9.80 & 9.90 & 9.85 &  180.00 & 12.00 & 11.80 & 11.90 & 11.85 \\*
  190.00 & 4.02 & 4.00 & 4.05 & 4.03 &  190.00 & 6.25 & 6.15 & 6.25 & 6.20 \\*
  200.00 & 1.18 & 1.15 & 1.18 & 1.16 &  200.00 & 2.75 & 2.70 & 2.73 & 2.71 \\*
  210.00 & 0.32 & 0.29 & 0.31 & 0.30 &  210.00 & 1.07 & 1.01 & 1.06 & 1.04 \\*
  220.00 & 0.11 & 0.10 & 0.13 & 0.12 &  220.00 & 0.42 & 0.37 & 0.42 & 0.40 \\*
  \hline \pagebreak \hline
  \multicolumn{5}{|c|}{126 days to maturity} & \multicolumn{5}{c|}{154 days to maturity} \\
    \hline
  Strike & Last & Bid & Ask & Mid-Price & Strike & Last & Bid & Ask & Mid-Price \\
  \hline
  130.00 & 56.00 & 56.80 & 57.60 & 57.20 &  130.00 & 57.50 & 57.00 & 57.75 & 57.38 \\*
  140.00 & 48.42 & 47.05 & 47.85 & 47.45 &  140.00 & 50.73 & 49.20 & 49.90 & 49.55 \\*
  150.00 & 38.90 & 37.55 & 38.20 & 37.88 &  150.00 & 37.80 & 37.90 & 38.60 & 38.25 \\*
  160.00 & 29.68 & 28.35 & 28.95 & 28.65 &  160.00 & 30.20 & 29.00 & 29.55 & 29.27 \\*
  170.00 & 20.25 & 20.10 & 20.30 & 20.20 &  170.00 & 21.45 & 21.05 & 21.20 & 21.12 \\*
  180.00 & 13.00 & 12.95 & 13.05 & 13.00 &  180.00 & 14.84 & 14.05 & 14.20 & 14.12 \\*
  190.00 & 7.63 & 7.45 & 7.55 & 7.50 &  190.00 & 8.65 & 8.55 & 8.70 & 8.62 \\*
  200.00 & 3.80 & 3.75 & 3.80 & 3.77 &  200.00 & 4.75 & 4.65 & 4.80 & 4.72 \\*
  210.00 & 1.70 & 1.67 & 1.72 & 1.69 &  210.00 & 2.35 & 2.32 & 2.40 & 2.36 \\*
  220.00 & 0.81 & 0.71 & 0.75 & 0.73 &  220.00 & 1.14 & 1.08 & 1.16 & 1.12 \\
  \hline
  \multicolumn{5}{|c|}{182 days to maturity} & \multicolumn{5}{c|}{245 days to maturity} \\*
  \hline
  Strike & Last & Bid & Ask & Mid-Price & Strike & Last & Bid & Ask & Mid-Price \\*
  \hline
  130.00 & 60.25 & 59.05 & 60.05 & 59.55 &  130.00 & 58.37 & 57.35 & 58.60 & 57.98 \\*
  140.00 & 49.90 & 47.75 & 48.45 & 48.10 &  140.00 & 48.30 & 48.15 & 49.35 & 48.75 \\*
  150.00 & 40.50 & 38.55 & 39.20 & 38.88 &  150.00 & 39.75 & 39.25 & 40.35 & 39.80 \\*
  160.00 & 30.60 & 29.90 & 30.45 & 30.17 &  160.00 & 31.34 & 31.35 & 31.90 & 31.62 \\*
  170.00 & 22.28 & 22.15 & 22.40 & 22.27 &  170.00 & 23.75 & 23.65 & 24.00 & 23.82 \\*
  180.00 & 16.25 & 15.40 & 15.65 & 15.53 &  180.00 & 17.57 & 17.15 & 17.30 & 17.23 \\*
  190.00 & 10.20 & 10.00 & 10.20 & 10.10 &  190.00 & 11.90 & 11.80 & 11.95 & 11.88 \\*
  200.00 & 6.10 & 6.00 & 6.15 & 6.08 &  200.00 & 7.80 & 7.65 & 7.80 & 7.72 \\*
  210.00 & 3.74 & 3.35 & 3.50 & 3.42 &  210.00 & 4.90 & 4.75 & 4.85 & 4.80 \\*
  220.00 & 1.80 & 1.76 & 1.87 & 1.81 &  220.00 & 2.95 & 2.80 & 2.93 & 2.87 \\
  \hline
  \multicolumn{5}{|c|}{399 days to maturity} \\*
  \cline{1-5}
  Strike & Last & Bid & Ask & Mid-Price \\*
  \cline{1-5}
  130.00 & 60.00 & 58.00 & 62.00 & 60.00 \\*
  140.00 & 50.50 & 49.00 & 53.50 & 51.25 \\*
  150.00 & 43.75 & 40.40 & 44.80 & 42.60 \\*
  160.00 & 36.45 & 33.55 & 36.55 & 35.05 \\*
  170.00 & 28.00 & 26.50 & 29.35 & 27.93 \\*
  180.00 & 23.20 & 21.70 & 22.25 & 21.98 \\*
  190.00 & 17.05 & 16.70 & 17.10 & 16.90 \\*
  200.00 & 12.70 & 12.35 & 12.80 & 12.57 \\*
  210.00 & 9.77 & 8.85 & 9.40 & 9.12 \\*
  220.00 & 6.71 & 6.30 & 6.70 & 6.50 \\
  \cline{1-5}
% \end{tabular}
\end{longtable}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Apple stock
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Apple options' prices}
\label{sec:appendix:option}

\begin{longtable}{llllll}
% \centering
% \begin{tabular}
  \hline
  \multicolumn{1}{c}{Date}   & \multicolumn{1}{c}{Ticker} & \multicolumn{1}{c}{Open}   & \multicolumn{1}{c}{Close} &  \multicolumn{1}{c}{Low}  &   \multicolumn{1}{c}{High}\\
  \hline
  \endhead
2017-01-03 & AAPL & 115.80 & 116.15 & 114.76 & 116.33 \\ 
  2017-01-04 & AAPL & 115.85 & 116.02 & 115.75 & 116.51 \\ 
  2017-01-05 & AAPL & 115.92 & 116.61 & 115.81 & 116.86 \\ 
  2017-01-06 & AAPL & 116.78 & 117.91 & 116.47 & 118.16 \\ 
  2017-01-09 & AAPL & 117.95 & 118.99 & 117.94 & 119.43 \\ 
  2017-01-10 & AAPL & 118.77 & 119.11 & 118.30 & 119.38 \\ 
  2017-01-11 & AAPL & 118.74 & 119.75 & 118.60 & 119.93 \\ 
  2017-01-12 & AAPL & 118.89 & 119.25 & 118.21 & 119.30 \\ 
  2017-01-13 & AAPL & 119.11 & 119.04 & 118.81 & 119.62 \\ 
  2017-01-17 & AAPL & 118.34 & 120.00 & 118.22 & 120.24 \\ 
  2017-01-18 & AAPL & 120.00 & 119.99 & 119.71 & 120.50 \\ 
  2017-01-19 & AAPL & 119.40 & 119.78 & 119.37 & 120.09 \\ 
  2017-01-20 & AAPL & 120.45 & 120.00 & 119.73 & 120.45 \\ 
  2017-01-23 & AAPL & 120.00 & 120.08 & 119.77 & 120.81 \\ 
  2017-01-24 & AAPL & 119.55 & 119.97 & 119.50 & 120.10 \\ 
  2017-01-25 & AAPL & 120.42 & 121.88 & 120.28 & 122.10 \\ 
  2017-01-26 & AAPL & 121.67 & 121.94 & 121.60 & 122.44 \\ 
  2017-01-27 & AAPL & 122.14 & 121.95 & 121.60 & 122.35 \\ 
  2017-01-30 & AAPL & 120.93 & 121.63 & 120.66 & 121.63 \\ 
  2017-01-31 & AAPL & 121.15 & 121.35 & 120.62 & 121.39 \\ 
  2017-02-01 & AAPL & 127.03 & 128.75 & 127.01 & 130.49 \\ 
  2017-02-02 & AAPL & 127.97 & 128.53 & 127.78 & 129.39 \\ 
  2017-02-03 & AAPL & 128.31 & 129.08 & 128.16 & 129.19 \\ 
  2017-02-06 & AAPL & 129.13 & 130.29 & 128.90 & 130.50 \\ 
  2017-02-07 & AAPL & 130.54 & 131.53 & 130.45 & 132.09 \\ 
  2017-02-08 & AAPL & 131.35 & 132.04 & 131.22 & 132.22 \\ 
  2017-02-09 & AAPL & 131.65 & 132.42 & 131.12 & 132.44 \\ 
  2017-02-10 & AAPL & 132.46 & 132.12 & 132.05 & 132.94 \\ 
  2017-02-13 & AAPL & 133.08 & 133.29 & 132.75 & 133.82 \\ 
  2017-02-14 & AAPL & 133.47 & 135.02 & 133.25 & 135.09 \\ 
  2017-02-15 & AAPL & 135.52 & 135.51 & 134.62 & 136.27 \\ 
  2017-02-16 & AAPL & 135.67 & 135.34 & 134.84 & 135.90 \\ 
  2017-02-17 & AAPL & 135.10 & 135.72 & 135.10 & 135.83 \\ 
  2017-02-21 & AAPL & 136.23 & 136.70 & 135.98 & 136.75 \\ 
  2017-02-22 & AAPL & 136.43 & 137.11 & 136.11 & 137.12 \\ 
  2017-02-23 & AAPL & 137.38 & 136.53 & 136.30 & 137.48 \\ 
  2017-02-24 & AAPL & 135.91 & 136.66 & 135.28 & 136.66 \\ 
  2017-02-27 & AAPL & 137.14 & 136.93 & 136.28 & 137.44 \\ 
  2017-02-28 & AAPL & 137.08 & 136.99 & 136.70 & 137.44 \\ 
  2017-03-01 & AAPL & 137.89 & 139.79 & 137.59 & 140.15 \\ 
  2017-03-02 & AAPL & 140.00 & 138.96 & 138.76 & 140.28 \\ 
  2017-03-03 & AAPL & 138.78 & 139.78 & 138.59 & 139.83 \\ 
  2017-03-06 & AAPL & 139.37 & 139.34 & 138.60 & 139.77 \\ 
  2017-03-07 & AAPL & 139.06 & 139.52 & 138.79 & 139.98 \\ 
  2017-03-08 & AAPL & 138.95 & 139.00 & 138.82 & 139.80 \\ 
  2017-03-09 & AAPL & 138.74 & 138.68 & 137.05 & 138.79 \\ 
  2017-03-10 & AAPL & 139.25 & 139.14 & 138.64 & 139.36 \\ 
  2017-03-13 & AAPL & 138.85 & 139.20 & 138.82 & 139.43 \\ 
  2017-03-14 & AAPL & 139.30 & 138.99 & 138.84 & 139.65 \\ 
  2017-03-15 & AAPL & 139.41 & 140.46 & 139.03 & 140.75 \\ 
  2017-03-16 & AAPL & 140.72 & 140.69 & 140.26 & 141.02 \\ 
  2017-03-17 & AAPL & 141.00 & 139.99 & 139.89 & 141.00 \\ 
  2017-03-20 & AAPL & 140.40 & 141.46 & 140.23 & 141.50 \\ 
  2017-03-21 & AAPL & 142.11 & 139.84 & 139.73 & 142.80 \\ 
  2017-03-22 & AAPL & 139.84 & 141.42 & 139.76 & 141.60 \\ 
  2017-03-23 & AAPL & 141.26 & 140.92 & 140.61 & 141.58 \\ 
  2017-03-24 & AAPL & 141.50 & 140.64 & 140.35 & 141.74 \\ 
  2017-03-27 & AAPL & 139.39 & 140.88 & 138.62 & 141.22 \\ 
  2017-03-28 & AAPL & 140.91 & 143.80 & 140.62 & 144.04 \\ 
  2017-03-29 & AAPL & 143.68 & 144.12 & 143.19 & 144.49 \\ 
  2017-03-30 & AAPL & 144.19 & 143.93 & 143.50 & 144.50 \\ 
  2017-03-31 & AAPL & 143.72 & 143.66 & 143.01 & 144.27 \\ 
  2017-04-03 & AAPL & 143.71 & 143.70 & 143.05 & 144.12 \\ 
  2017-04-04 & AAPL & 143.25 & 144.77 & 143.17 & 144.89 \\ 
  2017-04-05 & AAPL & 144.22 & 144.02 & 143.81 & 145.46 \\ 
  2017-04-06 & AAPL & 144.29 & 143.66 & 143.45 & 144.52 \\ 
  2017-04-07 & AAPL & 143.73 & 143.34 & 143.27 & 144.18 \\ 
  2017-04-10 & AAPL & 143.60 & 143.17 & 142.90 & 143.88 \\ 
  2017-04-11 & AAPL & 142.94 & 141.63 & 140.06 & 143.35 \\ 
  2017-04-12 & AAPL & 141.60 & 141.80 & 141.01 & 142.15 \\ 
  2017-04-13 & AAPL & 141.91 & 141.05 & 141.05 & 142.38 \\ 
  2017-04-17 & AAPL & 141.48 & 141.83 & 140.87 & 141.88 \\ 
  2017-04-18 & AAPL & 141.41 & 141.20 & 141.11 & 142.04 \\ 
  2017-04-19 & AAPL & 141.88 & 140.68 & 140.45 & 142.00 \\ 
  2017-04-20 & AAPL & 141.22 & 142.44 & 141.16 & 142.92 \\ 
  2017-04-21 & AAPL & 142.44 & 142.27 & 141.85 & 142.68 \\ 
  2017-04-24 & AAPL & 143.50 & 143.64 & 143.18 & 143.95 \\ 
  2017-04-25 & AAPL & 143.91 & 144.54 & 143.87 & 144.90 \\ 
  2017-04-26 & AAPL & 144.47 & 143.65 & 143.38 & 144.60 \\ 
  2017-04-27 & AAPL & 143.92 & 143.79 & 143.31 & 144.16 \\ 
  2017-04-28 & AAPL & 144.09 & 143.65 & 143.27 & 144.30 \\ 
  2017-05-01 & AAPL & 145.10 & 146.60 & 144.96 & 147.20 \\ 
  2017-05-02 & AAPL & 147.54 & 147.51 & 146.84 & 148.09 \\ 
  2017-05-03 & AAPL & 145.59 & 147.06 & 144.27 & 147.49 \\ 
  2017-05-04 & AAPL & 146.52 & 146.53 & 145.81 & 147.14 \\ 
  2017-05-05 & AAPL & 146.76 & 148.96 & 146.76 & 148.98 \\ 
  2017-05-08 & AAPL & 149.03 & 153.00 & 149.03 & 153.70 \\ 
  2017-05-09 & AAPL & 153.87 & 153.96 & 153.45 & 154.88 \\ 
  2017-05-10 & AAPL & 153.63 & 153.26 & 152.11 & 153.94 \\ 
  2017-05-11 & AAPL & 152.45 & 153.95 & 152.31 & 154.07 \\ 
  2017-05-12 & AAPL & 154.70 & 156.10 & 154.67 & 156.42 \\ 
  2017-05-15 & AAPL & 156.01 & 155.70 & 155.05 & 156.65 \\ 
  2017-05-16 & AAPL & 155.94 & 155.47 & 154.72 & 156.06 \\ 
  2017-05-17 & AAPL & 153.60 & 150.25 & 149.71 & 154.57 \\ 
  2017-05-18 & AAPL & 151.27 & 152.54 & 151.13 & 153.34 \\ 
  2017-05-19 & AAPL & 153.38 & 152.96 & 152.63 & 153.98 \\ 
  2017-05-22 & AAPL & 154.00 & 153.99 & 152.91 & 154.58 \\ 
  2017-05-23 & AAPL & 154.90 & 153.80 & 153.31 & 154.90 \\ 
  2017-05-24 & AAPL & 153.84 & 153.34 & 152.67 & 154.17 \\ 
  2017-05-25 & AAPL & 153.73 & 153.87 & 153.03 & 154.35 \\ 
  2017-05-26 & AAPL & 154.00 & 153.61 & 153.31 & 154.24 \\ 
  2017-05-30 & AAPL & 153.42 & 153.67 & 153.33 & 154.43 \\ 
  2017-05-31 & AAPL & 153.97 & 152.76 & 152.38 & 154.17 \\ 
  2017-06-01 & AAPL & 153.17 & 153.18 & 152.22 & 153.33 \\ 
  2017-06-02 & AAPL & 153.58 & 155.45 & 152.89 & 155.45 \\ 
  2017-06-05 & AAPL & 154.34 & 153.93 & 153.46 & 154.45 \\ 
  2017-06-06 & AAPL & 153.90 & 154.45 & 153.78 & 155.81 \\ 
  2017-06-07 & AAPL & 155.02 & 155.37 & 154.48 & 155.98 \\ 
  2017-06-08 & AAPL & 155.25 & 154.99 & 154.40 & 155.54 \\ 
  2017-06-09 & AAPL & 155.19 & 148.98 & 146.02 & 155.19 \\ 
  2017-06-12 & AAPL & 145.74 & 145.32 & 142.51 & 146.09 \\ 
  2017-06-13 & AAPL & 147.16 & 146.59 & 145.15 & 147.45 \\ 
  2017-06-14 & AAPL & 147.50 & 145.16 & 143.84 & 147.50 \\ 
  2017-06-15 & AAPL & 143.32 & 144.29 & 142.21 & 144.48 \\ 
  2017-06-16 & AAPL & 143.78 & 142.27 & 142.20 & 144.50 \\ 
  2017-06-19 & AAPL & 143.66 & 146.34 & 143.66 & 146.74 \\ 
  2017-06-20 & AAPL & 146.87 & 145.01 & 144.94 & 146.87 \\ 
  2017-06-21 & AAPL & 145.52 & 145.87 & 144.61 & 146.07 \\ 
  2017-06-22 & AAPL & 145.77 & 145.63 & 145.12 & 146.70 \\ 
  2017-06-23 & AAPL & 145.13 & 146.35 & 145.11 & 147.16 \\ 
  2017-06-26 & AAPL & 147.17 & 145.82 & 145.38 & 148.28 \\ 
  2017-06-27 & AAPL & 145.01 & 143.74 & 143.62 & 146.16 \\ 
  2017-06-28 & AAPL & 144.49 & 145.83 & 143.16 & 146.11 \\ 
  2017-06-29 & AAPL & 144.71 & 143.68 & 142.28 & 145.13 \\ 
  2017-06-30 & AAPL & 144.45 & 144.02 & 143.78 & 144.96 \\ 
  2017-07-03 & AAPL & 144.88 & 143.50 & 143.10 & 145.30 \\ 
  2017-07-05 & AAPL & 143.69 & 144.09 & 142.72 & 144.79 \\ 
  2017-07-06 & AAPL & 143.02 & 142.73 & 142.41 & 143.50 \\ 
  2017-07-07 & AAPL & 142.90 & 144.18 & 142.90 & 144.75 \\ 
  2017-07-10 & AAPL & 144.11 & 145.06 & 143.37 & 145.95 \\ 
  2017-07-11 & AAPL & 144.73 & 145.53 & 144.38 & 145.85 \\ 
  2017-07-12 & AAPL & 145.87 & 145.74 & 144.82 & 146.18 \\ 
  2017-07-13 & AAPL & 145.50 & 147.77 & 145.44 & 148.49 \\ 
  2017-07-14 & AAPL & 147.97 & 149.04 & 147.33 & 149.33 \\ 
  2017-07-17 & AAPL & 148.82 & 149.56 & 148.57 & 150.90 \\ 
  2017-07-18 & AAPL & 149.20 & 150.08 & 148.67 & 150.13 \\ 
  2017-07-19 & AAPL & 150.48 & 151.02 & 149.95 & 151.42 \\ 
  2017-07-20 & AAPL & 151.50 & 150.34 & 150.19 & 151.74 \\ 
  2017-07-21 & AAPL & 149.99 & 150.27 & 148.88 & 150.44 \\ 
  2017-07-24 & AAPL & 150.58 & 152.09 & 149.90 & 152.44 \\ 
  2017-07-25 & AAPL & 151.80 & 152.74 & 151.80 & 153.84 \\ 
  2017-07-26 & AAPL & 153.35 & 153.46 & 153.06 & 153.93 \\ 
  2017-07-27 & AAPL & 153.75 & 150.56 & 147.30 & 153.99 \\ 
  2017-07-28 & AAPL & 149.89 & 149.50 & 149.19 & 150.23 \\ 
  2017-07-31 & AAPL & 149.90 & 148.85 & 148.13 & 150.33 \\ 
  2017-08-01 & AAPL & 149.10 & 150.05 & 148.41 & 150.22 \\ 
  2017-08-02 & AAPL & 159.28 & 157.14 & 156.16 & 159.75 \\ 
  2017-08-03 & AAPL & 157.05 & 155.57 & 155.02 & 157.21 \\ 
  2017-08-04 & AAPL & 156.07 & 156.39 & 155.69 & 157.40 \\ 
  2017-08-08 & AAPL & 158.60 & 160.08 & 158.27 & 161.83 \\ 
  2017-08-09 & AAPL & 159.26 & 161.06 & 159.11 & 161.27 \\ 
  2017-08-10 & AAPL & 159.90 & 155.27 & 154.63 & 160.00 \\ 
  2017-08-11 & AAPL & 156.60 & 157.48 & 156.07 & 158.57 \\ 
  2017-08-14 & AAPL & 159.32 & 159.85 & 158.75 & 160.21 \\ 
  2017-08-15 & AAPL & 160.66 & 161.60 & 160.14 & 162.19 \\ 
  2017-08-16 & AAPL & 161.94 & 160.95 & 160.15 & 162.51 \\ 
  2017-08-17 & AAPL & 160.52 & 157.87 & 157.84 & 160.71 \\ 
  2017-08-18 & AAPL & 157.86 & 157.50 & 156.72 & 159.50 \\ 
  2017-08-21 & AAPL & 157.50 & 157.21 & 155.11 & 157.89 \\ 
  2017-08-22 & AAPL & 158.23 & 159.78 & 158.02 & 160.00 \\ 
  2017-08-23 & AAPL & 159.07 & 159.98 & 158.88 & 160.47 \\ 
  2017-08-24 & AAPL & 160.43 & 159.27 & 158.55 & 160.74 \\ 
  2017-08-25 & AAPL & 159.65 & 159.86 & 159.27 & 160.56 \\ 
  2017-08-28 & AAPL & 160.14 & 161.47 & 159.93 & 162.00 \\ 
  2017-08-29 & AAPL & 160.10 & 162.91 & 160.00 & 163.12 \\ 
  2017-08-30 & AAPL & 163.80 & 163.35 & 162.61 & 163.89 \\ 
  2017-08-31 & AAPL & 163.64 & 164.00 & 163.48 & 164.52 \\ 
  2017-09-01 & AAPL & 164.80 & 164.05 & 163.63 & 164.94 \\ 
  2017-09-05 & AAPL & 163.75 & 162.08 & 160.56 & 164.25 \\ 
  2017-09-06 & AAPL & 162.71 & 161.91 & 160.52 & 162.99 \\ 
  2017-09-07 & AAPL & 162.09 & 161.26 & 160.36 & 162.24 \\ 
  2017-09-08 & AAPL & 160.86 & 158.63 & 158.53 & 161.15 \\ 
  2017-09-11 & AAPL & 160.50 & 161.50 & 159.89 & 162.05 \\ 
  2017-09-12 & AAPL & 162.61 & 160.82 & 158.77 & 163.96 \\ 
  2017-09-13 & AAPL & 159.87 & 159.65 & 157.91 & 159.96 \\ 
  2017-09-14 & AAPL & 158.99 & 158.28 & 158.09 & 159.40 \\ 
  2017-09-15 & AAPL & 158.47 & 159.88 & 158.00 & 160.97 \\ 
  2017-09-18 & AAPL & 160.11 & 158.67 & 158.00 & 160.50 \\ 
  2017-09-19 & AAPL & 159.51 & 158.73 & 158.44 & 159.77 \\ 
  2017-09-20 & AAPL & 157.90 & 156.07 & 153.83 & 158.26 \\ 
  2017-09-21 & AAPL & 155.80 & 153.39 & 152.75 & 155.80 \\ 
  2017-09-22 & AAPL & 152.02 & 151.89 & 150.56 & 152.27 \\ 
  2017-09-25 & AAPL & 149.99 & 150.55 & 149.16 & 151.83 \\ 
  2017-09-26 & AAPL & 151.78 & 153.14 & 151.69 & 153.92 \\ 
  2017-09-27 & AAPL & 153.80 & 154.23 & 153.54 & 154.72 \\ 
  2017-09-28 & AAPL & 153.89 & 153.28 & 152.70 & 154.28 \\ 
  2017-09-29 & AAPL & 153.21 & 154.12 & 152.00 & 154.13 \\ 
  2017-10-02 & AAPL & 154.26 & 153.81 & 152.72 & 154.45 \\ 
  2017-10-03 & AAPL & 154.01 & 154.48 & 153.91 & 155.09 \\ 
  2017-10-04 & AAPL & 153.63 & 153.45 & 152.46 & 153.86 \\ 
  2017-10-05 & AAPL & 154.18 & 155.39 & 154.05 & 155.44 \\ 
  2017-10-06 & AAPL & 154.97 & 155.30 & 154.56 & 155.49 \\ 
  2017-10-09 & AAPL & 155.81 & 155.84 & 155.49 & 156.73 \\ 
  2017-10-10 & AAPL & 156.06 & 155.90 & 155.10 & 158.00 \\ 
  2017-10-11 & AAPL & 155.97 & 156.55 & 155.75 & 156.98 \\ 
  2017-10-12 & AAPL & 156.35 & 156.00 & 155.73 & 157.37 \\ 
  2017-10-13 & AAPL & 156.73 & 156.99 & 156.41 & 157.28 \\ 
  2017-10-16 & AAPL & 157.90 & 159.88 & 157.65 & 160.00 \\ 
  2017-10-17 & AAPL & 159.78 & 160.47 & 159.23 & 160.87 \\ 
  2017-10-18 & AAPL & 160.42 & 159.76 & 159.60 & 160.71 \\ 
  2017-10-19 & AAPL & 156.75 & 155.98 & 155.02 & 157.08 \\ 
  2017-10-20 & AAPL & 156.61 & 156.16 & 155.96 & 157.75 \\ 
  2017-10-23 & AAPL & 156.89 & 156.17 & 155.50 & 157.69 \\ 
  2017-10-24 & AAPL & 156.29 & 157.10 & 156.20 & 157.42 \\ 
  2017-10-25 & AAPL & 156.91 & 156.41 & 155.27 & 157.55 \\ 
  2017-10-26 & AAPL & 157.23 & 157.41 & 156.78 & 157.83 \\ 
  2017-10-27 & AAPL & 159.29 & 163.05 & 158.70 & 163.60 \\ 
  2017-10-30 & AAPL & 163.89 & 166.72 & 163.72 & 168.07 \\ 
  2017-10-31 & AAPL & 167.90 & 169.04 & 166.94 & 169.65 \\ 
  2017-11-01 & AAPL & 169.87 & 166.89 & 165.61 & 169.94 \\ 
  2017-11-02 & AAPL & 167.64 & 168.11 & 165.28 & 168.50 \\ 
  2017-11-03 & AAPL & 174.00 & 172.50 & 171.12 & 174.26 \\ 
  2017-11-06 & AAPL & 172.37 & 174.25 & 171.72 & 174.99 \\ 
  2017-11-07 & AAPL & 173.91 & 174.81 & 173.60 & 175.25 \\ 
  2017-11-09 & AAPL & 175.11 & 175.88 & 173.14 & 176.09 \\ 
  2017-11-10 & AAPL & 175.11 & 174.67 & 174.27 & 175.38 \\ 
  2017-11-13 & AAPL & 173.50 & 173.97 & 173.40 & 174.50 \\ 
  2017-11-14 & AAPL & 173.04 & 171.34 & 171.18 & 173.48 \\ 
  2017-11-15 & AAPL & 169.97 & 169.08 & 168.38 & 170.32 \\ 
  2017-11-16 & AAPL & 171.18 & 171.10 & 170.30 & 171.87 \\ 
  2017-11-17 & AAPL & 171.04 & 170.15 & 169.64 & 171.39 \\ 
  2017-11-20 & AAPL & 170.29 & 169.98 & 169.56 & 170.56 \\ 
  2017-11-21 & AAPL & 170.78 & 173.14 & 170.78 & 173.70 \\ 
  2017-11-22 & AAPL & 173.36 & 174.96 & 173.05 & 175.00 \\ 
  2017-11-24 & AAPL & 175.10 & 174.97 & 174.65 & 175.50 \\ 
  2017-11-27 & AAPL & 175.05 & 174.09 & 173.34 & 175.08 \\ 
  2017-11-28 & AAPL & 174.30 & 173.07 & 171.86 & 174.87 \\ 
  2017-11-29 & AAPL & 172.63 & 169.48 & 167.16 & 172.92 \\ 
  2017-11-30 & AAPL & 170.43 & 171.85 & 168.44 & 172.14 \\ 
  2017-12-01 & AAPL & 169.95 & 171.05 & 168.50 & 171.67 \\ 
  2017-12-04 & AAPL & 172.48 & 169.80 & 169.63 & 172.62 \\ 
  2017-12-05 & AAPL & 169.06 & 169.64 & 168.40 & 171.52 \\ 
  2017-12-06 & AAPL & 167.50 & 169.01 & 166.46 & 170.20 \\ 
  2017-12-07 & AAPL & 169.03 & 169.45 & 168.91 & 170.44 \\ 
  2017-12-08 & AAPL & 170.49 & 169.37 & 168.82 & 171.00 \\ 
  2017-12-11 & AAPL & 169.20 & 172.67 & 168.79 & 172.89 \\ 
  2017-12-12 & AAPL & 172.15 & 171.70 & 171.46 & 172.39 \\ 
  2017-12-13 & AAPL & 172.50 & 172.27 & 172.00 & 173.54 \\ 
  2017-12-14 & AAPL & 172.40 & 172.22 & 171.65 & 173.13 \\ 
  2017-12-15 & AAPL & 173.63 & 173.87 & 172.46 & 174.17 \\ 
  2017-12-18 & AAPL & 174.88 & 176.42 & 174.86 & 177.20 \\ 
  2017-12-19 & AAPL & 175.03 & 174.54 & 174.09 & 175.39 \\ 
  2017-12-20 & AAPL & 174.87 & 174.35 & 173.25 & 175.42 \\ 
  2017-12-21 & AAPL & 174.17 & 175.01 & 174.10 & 176.02 \\ 
  2017-12-22 & AAPL & 174.68 & 175.01 & 174.50 & 175.42 \\ 
  2017-12-26 & AAPL & 170.80 & 170.57 & 169.68 & 171.47 \\ 
  2017-12-27 & AAPL & 170.10 & 170.60 & 169.71 & 170.78 \\ 
  2017-12-28 & AAPL & 171.00 & 171.08 & 170.48 & 171.85 \\ 
  2017-12-29 & AAPL & 170.52 & 169.23 & 169.22 & 170.59 \\ 
   \hline
% \end{tabular}
\caption[Market stock data (AAPL)]{Quotes on the Apple stock got through function getOptionChain from the R package quantmod. Those prices were recorded from 01 January 2017 to 31 December 2017.}
\label{t:market:stock}
\end{longtable}
\chapter{Analysis and results: Plots}
\label{cha:appendanalysis:plot}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MERTON density petL split by maturities and strikes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
  \centering
  \input{figures/p.analysis.merton.pl.dist.big.tex}
  % \rule{40mm}{20mm}
  \caption{Relative profits and losses of delta-hedges concerning MJD processes split by prices and maturities: Impact of the balancing frequency}
    %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The above densities have been constructed on the hedges of options, computed by means of the function \textit{mjd\_call}, with the following parameters $\sigma = 0.1858$, $\lambda = 0.1031$, $\mu = -0.2974$, $\delta = 0.1955$. While the underlying asset followed differents dummy paths constructed through the function \textit{mjd\_ts} taking as arguments: $S(0) = 186.31$, $T = 1.0932$, $\sigma = 0.1021$, $\alpha = 0.4817$, $\lambda = 99.5434$, $\mu = -0.0007$, $\delta = 0.01610$. 
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:mjd:pl:dist:big}
\end{figure}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MERTON density petL split by maturities and strikes IMPACT of delta
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
  \centering
  \input{figures/p.analysis.merton.pl.dist.deltas.tex}
  % \rule{40mm}{20mm}
  \caption{Relative profits and losses of delta-hedges concerning MJD processes split by prices and maturities: Impact of the delta used.}
    %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The above densities have been constructed on the hedges of options, computed by means of the function \textit{mjd\_call}, with the following parameters $\sigma = 0.1858$, $\lambda = 0.1031$, $\mu = -0.2974$, $\delta = 0.1955$. While the underlying asset followed differents dummy paths constructed through the function \textit{mjd\_ts} taking as arguments: $S(0) = 186.31$, $T = 1.0932$, $\sigma = 0.1021$, $\alpha = 0.4817$, $\lambda = 99.5434$, $\mu = -0.0007$, $\delta = 0.01610$. The associated delta function was the BSM delta for the red densities and MJD delta for those filled in green.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:mjd:pl:dist:deltas}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MERTON density petL split by maturities and strikes IMPACT of delta SAMPLE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{figure}[h]
  \centering
  \input{figures/p.analysis.merton.hedge.deltas.tex}
  % \rule{40mm}{20mm}
  \caption{Samples of delta-neutral portfolios built with different functions of delta(BSM vs MJD)}
    %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} Hedging of options, computed by means of the function \textit{mjd\_call}, with the following parameters $\sigma = 0.1858$, $\lambda = 0.1031$, $\mu = -0.2974$, $\delta = 0.1955$. While the underlying asset followed differents dummy paths constructed through the function \textit{mjd\_ts} taking as arguments: $S(0) = 186.31$, $T = 1.0932$, $\sigma = 0.1021$, $\alpha = 0.4817$, $\lambda = 99.5434$, $\mu = -0.0007$, $\delta = 0.01610$. The associated delta function was the BSM delta for the red circles and MJD delta for those in blue.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:mjd:hedge:deltas}
\end{figure}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% HESTONdensity petL split by maturities and strikes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{figure}[h]
  \centering
  \input{figures/p.analysis.heston.pl.dist.big.tex}
  % \rule{40mm}{20mm}
  \caption{Relative profits and losses of delta-hedges concerning HSV processes split by prices and maturities: Impact of the balancing frequency}
    %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The above densities have been constructed on the hedges of options, computed by means of the function \textit{hsv\_call}, with the following parameters $V(0) = 0.03798218$, $\theta = 0.04871543$, $\sigma = 0.50378803$, $\rho = -0.39877827$, $\kappa = 4.00105546$. While the underlying asset followed differents dummy paths constructed through the function \textit{hsv\_ts} taking as arguments: $S(0) = 186.31$, $T = 1.0932$, $V(0) = 0.03798$, $\theta = 0.0205$, $\sigma = 0.50379$, $\rho = -0.3988$,  $\kappa = 9.4894$ and $\alpha  = 0.4823$. 
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:hsv:pl:dist:big}
\end{figure}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MERTON density petL split by maturities and strikes IMPACT of delta
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




\begin{figure}[h]
  \centering
  \input{figures/p.analysis.heston.pl.dist.deltas.tex}
  % \rule{40mm}{20mm}
  \caption{Relative profits and losses of delta-hedges concerning HSV processes split by prices and maturities: Impact of the delta used.}
  %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} The above densities have been constructed on the hedges of options, computed by means of the function \textit{hsv\_call}, with the following parameters $V(0) = 0.03798218$, $\theta = 0.04871543$, $\sigma = 0.50378803$, $\rho = -0.39877827$, $\kappa = 4.00105546$. While the underlying asset followed differents dummy paths constructed through the function \textit{hsv\_ts} taking as arguments: $S(0) = 186.31$, $T = 1.0932$, $V(0) = 0.03798$, $\theta = 0.0205$, $\sigma = 0.50379$, $\rho = -0.3988$,  $\kappa = 9.4894$ and $\alpha  = 0.4823$. The associated delta function was the BSM delta for the red densities and HSV delta for those filled in green.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:hsv:pl:dist:deltas}
\end{figure}









%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MERTON density petL split by maturities and strikes IMPACT of delta SAMPLE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h]
  \centering
  \input{figures/p.analysis.heston.hedge.deltas.tex}
  % \rule{40mm}{20mm}
  \caption{Samples of delta-neutral portfolios built with different functions of delta(BSM vs HSV)}
  %
  % BEGIN OF FLOATNOTE
  %
  \begin{changemargin}{0.5cm}{0.5cm}
  \medskip
\footnotesize
\setstretch{1.0}\textbf{Notes.} Hedging of options, computed by means of the function \textit{hsv\_call}, with the following parameters $V(0) = 0.03798218$, $\theta = 0.04871543$, $\sigma = 0.50378803$, $\rho = -0.39877827$, $\kappa = 4.00105546$. While the underlying asset followed differents dummy paths constructed through the function \textit{hsv\_ts} taking as arguments: $S(0) = 186.31$, $T = 1.0932$, $V(0) = 0.03798$, $\theta = 0.0205$, $\sigma = 0.50379$, $\rho = -0.3988$,  $\kappa = 9.4894$ and $\alpha  = 0.4823$. The associated delta function was the BSM delta for the red circles and HSV delta for those in blue.
  \end{changemargin}
  %
  % END OF FLOATNOTE
  %
  \label{p:analysis:hsv:hedge:deltas}
\end{figure}

\end{appendices}











\end{document}
